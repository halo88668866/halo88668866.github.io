<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>古诗</title>
      <link href="/2025/07/09/%E5%8F%A4%E8%AF%97/"/>
      <url>/2025/07/09/%E5%8F%A4%E8%AF%97/</url>
      
        <content type="html"><![CDATA[<p>春晓 唐 孟浩然<br>春眠不觉晓，处处闻啼鸟。<br>夜来风雨声，花落知多少。  </p><p>江雪 唐 柳宗元<br>千山鸟飞绝，万径人踪灭。<br>孤舟蓑笠翁，独钓寒江雪。  </p><p>清明 唐 杜牧<br>清明时节雨纷纷，路上行人欲断魂<br>借问酒家何处有，牧童遥指杏花村  </p><p>草 唐 白居易<br>离离原上草，一岁一枯荣。<br>野火烧不尽，春风吹又生。  </p><p>登鹳雀楼 唐 王之涣<br>白日依山尽，黄河入海流。<br>欲穷千里目，更上一层楼。  </p><p>咏鹅 唐 骆宾王<br>鹅鹅鹅，曲项向天歌。<br>白毛浮绿水，红掌拨清波。  </p><p>悯农 唐 李绅<br>锄禾日当午，汗滴禾下土。<br>谁知盘中餐，粒粒皆辛苦。  </p><p>题临安邸 宋 林升<br>山外青山楼外楼，西湖歌舞几时休？<br>暖风熏得游人醉，直把杭州作汴州。  </p><p>静夜思 唐 · 李白<br>床前明月光，疑是地上霜。<br>举头望明月，低头思故乡。  </p><p>梅花 宋代：王安石<br>墙角数枝梅，凌寒独自开。<br>遥知不是雪，为有暗香来。  </p><p>游子吟<br>慈母手中线，游子身上衣。<br>临行密密缝，意恐迟迟归。<br>谁言寸草心，报得三春晖。  </p><p>望庐山瀑布 唐·李白<br>日照香炉生紫烟，遥看瀑布挂前川。<br>飞流直下三千尺，疑是银河落九天。  </p><p>早发白帝城 唐 李白<br>朝辞白帝彩云间，千里江陵一日还。<br>两岸猿声啼不住，轻舟已过万重山。  </p><p>红豆 王维<br>红豆生南国，春来发几枝。<br>愿君多采撷，此物最相思。  </p><p>秋浦歌 李白<br>白发三千丈，缘愁似个长。<br>不知明镜里，何处得秋霜。  </p><p>夜宿山寺 李白<br>危楼高百尺，手可摘星辰。<br>不敢高声语，恐惊天上人。  </p><p>登鹳雀楼 王之焕<br>白日依山尽，黄河入海流。<br>欲穷千里目，更上一层楼。  </p><p>赠汪伦 李白<br>李白乘舟将欲行，忽闻岸上踏歌声。<br>桃花潭水深千尺，不及汪伦送我情。  </p><p>山村咏怀 宋 邵雍<br>一去二三里，烟村四五家。<br>亭台六七座，八九十枝花。  </p><p>出塞 王昌龄<br>秦时明月汉时关，万里长征人未还。<br>但使龙城飞将在，不教胡马度阴山。<br>姑苏城外寒山寺，夜半钟声到客船。  </p>]]></content>
      
      
      
        <tags>
            
            <tag> 学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>群晖安装Tailscale</title>
      <link href="/2025/07/09/%E7%BE%A4%E6%99%96%E5%AE%89%E8%A3%85Tailscale/"/>
      <url>/2025/07/09/%E7%BE%A4%E6%99%96%E5%AE%89%E8%A3%85Tailscale/</url>
      
        <content type="html"><![CDATA[<p>NAS存储不够了，因此对其进行了扩容，好多插件都要重新安装，记录下Tailscale安装过程，其他插件直接修复就安装完毕了</p><h2 id="安装包下载"><a href="#安装包下载" class="headerlink" title="安装包下载"></a>安装包下载</h2><p>Tailscale按照说明套件中心应该存在，但是实际没找到，网上找到了下载地址，下载架构对应的版本即可。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">https://pkgs.tailscale.com/stable/#spks<br></code></pre></td></tr></table></figure><h2 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h2><p>进入群晖套件中心–&gt;所有套件 右上角部分有个手动安装，安装后即可</p><h2 id="登录Tailscale"><a href="#登录Tailscale" class="headerlink" title="登录Tailscale"></a>登录Tailscale</h2><p>安装过程没任何问题，但是点击安装后图标，进行登录时报Failed Login，Google了报错原因，参考此文档解决，总结下来主要登录SSH，手动up</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">https://tailscale.com/kb/1131/synology<br></code></pre></td></tr></table></figure><p>详细步骤如下：<br>1.SSH登录Nas，涵盖开启端口、放通防火墙，putty连接等<br>2.执行以下命令，需要输入密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo tailscale up<br></code></pre></td></tr></table></figure><p>3.将输出地址在浏览器输入，按提示登录即可</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">To authenticate, visit:<br>https://login.tailscale.com/a/xxxxxxxxxx<br>Success.<br></code></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 群晖 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Pages搭建Hexo博客</title>
      <link href="/2025/07/04/Github%20Pages%E6%90%AD%E5%BB%BAHexo%E5%8D%9A%E5%AE%A2/"/>
      <url>/2025/07/04/Github%20Pages%E6%90%AD%E5%BB%BAHexo%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>GitHub Actions 是 GitHub 推出的持续集成服务，入门教程可参考:GitHub Actions 入门教程。</p><h2 id="新建两个仓库"><a href="#新建两个仓库" class="headerlink" title="新建两个仓库"></a>新建两个仓库</h2><p>_www : 私有仓库，存储源代码内容，生成文件<br>xxx.github.io ： 公开仓库，主要存在编译后的public内容</p><h2 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h2><p>1.获取 GH_TOKEN<br>首先到个人中心设置Setting-&gt;Developer Settings-&gt; Personal access tokens-&gt;tokens (classic)，新建一个token即可。<br>token 能让 GitHub Actions 构建所在的虚拟系统对发布仓库拥有权限可以进行推送操作。</p><p>2.设置 Actions Secrets<br>新建 _www 仓库，将本地目录的 hexo 源码推送到_www 仓库里，然后进到 _www 仓库的 Setting-&gt;secrets and variables -&gt;Actions 在Repository secrets里新建一个名为[ACCESS_TOKEN]的键值项，内容填上一步获取到的 token 值。</p><p>3.Actions 设置<br>在博客源码根目录下新建目录 .github&#x2F;workflows ,然后在其下新建任务文件 deploy.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Publish</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">to</span> <span class="hljs-string">gitpage</span><br><span class="hljs-attr">on:</span><br><span class="hljs-attr">push:</span><br>  <span class="hljs-attr">branches:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">main</span>  <span class="hljs-comment"># 如果源码与gitpage用同一仓库则修改为hexo源码对应分支</span><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">build:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">ref:</span> <span class="hljs-string">main</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br><span class="hljs-string">        npm install -g hexo-cli # 给虚拟机装上hexo运行环境</span><br><span class="hljs-string">        npm install             # 安装 package.json 中记录的所有插件</span><br><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">site</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br><span class="hljs-string">        hexo clean</span><br><span class="hljs-string">        hexo generate</span><br><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">B</span> <span class="hljs-string">repo</span><br>      <span class="hljs-attr">uses:</span> <span class="hljs-string">peaceiris/actions-gh-pages@v3</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">personal_token:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.ACCESS_TOKEN</span> <span class="hljs-string">&#125;&#125;</span> <span class="hljs-comment"># Personal access token</span><br>        <span class="hljs-attr">external_repository:</span> <span class="hljs-string">xxxx/xxxx.github.io</span>  <span class="hljs-comment"># 发布的仓库地址</span><br>        <span class="hljs-attr">PUBLISH_BRANCH:</span> <span class="hljs-string">main</span><br>        <span class="hljs-attr">PUBLISH_DIR:</span> <span class="hljs-string">./public</span><br></code></pre></td></tr></table></figure><p>4.至此所有的就完成了</p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（五）</title>
      <link href="/2024/12/17/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%BA%94%EF%BC%89/"/>
      <url>/2024/12/17/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%BA%94%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>在上次框架改版、引入pinpa的基础上，这次引入了AI下棋功能，这功能主要来自：<a href="https://github.com/lihongxun945/gobang">https://github.com/lihongxun945/gobang</a>   AI功能部分未进行任何变动，直接改了几个接口，直接引入即可。</p><p>本次设计代码较多，仍原来几个代码</p><p>本次主要重点引入的代码</p><p>minmax.worker.js，主要改自开源的代码，由react进行了微调，其中AI部分，直接从开源处将AI文件夹复制过来即可</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Board</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ai/board&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123;minmax&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ai/minmax&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123;<span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/stores/status&#x27;</span>;<br><br><span class="hljs-comment">// @ts-ignore</span><br><span class="hljs-comment">// onmessage = function (event) &#123;</span><br><span class="hljs-comment">//   const &#123; action, payload &#125; = event.data;</span><br><span class="hljs-comment">//   console.log(event.data)</span><br><span class="hljs-comment">//   let res = null;</span><br><span class="hljs-comment">//   switch (action) &#123;</span><br><span class="hljs-comment">//     case &#x27;start&#x27;:</span><br><span class="hljs-comment">//       res = start(payload.board_size, payload.aiFirst, payload.depth);</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//     case &#x27;move&#x27;:</span><br><span class="hljs-comment">//       res = move(payload.position, payload.depth);</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//     case &#x27;undo&#x27;:</span><br><span class="hljs-comment">//       res = undo();</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//     case &#x27;end&#x27;:</span><br><span class="hljs-comment">//       res = end();</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//     default:</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//   &#125;</span><br><span class="hljs-comment">//   postMessage(&#123;</span><br><span class="hljs-comment">//     action,</span><br><span class="hljs-comment">//     payload: res,</span><br><span class="hljs-comment">//   &#125;);</span><br><span class="hljs-comment">// &#125;;</span><br><br><span class="hljs-keyword">let</span> board = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Board</span>(<span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span>);<br><span class="hljs-keyword">let</span> score = <span class="hljs-number">0</span>, bestPath = [], currentDepth = <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getBoardData</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-attr">board</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(board.<span class="hljs-property">board</span>)),<br>        <span class="hljs-attr">winner</span>: board.<span class="hljs-title function_">getWinner</span>(),<br>        <span class="hljs-attr">current_player</span>: board.<span class="hljs-property">role</span>,<br>        <span class="hljs-attr">history</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(board.<span class="hljs-property">history</span>)),<br>        <span class="hljs-attr">size</span>: board.<span class="hljs-property">size</span>,<br>        score,<br>        bestPath,<br>        currentDepth,<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">start</span> = (<span class="hljs-params">board_size, aiFirst = <span class="hljs-literal">true</span>, depth = <span class="hljs-number">4</span></span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;start&#x27;</span>, board_size, aiFirst, depth);<br>    board = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Board</span>(board_size);<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">if</span> (aiFirst) &#123;<br>            <span class="hljs-keyword">const</span> res = <span class="hljs-title function_">minmax</span>(board, board.<span class="hljs-property">role</span>, depth);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=====res=====&quot;</span> + res)<br>            <span class="hljs-keyword">let</span> move;<br>            [score, move, bestPath, currentDepth] = res;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=========================&quot;</span>)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(score)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(move)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bestPath)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(currentDepth)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=========================&quot;</span>)<br>            board.<span class="hljs-title function_">put</span>(move[<span class="hljs-number">0</span>], move[<span class="hljs-number">1</span>]);<br>            <span class="hljs-keyword">return</span> [move[<span class="hljs-number">0</span>], move[<span class="hljs-number">1</span>], board.<span class="hljs-property">role</span>]<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);<br>    &#125;<br>    <span class="hljs-comment">// return getBoardData();</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><br>&#125;;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">move</span> = (<span class="hljs-params">position, depth</span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=====move====&quot;</span> + position)<br>    <span class="hljs-keyword">try</span> &#123;<br>        board.<span class="hljs-title function_">put</span>(position[<span class="hljs-number">0</span>], position[<span class="hljs-number">1</span>]);<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!board.<span class="hljs-title function_">isGameOver</span>()) &#123;<br>        <span class="hljs-keyword">const</span> res = <span class="hljs-title function_">minmax</span>(board, board.<span class="hljs-property">role</span>, depth);<br>        <span class="hljs-keyword">let</span> move;<br>        [score, move, bestPath, currentDepth] = res;<br>        board.<span class="hljs-title function_">put</span>(move[<span class="hljs-number">0</span>], move[<span class="hljs-number">1</span>]);<br>        <span class="hljs-keyword">return</span> [move[<span class="hljs-number">0</span>], move[<span class="hljs-number">1</span>], board.<span class="hljs-property">role</span>]<br>    &#125;<br>    <span class="hljs-comment">// return getBoardData();</span><br>&#125;;<br><span class="hljs-comment">//</span><br><span class="hljs-comment">// export const end = () =&gt; &#123;</span><br><span class="hljs-comment">//   console.log(&quot;=====end====&quot;)</span><br><span class="hljs-comment">//   // do nothing</span><br><span class="hljs-comment">//   return getBoardData();</span><br><span class="hljs-comment">// &#125;;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// export const undo = () =&gt; &#123;</span><br><span class="hljs-comment">//   console.log(&quot;=====undo====&quot;)</span><br><span class="hljs-comment">//   board.undo();</span><br><span class="hljs-comment">//   board.undo();</span><br><span class="hljs-comment">//   return getBoardData();</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure><p>status.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//默认宽度</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span> = <span class="hljs-number">375</span><br><span class="hljs-comment">//默认线条数</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span> = <span class="hljs-number">15</span><br><span class="hljs-comment">//默认间隙</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span> = <span class="hljs-number">25</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">GameStatus</span> = &#123;<br>    <span class="hljs-comment">//就绪状态</span><br>    <span class="hljs-attr">IDLE</span>: <span class="hljs-string">&quot;idle&quot;</span>,<br>    <span class="hljs-comment">// 游戏中</span><br>    <span class="hljs-attr">GAMING</span>: <span class="hljs-string">&#x27;gaming&#x27;</span>,<br>    <span class="hljs-comment">// 已获胜</span><br>    <span class="hljs-attr">WINNING</span>: <span class="hljs-string">&#x27;winning&#x27;</span>,<br>    <span class="hljs-comment">// 重新开始</span><br>    <span class="hljs-attr">RESTART</span>: <span class="hljs-string">&#x27;restart&#x27;</span>,<br>&#125;<br><span class="hljs-comment">//黑棋子</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PLAYER_BLACK</span> = -<span class="hljs-number">1</span><br><span class="hljs-comment">//白棋子</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PLAYER_WHITE</span> = <span class="hljs-number">1</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">PlayerStatus</span> = &#123;<br>    <span class="hljs-comment">// 黑棋</span><br>    <span class="hljs-attr">BLACK</span>: <span class="hljs-variable constant_">PLAYER_BLACK</span>,<br>    <span class="hljs-comment">// 白棋</span><br>    <span class="hljs-attr">WHITE</span>: <span class="hljs-variable constant_">PLAYER_WHITE</span>,<br>&#125;<br></code></pre></td></tr></table></figure><p>chess.js  状态管理代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;defineStore, acceptHMRUpdate&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123;<br>    <span class="hljs-title class_">PlayerStatus</span>,<br>    <span class="hljs-title class_">GameStatus</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span><br>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useChessStore = <span class="hljs-title function_">defineStore</span>(&#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;chess&#x27;</span>,<br>    <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123;<br>        <span class="hljs-attr">status</span>: <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">IDLE</span>,<br>        <span class="hljs-attr">boardDetail</span>: &#123;<br>            <span class="hljs-attr">width</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span>,<span class="hljs-comment">//棋盘大小</span><br>            <span class="hljs-attr">size</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span>,<span class="hljs-comment">//棋盘线数</span><br>            <span class="hljs-attr">space</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span>,<span class="hljs-comment">//间隙</span><br>        &#125;,<br>        <span class="hljs-attr">current_player</span>: <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>,<span class="hljs-comment">//默认黑子（-1）</span><br>        <span class="hljs-attr">board</span>: [],<span class="hljs-comment">//棋盘内容--Board包含</span><br>        <span class="hljs-attr">history</span>: [],<span class="hljs-comment">//--Board包含</span><br>        <span class="hljs-attr">size</span>: <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-comment">//--Board包含</span><br>        <span class="hljs-attr">aiFirst</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//AI先行</span><br>        <span class="hljs-attr">depth</span>: <span class="hljs-number">4</span>, <span class="hljs-comment">// 搜索深度</span><br>        <span class="hljs-attr">currentDepth</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">path</span>: [],<br>        <span class="hljs-attr">winner</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">score</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">bestPath</span>: <span class="hljs-string">&#x27;&#x27;</span><br>    &#125;),<br>    <span class="hljs-attr">actions</span>: &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 初始化选手（黑）</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">initPayer</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span> =<span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:初始化选手（黑）==初始化选手（黑）==,新:&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 转换选手</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">reversePlayer</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span> *= -<span class="hljs-number">1</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:reversePlayer==交换选手==,新:&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变选手</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changePlayer</span>(<span class="hljs-params">s</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (s) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span> = <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span> = <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-attr">default</span>:<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changePlayer==改变选手==,新:&quot;</span> + s)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变游戏状态</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-params">s</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (s) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">IDLE</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">IDLE</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-attr">default</span>:<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeGameStatus==改变游戏状态==&quot;</span> + s)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变棋盘大小</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">w</span></span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">n</span></span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params">w, n, s</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span> = &#123;<br>                <span class="hljs-attr">width</span>: w,<span class="hljs-comment">//棋盘大小</span><br>                <span class="hljs-attr">size</span>: n,<span class="hljs-comment">//棋盘线数</span><br>                <span class="hljs-attr">space</span>: s,<span class="hljs-comment">//间隙</span><br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeBoardDetail==改变棋盘大小==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 初始化棋盘内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">initBoard</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> size = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = <span class="hljs-title class_">Array</span>(size).<span class="hljs-title function_">fill</span>().<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Array</span>(size).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:initBoard==初始化棋盘内容==\n&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br><br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 修改棋盘内容</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">board</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeBoard</span>(<span class="hljs-params">board</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = board<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeBoard==修改棋盘内容==\n&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 清空棋盘内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">clearBoard</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> size = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = <span class="hljs-title class_">Array</span>(size).<span class="hljs-title function_">fill</span>().<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Array</span>(size).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:clearBoard==清空棋盘内容==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 清空历史内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">clearHistory</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">history</span> = []<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:clearBoard==清空历史内容==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">history</span>)<br>        &#125;<br>    &#125;<br><br>&#125;)<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>) &#123;<br>    <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>.<span class="hljs-title function_">accept</span>(<span class="hljs-title function_">acceptHMRUpdate</span>(useChessStore, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>GoBang.vue  此部分代码和上次无太大差异</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MainBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./MainBoard.vue&#x27;</span></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">OperateBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./OperateBoard.vue&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">components</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title class_">MainBoard</span>, <span class="hljs-title class_">OperateBoard</span></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;五子棋&quot;</span>;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;root-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">MainBoard</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">OperateBoard</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.root-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>MainBoard  ci此部分整体框架和上次类似，功能描述上有调整</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;</span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;</span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;move, start&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/components/gobang/minmax.worker.js&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">//加载store，便于全局使用</span></span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            chessStore,</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">//监视状态变化，以便监听【重置】状态</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.$subscribe(<span class="hljs-function">(<span class="hljs-params">mutation, state</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(mutation)</span></span><br><span class="language-javascript">            <span class="hljs-comment">//TODO 生产环境有问题，去掉了mutation.events.key === &quot;status&quot;</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (state.<span class="hljs-property">status</span> === <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//检测到状态位RESTART，需要重置游戏</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restartGame</span>()</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">// 实例创建完成，仅在首次加载时完成</span></span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span></span><br><span class="language-javascript">        <span class="hljs-comment">//TODO 清空基础数据，后续测试必要性</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initGame</span>()</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">            boardDetail.<span class="hljs-property">size</span>,</span><br><span class="language-javascript">            boardDetail.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">    ,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 初始化游戏参数</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">initGame</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//清空基础数据并初始化</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">initPayer</span>()</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">initBoard</span>()</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">clearHistory</span>()</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">IDLE</span>)</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 点击落子</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">e</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleDropChess</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//存在输赢以后或未开始前，不允许在落子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">status</span> !== <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> space = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> size = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 计算棋子落在哪个方格中,并绘制棋子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((e.<span class="hljs-property">offsetX</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((e.<span class="hljs-property">offsetY</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawChess</span>(cellX, cellY)</span><br><span class="language-javascript">            <span class="hljs-comment">//判断输赢</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> winner = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span>, size)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (winner !== <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//代表此次操作有胜负，更新结果</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>)</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(winner)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">//交换选手</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">reversePlayer</span>()</span><br><span class="language-javascript">            <span class="hljs-comment">//交由AI下棋</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleAIDrop</span>()</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * AI下棋</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleAIDrop</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//接下来交给AI出来，前面均由人为点击产生</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> history = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">history</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> h = history[history.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(&quot;x=&quot; + h.x + &#x27; y=&#x27; + h.y)</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> res = <span class="hljs-title function_">move</span>([h.<span class="hljs-property">x</span>, h.<span class="hljs-property">y</span>], <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">depth</span>)</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawChess</span>(res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>])</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(this.chessStore.board)</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==================AI下子结束=============&quot;</span>)</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">//判断输赢</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> size = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> winner = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span>, size)</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(winner)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (winner !== <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//代表此次操作有胜负，更新结果</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>)</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(winner)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">reversePlayer</span>()</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 画整体棋盘</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> width 所需棋盘整体大小，上下左右预留一半space空间</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> size 线条数，线条数*间距=width</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> space 间距</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params">width, size, space</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">// 设置线条颜色</span></span><br><span class="language-javascript">            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制横线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(width - halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制竖线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(i * space + halfSpace, halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(i * space + halfSpace, width - halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        ,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 绘制棋子</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">x</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">y</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">drawChess</span>(<span class="hljs-params">x, y</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> detail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> board = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> current_player = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">current_player</span></span><br><span class="language-javascript">            <span class="hljs-comment">//存在输赢以后，不允许在落子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">status</span> !== <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> lineNumber = detail.<span class="hljs-property">size</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> space = detail.<span class="hljs-property">space</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(event.offsetX + &#x27;   &#x27; + event.offsetY + &#x27;  &#x27; + space)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 判断该位置是否有棋子</span></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(board)</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (board[x][y] !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span></span><br><span class="language-javascript">            <span class="hljs-comment">//考虑起点为2，因半径为space一半，避免太大，截止1/3大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(</span><br><span class="language-javascript">                x * space + halfSpace,</span><br><span class="language-javascript">                y * space + halfSpace,</span><br><span class="language-javascript">                <span class="hljs-number">2</span>,</span><br><span class="language-javascript">                x * space + halfSpace,</span><br><span class="language-javascript">                y * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span></span><br><span class="language-javascript">            )</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>,</span><br><span class="language-javascript">                current_player === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>,</span><br><span class="language-javascript">                current_player === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">            ctx.<span class="hljs-property">fillStyle</span> = grd</span><br><span class="language-javascript">            <span class="hljs-comment">//画圆，半径设置为space/3，同上r1参数一致</span></span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">arc</span>(</span><br><span class="language-javascript">                x * space + halfSpace,</span><br><span class="language-javascript">                y * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span>,</span><br><span class="language-javascript">                <span class="hljs-number">0</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,</span><br><span class="language-javascript">                <span class="hljs-literal">false</span></span><br><span class="language-javascript">            );</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">closePath</span>();</span><br><span class="language-javascript">            board[x][y] = current_player; <span class="hljs-comment">//将黑白棋信息存储</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span>)</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">history</span>.<span class="hljs-title function_">push</span>(&#123;x, y, current_player&#125;)</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        ,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 胜负检查</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> board X*X 二维数组</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@returns</span> &#123;<span class="hljs-type">UnwrapRef&lt;string&gt;|null</span>&#125;</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board, lineNumber</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> current_player = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">current_player</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查横向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === current_player) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> current_player;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查纵向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === current_player) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> current_player;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查右斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber - <span class="hljs-number">5</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === current_player) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> current_player;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查左斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === current_player) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> current_player;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 重置游戏</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">restartGame</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//清空基础数据</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initGame</span>()</span><br><span class="language-javascript">            <span class="hljs-comment">//清空画布</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制，会初始化棋子信息</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">                boardDetail.<span class="hljs-property">size</span>,</span><br><span class="language-javascript">                boardDetail.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//开始处理游戏状态</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>)</span><br><span class="language-javascript">            <span class="hljs-comment">//根据情况自动下棋</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==================重新开始=============&quot;</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> res = <span class="hljs-title function_">start</span>(boardDetail.<span class="hljs-property">size</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">aiFirst</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">depth</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (res !=<span class="hljs-literal">null</span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//代表AI先行，存在旗子，则进行绘制</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawChess</span>(res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>])</span><br><span class="language-javascript">                <span class="hljs-comment">//交换选手</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">reversePlayer</span>()</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// 无需交换棋子，直接黑子开始</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript"></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-chess&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;375&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;375&quot;</span></span><br><span class="hljs-tag">                @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleDropChess($event)&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.main-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-chess</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>OperateBoard.vue 和上次类似</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;</span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            chessStore,</span><br><span class="language-javascript">            <span class="hljs-title class_">PlayerStatus</span>,</span><br><span class="language-javascript">            <span class="hljs-title class_">GameStatus</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 改变棋盘大小</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> square = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> newWidth = square</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> newHeight = square</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> newLineNumber = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> newSpace = newWidth / newLineNumber</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(newWidth + &#x27;  &#x27; + newLineNumber + &#x27;  &#x27; + newSpace)</span></span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置board大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)</span><br><span class="language-javascript">            canvas.<span class="hljs-property">width</span> = newWidth</span><br><span class="language-javascript">            canvas.<span class="hljs-property">height</span> = newHeight</span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置棋盘大小</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeBoardDetail</span>(newWidth, newLineNumber, newSpace)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制游戏</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRestart</span>()</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 重新开始</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleRestart</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>)</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;detail&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>长宽：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.width&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>线条数：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.size&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>间距：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeBoardDetail()&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>AI先手<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">checkbox</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.aiFirst&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleRestart&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;chessStore.status===GameStatus.IDLE&quot;</span>&gt;</span>开始<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>当前落子：&#123;&#123; chessStore.current_player === PlayerStatus.WHITE ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>胜利方：&#123;&#123;<br>                        chessStore.status === GameStatus.WINNING ?<br>                            (chessStore.current_player === PlayerStatus.WHITE ? &quot;白棋&quot; : &quot;黑棋&quot;) : &quot;&quot;<br>                    &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">text-align</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> <span class="hljs-selector-tag">span</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> <span class="hljs-selector-tag">input</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.operate</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">text-align</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.operate</span> <span class="hljs-selector-tag">div</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">text-align</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.operate</span> <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">button</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.operate</span> <span class="hljs-selector-tag">span</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（四）</title>
      <link href="/2024/12/05/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
      <url>/2024/12/05/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E5%9B%9B%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>在上次拆分组件的前提下，现在引入了pinia状态管理</p><p>在此过程中，发现了一个问题，后改用了其他方式，比较简单粗暴。</p><p>生产环境报：Missing types in subscribe’s mutation.events</p><p>具体主要依托store来实现，也规范了几个状态变量</p><p>chess.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;defineStore, acceptHMRUpdate&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123;<br>    <span class="hljs-title class_">PlayerStatus</span>,<br>    <span class="hljs-title class_">GameStatus</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_LINE_NUMBER</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span><br>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useChessStore = <span class="hljs-title function_">defineStore</span>(&#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;chess&#x27;</span>,<br>    <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123;<br>        <span class="hljs-attr">player</span>: <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>,<br>        <span class="hljs-attr">status</span>: <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>,<br>        <span class="hljs-attr">boardDetail</span>: &#123;<br>            <span class="hljs-attr">width</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span>,<span class="hljs-comment">//棋盘大小</span><br>            <span class="hljs-attr">lineNumber</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_LINE_NUMBER</span>,<span class="hljs-comment">//棋盘线数</span><br>            <span class="hljs-attr">space</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span>,<span class="hljs-comment">//间隙</span><br>        &#125;,<br>        <span class="hljs-attr">board</span>: []<br>    &#125;),<br>    <span class="hljs-attr">actions</span>: &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 交换选手</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">reversePlayer</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span> ?<br>                <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> : <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:reversePlayer==交换选手==,新:&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变当前棋手</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changePlayer</span>(<span class="hljs-params">s</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (s) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-attr">default</span>:<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changePlayer==改变选手==,新:&quot;</span> + s)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变游戏状态</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-params">s</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (s) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-attr">default</span>:<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeGameStatus==改变游戏状态==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变棋盘大小</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">w</span></span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">n</span></span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params">w, n, s</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span> = &#123;<br>                <span class="hljs-attr">width</span>: w,<span class="hljs-comment">//棋盘大小</span><br>                <span class="hljs-attr">lineNumber</span>: n,<span class="hljs-comment">//棋盘线数</span><br>                <span class="hljs-attr">space</span>: s,<span class="hljs-comment">//间隙</span><br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeBoardDetail==改变棋盘大小==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 初始化棋盘内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">initBoard</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = []<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>; i++) &#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:initBoard==初始化棋盘内容==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br><br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 清空棋盘内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">clearBoard</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = []<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:clearBoard==清空棋盘内容==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br>        &#125;<br>    &#125;<br><br>&#125;)<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>) &#123;<br>    <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>.<span class="hljs-title function_">accept</span>(<span class="hljs-title function_">acceptHMRUpdate</span>(useChessStore, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>status.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span> = <span class="hljs-number">600</span><span class="hljs-comment">//默认宽度</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_LINE_NUMBER</span> = <span class="hljs-number">15</span><span class="hljs-comment">//默认线条数</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span> = <span class="hljs-number">40</span> <span class="hljs-comment">//默认间隙</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">GameStatus</span> = &#123;<br>    <span class="hljs-attr">GAMING</span>: <span class="hljs-string">&#x27;gaming&#x27;</span>, <span class="hljs-comment">// 游戏中</span><br>    <span class="hljs-attr">WINNING</span>: <span class="hljs-string">&#x27;winning&#x27;</span>, <span class="hljs-comment">// 已获胜</span><br>    <span class="hljs-attr">RESTART</span>: <span class="hljs-string">&#x27;restart&#x27;</span>, <span class="hljs-comment">// 已获胜</span><br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">PlayerStatus</span> = &#123;<br>    <span class="hljs-attr">BLACK</span>: <span class="hljs-string">&#x27;BLACK&#x27;</span>, <span class="hljs-comment">// 黑棋</span><br>    <span class="hljs-attr">WHITE</span>: <span class="hljs-string">&#x27;WHITE&#x27;</span>, <span class="hljs-comment">// 白棋</span><br>&#125;<br></code></pre></td></tr></table></figure><p>完整代码如下：</p><p>GoBang.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MainBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./MainBoard.vue&#x27;</span></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">OperateBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./OperateBoard.vue&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;&#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">components</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title class_">MainBoard</span>, <span class="hljs-title class_">OperateBoard</span></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;五子棋&quot;</span>;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;root-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">MainBoard</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">OperateBoard</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.root-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>MainBoard.vue</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;<br><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;<br><span class="hljs-keyword">import</span> &#123;storeToRefs&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123;watch&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: &#123;&#125;,<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;&#125;;<br>    &#125;,<br>    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()<br>        <span class="hljs-keyword">return</span> &#123;<br>            chessStore,<br>        &#125;<br>    &#125;,<br>    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br><br>        <span class="hljs-comment">//监视状态变化，以便监听重置等情况</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.$subscribe(<span class="hljs-function">(<span class="hljs-params">mutation, state</span>) =&gt;</span> &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mutation)<span class="hljs-comment">// 传递给 cartStore.$patch() 的补丁对象。</span><br>            <span class="hljs-comment">//TODO 生产环境有问题，去掉了mutation.events.key === &quot;status&quot;</span><br>            <span class="hljs-keyword">if</span> (state.<span class="hljs-property">status</span> === <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>) &#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restartGame</span>()<br>            &#125;<br>        &#125;)<br>    &#125;,<br><br>    <span class="hljs-comment">// 实例创建完成，仅在首次加载时完成</span><br>    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,<br>            boardDetail.<span class="hljs-property">lineNumber</span>,<br>            boardDetail.<span class="hljs-property">space</span>);<br>    &#125;<br>    ,<br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 画整体棋盘</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> width 所需棋盘整体大小，上下左右预留一半space空间</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> lineNumber 线条数，线条数*间距=width</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> space 间距</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params">width, lineNumber, space</span>) &#123;<br>            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;<br><br>            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br>            <span class="hljs-comment">// 设置线条颜色</span><br>            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;<br><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;<br>                <span class="hljs-comment">// 绘制横线</span><br>                ctx.<span class="hljs-title function_">beginPath</span>();<br>                ctx.<span class="hljs-title function_">moveTo</span>(halfSpace, i * space + halfSpace);<br>                ctx.<span class="hljs-title function_">lineTo</span>(width - halfSpace, i * space + halfSpace);<br>                ctx.<span class="hljs-title function_">stroke</span>();<br>                <span class="hljs-comment">// 绘制竖线</span><br>                ctx.<span class="hljs-title function_">beginPath</span>();<br>                ctx.<span class="hljs-title function_">moveTo</span>(i * space + halfSpace, halfSpace);<br>                ctx.<span class="hljs-title function_">lineTo</span>(i * space + halfSpace, width - halfSpace);<br>                ctx.<span class="hljs-title function_">stroke</span>();<br>            &#125;<br>            <span class="hljs-comment">//填充数组，重置为0</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">initBoard</span>()<br>        &#125;<br>        ,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 监听每步棋子，需要传入棋盘信息</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">event</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event</span>) &#123;<br>            <span class="hljs-keyword">const</span> detail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span><br>            <span class="hljs-keyword">const</span> board = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span><br>            <span class="hljs-keyword">const</span> player = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">player</span><br>            <span class="hljs-comment">//存在输赢以后，不允许在落子</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">status</span> !== <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">const</span> lineNumber = detail.<span class="hljs-property">lineNumber</span><br>            <span class="hljs-keyword">const</span> space = detail.<span class="hljs-property">space</span><br>            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;<br><br>            <span class="hljs-comment">// 计算棋子落在哪个方格中</span><br>            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / space);<br>            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / space);<br>            <span class="hljs-comment">// console.log(event.offsetX + &#x27;   &#x27; + event.offsetY + &#x27;  &#x27; + space)</span><br>            <span class="hljs-comment">// 判断该位置是否有棋子</span><br>            <span class="hljs-comment">// console.log(board)</span><br>            <span class="hljs-keyword">if</span> (board[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br>            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span><br>            <span class="hljs-comment">//考虑起点为2，因半径为space一半，避免太大，截止1/3大小</span><br>            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<br>                cellX * space + halfSpace,<br>                cellY * space + halfSpace,<br>                <span class="hljs-number">2</span>,<br>                cellX * space + halfSpace,<br>                cellY * space + halfSpace,<br>                space / <span class="hljs-number">3</span><br>            )<br>            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>,<br>                player === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)<br>            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>,<br>                player === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)<br>            ctx.<span class="hljs-title function_">beginPath</span>()<br>            ctx.<span class="hljs-property">fillStyle</span> = grd<br>            <span class="hljs-comment">//画圆，半径设置为space/3，同上r1参数一致</span><br>            ctx.<span class="hljs-title function_">arc</span>(<br>                cellX * space + halfSpace,<br>                cellY * space + halfSpace,<br>                space / <span class="hljs-number">3</span>,<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,<br>                <span class="hljs-literal">false</span><br>            );<br>            ctx.<span class="hljs-title function_">fill</span>();<br>            ctx.<span class="hljs-title function_">closePath</span>();<br>            board[cellX][cellY] = player; <span class="hljs-comment">//将黑白棋信息存储</span><br><br>            <span class="hljs-keyword">const</span> winner_current = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(board, lineNumber) <span class="hljs-comment">//判断输赢</span><br>            <span class="hljs-keyword">if</span> (winner_current !== <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-comment">//代表此次操作有胜负，更新结果</span><br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>)<br>                <span class="hljs-title function_">alert</span>(winner_current)<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-comment">//通知父组件，修改了选手内容值</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">reversePlayer</span>()<span class="hljs-comment">//交换</span><br>        &#125;<br>        ,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 胜负检查</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> board X*X 二维数组</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> lineNumber 线条数</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@returns</span> &#123;<span class="hljs-type">UnwrapRef&lt;string&gt;|null</span>&#125;</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board, lineNumber</span>) &#123;<br>            <span class="hljs-keyword">const</span> player = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">player</span><br>            <span class="hljs-comment">// 检查横向是否有五子连线</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;<br>                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;<br>                    <span class="hljs-keyword">if</span> (board[i][j] === player) &#123;<br>                        count++;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        count = <span class="hljs-number">0</span>;<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> player;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment">// 检查纵向是否有五子连线</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;<br>                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;<br>                    <span class="hljs-keyword">if</span> (board[i][j] === player) &#123;<br>                        count++;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        count = <span class="hljs-number">0</span>;<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> player;<br><br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment">// 检查右斜线是否有五子连线</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber - <span class="hljs-number">5</span>; j++) &#123;<br>                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;<br>                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === player) &#123;<br>                            count++;<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            count = <span class="hljs-number">0</span>;<br>                        &#125;<br><br>                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> player;<br><br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment">// 检查左斜线是否有五子连线</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; lineNumber; j++) &#123;<br>                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;<br>                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === player) &#123;<br>                            count++;<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            count = <span class="hljs-number">0</span>;<br>                        &#125;<br><br>                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> player;<br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 重置游戏</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">restartGame</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span><br>            <span class="hljs-comment">//清空基础数据</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changePlayer</span>(<span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>)<br>            <span class="hljs-comment">//清空画布</span><br>            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br>            ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)<br>            <span class="hljs-comment">//重新绘制，会初始化棋子信息</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,<br>                boardDetail.<span class="hljs-property">lineNumber</span>,<br>                boardDetail.<span class="hljs-property">space</span>);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>)<br>        &#125;<br>        ,<br>    &#125;<br>&#125;<br>;<br>&lt;/script&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-board&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-chess&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleClickAndDraw($event)&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.main-board</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">display</span>: flex;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">align-items</span>: center;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">justify-content</span>: center;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.board-chess</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>OperateBoard.vue</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;<br><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: &#123;&#125;,<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;&#125;;<br>    &#125;,<br>    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()<br>        <span class="hljs-keyword">return</span> &#123;<br>            chessStore,<br>            <span class="hljs-title class_">PlayerStatus</span>,<br>            <span class="hljs-title class_">GameStatus</span><br>        &#125;<br>    &#125;,<br><br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变棋盘大小</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> square = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span><br>            <span class="hljs-keyword">const</span> newWidth = square<br>            <span class="hljs-keyword">const</span> newHeight = square<br>            <span class="hljs-keyword">const</span> newLineNumber = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span><br>            <span class="hljs-keyword">const</span> newSpace = newWidth / newLineNumber<br>            <span class="hljs-comment">// console.log(newWidth + &#x27;  &#x27; + newLineNumber + &#x27;  &#x27; + newSpace)</span><br>            <span class="hljs-comment">//重新设置board大小</span><br>            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)<br>            canvas.<span class="hljs-property">width</span> = newWidth<br>            canvas.<span class="hljs-property">height</span> = newHeight<br>            <span class="hljs-comment">//重新设置棋盘大小</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeBoardDetail</span>(newWidth, newLineNumber, newSpace)<br>            <span class="hljs-comment">//重新绘制游戏</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRestart</span>()<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 重新开始</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">handleRestart</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>)<br>        &#125;<br>    &#125;<br>&#125;;<br>&lt;/script&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate-board&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;detail&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>长宽：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.width&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>线条数：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.lineNumber&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>间距：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeBoardDetail()&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleRestart&quot;</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>当前落子：&#123;&#123; chessStore.player === PlayerStatus.WHITE ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>胜利方：&#123;&#123;</span><br><span class="language-xml">                    chessStore.status === GameStatus.WINNING ?</span><br><span class="language-xml">                        (chessStore.player === PlayerStatus.WHITE ? &quot;白棋&quot; : &quot;黑棋&quot;) : &quot;&quot;</span><br><span class="language-xml">                &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">text-align</span>: center;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &gt; <span class="hljs-selector-tag">span</span> <span class="hljs-selector-tag">input</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> <span class="hljs-selector-tag">span</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">props</span>: &#123;&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> &#123;&#125;;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            chessStore,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title class_">PlayerStatus</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title class_">GameStatus</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/**</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         * 改变棋盘大小</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> square = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> newWidth = square</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> newHeight = square</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> newLineNumber = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> newSpace = newWidth / newLineNumber</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// console.log(newWidth + &#x27;  &#x27; + newLineNumber + &#x27;  &#x27; + newSpace)</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//重新设置board大小</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)</span></span><br><span class="language-javascript"><span class="language-xml">            canvas.<span class="hljs-property">width</span> = newWidth</span></span><br><span class="language-javascript"><span class="language-xml">            canvas.<span class="hljs-property">height</span> = newHeight</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//重新设置棋盘大小</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeBoardDetail</span>(newWidth, newLineNumber, newSpace)</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//重新绘制游戏</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRestart</span>()</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/**</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         * 重新开始</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">handleRestart</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>)</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate-board&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;detail&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>长宽：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.width&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>线条数：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.lineNumber&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>间距：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeBoardDetail()&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleRestart&quot;</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>当前落子：&#123;&#123; chessStore.player === PlayerStatus.WHITE ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>胜利方：&#123;&#123;</span><br><span class="language-xml">                    chessStore.status === GameStatus.WINNING ?</span><br><span class="language-xml">                        (chessStore.player === PlayerStatus.WHITE ? &quot;白棋&quot; : &quot;黑棋&quot;) : &quot;&quot;</span><br><span class="language-xml">                &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">text-align</span>: center;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &gt; <span class="hljs-selector-tag">span</span> <span class="hljs-selector-tag">input</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> <span class="hljs-selector-tag">span</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（三）</title>
      <link href="/2024/11/29/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%B8%89%EF%BC%89/"/>
      <url>/2024/11/29/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%B8%89%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>利用下午的时间，对这个程序进行了优化，主要拆解成组件形式，大致分为2个部分。1个部分为棋盘主要内容；1个部分为棋盘控制部分。在此过程中不断的了解了：</p><p>1、父组件传递子组件值</p><p>2、子组件修改父组件值</p><p>3、监听某个值的变化，如重新开始restart</p><p>4、也对新旧VUE产生了一定的想法，后续在琢磨怎么实现的了，想引入状态管理</p><p>【GoBang.vue】：主要布局组件，该组件主要引入上面所说的两个组件，并提取部分公共变量至此</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MainBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./MainBoard.vue&#x27;</span></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">OperateBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./OperateBoard.vue&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">player</span>: <span class="hljs-number">1</span>,<span class="hljs-comment">//1--白棋；2--黑棋</span></span><br><span class="language-javascript">            <span class="hljs-attr">winner</span>: <span class="hljs-number">0</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">restart</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">boardDetail</span>: &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: <span class="hljs-number">600</span>,<span class="hljs-comment">//棋盘大小</span></span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: <span class="hljs-number">20</span>,<span class="hljs-comment">//棋盘线数</span></span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: <span class="hljs-number">30</span>,<span class="hljs-comment">//间隙</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">components</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title class_">MainBoard</span>, <span class="hljs-title class_">OperateBoard</span></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;五子棋&quot;</span>;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">watch</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">restart</span>(<span class="hljs-params">nV, oV</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (nV) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-number">1</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-number">0</span></span><br><span class="language-javascript">                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">                    <span class="hljs-comment">//设置一个1秒延时，用于子组件捕获数据变化</span></span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">restart</span> = <span class="hljs-literal">false</span></span><br><span class="language-javascript">                &#125;, <span class="hljs-number">1000</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;root-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">MainBoard</span> <span class="hljs-attr">:boardDetail</span>=<span class="hljs-string">&quot;boardDetail&quot;</span></span><br><span class="hljs-tag">                   <span class="hljs-attr">v-model:player</span>=<span class="hljs-string">&quot;player&quot;</span></span><br><span class="hljs-tag">                   <span class="hljs-attr">v-model:winner</span>=<span class="hljs-string">&quot;winner&quot;</span></span><br><span class="hljs-tag">                   <span class="hljs-attr">v-model:restart</span>=<span class="hljs-string">&quot;restart&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">OperateBoard</span> <span class="hljs-attr">v-model:boardDetail</span>=<span class="hljs-string">&quot;boardDetail&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">:player</span>=<span class="hljs-string">&quot;player&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">:winner</span>=<span class="hljs-string">&quot;winner&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">v-model:restart</span>=<span class="hljs-string">&quot;restart&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.root-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">align-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>【MainBoard.vue】主要用于下棋的部分，逻辑和之前一样，数据传输形式变了，感觉变复杂了</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">props</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">boardDetail</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: [],</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">player</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-number">1</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">winner</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">restart</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">board</span>: [],</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">watch</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">restart</span>(<span class="hljs-params">nV, oV</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//监听restart重绘命令，以便重新绘制</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (nV) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restartGame</span>()</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-comment">// 实例创建完成，仅在首次加载时完成</span></span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">            boardDetail.<span class="hljs-property">lineNumber</span>,</span><br><span class="language-javascript">            boardDetail.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 画整体棋盘</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> width 所需棋盘整体大小，上下左右预留一半space空间</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数，线条数*间距=width</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> space 间距</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params">width, lineNumber, space</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">// 设置线条颜色</span></span><br><span class="language-javascript">            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制横线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(width - halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制竖线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(i * space + halfSpace, halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(i * space + halfSpace, width - halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">//填充数组，重置为0</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(lineNumber).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 监听每步棋子，需要传入棋盘信息</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">event</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> detail 棋盘信息</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event, detail</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//存在输赢以后，不允许在落子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> lineNumber = detail.<span class="hljs-property">lineNumber</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> space = detail.<span class="hljs-property">space</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// let x = event.offsetX;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// let y = event.offsetY;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(x + &#x27;   &#x27; + y)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 计算棋子落在哪个方格中</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(cellX, cellY)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 判断该位置是否有棋子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span></span><br><span class="language-javascript">            <span class="hljs-comment">//考虑起点为2，因半径为space一半，避免太大，截止1/3大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                <span class="hljs-number">2</span>,</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span></span><br><span class="language-javascript">            )</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">            ctx.<span class="hljs-property">fillStyle</span> = grd</span><br><span class="language-javascript">            <span class="hljs-comment">//画圆，半径设置为space/3，同上r1参数一致</span></span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">arc</span>(</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span>,</span><br><span class="language-javascript">                <span class="hljs-number">0</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,</span><br><span class="language-javascript">                <span class="hljs-literal">false</span></span><br><span class="language-javascript">            );</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">closePath</span>();</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>; <span class="hljs-comment">//将黑白棋信息存储</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> winner_current = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>, lineNumber) <span class="hljs-comment">//判断输赢</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (winner_current !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//代表此次操作有胜负，更新结果</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;update:winner&quot;</span>, winner_current)</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(winner_current)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">//通知父组件，修改了选手内容值</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;update:player&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span>)<span class="hljs-comment">//交换</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 胜负检查</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> board X*X 二维数组</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@returns</span> <span class="hljs-variable">number</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board, lineNumber</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 检查横向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查纵向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查右斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber - <span class="hljs-number">5</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查左斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 重置游戏</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">restartGame</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//清空基础数据</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = []</span><br><span class="language-javascript">            <span class="hljs-comment">//清空画布</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>,</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-chess&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span></span><br><span class="hljs-tag">                @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleClickAndDraw($event,this.boardDetail)&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.main-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-chess</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>【OperateBoard.vue】主要用于控制棋盘，如重新开始，重新绘制等，主要是通过对父组件的变量修改实现</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">props</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">boardDetail</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: [],</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">player</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-number">1</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">winner</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">inputBoardDetail</span>: &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: <span class="hljs-number">600</span>,<span class="hljs-comment">//棋盘大小</span></span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: <span class="hljs-number">20</span>,<span class="hljs-comment">//棋盘线数</span></span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: <span class="hljs-number">30</span>,<span class="hljs-comment">//间隙</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">width</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">lineNumber</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">space</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> square = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">width</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> lineNumber = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">lineNumber</span></span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置board大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)</span><br><span class="language-javascript">            canvas.<span class="hljs-property">width</span> = square</span><br><span class="language-javascript">            canvas.<span class="hljs-property">height</span> = square</span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置棋盘大小</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;update:boardDetail&quot;</span>, &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: square,</span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: lineNumber,</span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: square / lineNumber</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制游戏</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRestart</span>()</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">handleRestart</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;update:restart&quot;</span>, <span class="hljs-literal">true</span>)<span class="hljs-comment">//交换</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘信息：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘长宽：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.inputBoardDetail.width&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘线条数：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.inputBoardDetail.lineNumber&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘间距：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.inputBoardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeBoardDetail()&quot;</span>&gt;</span>修改<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleRestart&quot;</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>当前落子：&#123;&#123; this.player === 1 ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>胜利方：&#123;&#123; this.winner === 1 ? &quot;白棋&quot; : this.winner === 2 ? &quot;黑棋&quot; : &quot;&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-detail</span> &gt; <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">input</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（二）</title>
      <link href="/2024/11/29/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
      <url>/2024/11/29/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>在昨天的基础上，对五子棋进行了调整</p><p>1、增加了背景颜色</p><p>2、增加了修改棋盘大小功能</p><p>3、增加了重新开始功能</p><p>仍未进行代码优化，同时对vue的data内的数据修改、读取，未发现好的方式，既可以直接读取带来的方便，但感觉也会带来随意修改数据产生的意外，会影响健壮性。</p><p>完整代码Game.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">board</span>: [],</span><br><span class="language-javascript">            <span class="hljs-attr">player</span>: <span class="hljs-number">1</span>,<span class="hljs-comment">//1--白棋；2--黑棋</span></span><br><span class="language-javascript">            <span class="hljs-attr">winner</span>: <span class="hljs-literal">null</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">restart</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">boardDetail</span>: &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">//棋盘大小</span></span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">//棋盘线数</span></span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">//间隙</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-comment">// 实例刚创建，但未挂载dom</span></span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;五子棋&quot;</span>;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-comment">// 实例创建完成，仅在首次加载时完成</span></span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span> = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">width</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>).<span class="hljs-property">clientWidth</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">lineNumber</span>: <span class="hljs-number">20</span>,<span class="hljs-comment">//棋盘线数</span></span><br><span class="language-javascript">            <span class="hljs-attr">space</span>: <span class="hljs-number">30</span>,<span class="hljs-comment">//间隙</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>,</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 画整体棋盘</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> width 所需棋盘整体大小，上下左右预留一半space空间</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数，线条数*间距=width</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> space 间距</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params">width, lineNumber, space</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">// 设置线条颜色</span></span><br><span class="language-javascript">            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制横线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(width - halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制竖线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(i * space + halfSpace, halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(i * space + halfSpace, width - halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">//填充数组，重置为0</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(lineNumber).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 监听每步棋子，需要传入棋盘信息</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">event</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> detail 棋盘信息</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event, detail</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//存在输赢以后，不允许在落子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> != <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> lineNumber = detail.<span class="hljs-property">lineNumber</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> space = detail.<span class="hljs-property">space</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// let x = event.offsetX;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// let y = event.offsetY;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(x + &#x27;   &#x27; + y)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 计算棋子落在哪个方格中</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(cellX, cellY)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 判断该位置是否有棋子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span></span><br><span class="language-javascript">            <span class="hljs-comment">//考虑起点为2，因半径为space一半，避免太大，截止1/3大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                <span class="hljs-number">2</span>,</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span></span><br><span class="language-javascript">            )</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">            ctx.<span class="hljs-property">fillStyle</span> = grd</span><br><span class="language-javascript">            <span class="hljs-comment">//画圆，半径设置为space/3，同上r1参数一致</span></span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">arc</span>(</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span>,</span><br><span class="language-javascript">                <span class="hljs-number">0</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,</span><br><span class="language-javascript">                <span class="hljs-literal">false</span></span><br><span class="language-javascript">            );</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">closePath</span>();</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>; <span class="hljs-comment">//将黑白棋信息存储</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>, lineNumber) <span class="hljs-comment">//判断输赢</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> != <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span><span class="hljs-comment">//交换</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 胜负检查</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> board X*X 二维数组</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@returns</span> &#123;<span class="hljs-type">number|null</span>&#125;</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board, lineNumber</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 检查横向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查纵向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查右斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber - <span class="hljs-number">5</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查左斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 重置游戏</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">restartGame</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//清空基础数据</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = []</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-number">1</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-literal">null</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">restart</span> = <span class="hljs-literal">false</span></span><br><span class="language-javascript">            <span class="hljs-comment">//清空画布</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>,</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">updateDetail</span>(<span class="hljs-params">square, lineNumber</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置board大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)</span><br><span class="language-javascript">            canvas.<span class="hljs-property">width</span> = square</span><br><span class="language-javascript">            canvas.<span class="hljs-property">height</span> = square</span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置棋盘大小</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span> = &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: square,</span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: lineNumber,</span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: square / lineNumber</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制游戏</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restartGame</span>()</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-chess&quot;</span></span><br><span class="hljs-tag">                @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleClickAndDraw($event,this.boardDetail)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-detail&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘信息：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘长宽：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.boardDetail.width&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘线条数：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.boardDetail.lineNumber&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘间距：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.boardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;updateDetail(this.boardDetail.width,this.boardDetail.lineNumber)&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;restartGame&quot;</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>当前落子：&#123;&#123; this.player === 1 ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>胜利方：&#123;&#123; this.winner === 1 ? &quot;白棋&quot; : this.winner === 2 ? &quot;黑棋&quot; : &quot;&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-chess</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-detail</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;</span><br><span class="language-css"></span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-detail</span> &gt; <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">input</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>效果图，测试中发现了一个bug，斜线的胜负检验逻辑有问题<br><img src="/images/%E6%95%88%E6%9E%9C%E5%9B%BE2.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（一）</title>
      <link href="/2024/11/28/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2024/11/28/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>趁着休息，花了1小时参考网上各类简单的写了个五子棋，主要实现功能，未进行任何优化</p><p>修改画布大小及棋子布局</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><p>CSS相应如下</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.board</span> &#123;<br>    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid red;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">630px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">630px</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">display</span>: flex;<br>    <span class="hljs-attribute">align-items</span>: center;<br>    <span class="hljs-attribute">justify-content</span>: center;<br>&#125;<br></code></pre></td></tr></table></figure><p>1、绘制棋盘，以30为一格，考虑棋子落在交叉点，故在绘制时右移和下移了15，并将数组进行重置（600的棋盘，30一个，共20个）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">drawBoard</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>    <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br><br>    <span class="hljs-comment">// 设置线条颜色</span><br>    ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;<br>    <span class="hljs-comment">// 绘制横线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;<br>        ctx.<span class="hljs-title function_">beginPath</span>();<br>        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">15</span>, i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>);<br>        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">570</span> + <span class="hljs-number">15</span>, i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>);<br>        ctx.<span class="hljs-title function_">stroke</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 绘制竖线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;<br>        ctx.<span class="hljs-title function_">beginPath</span>();<br>        ctx.<span class="hljs-title function_">moveTo</span>(i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>, <span class="hljs-number">0</span> + <span class="hljs-number">15</span>);<br>        ctx.<span class="hljs-title function_">lineTo</span>(i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>, <span class="hljs-number">570</span> + <span class="hljs-number">15</span>);<br>        ctx.<span class="hljs-title function_">stroke</span>();<br>    &#125;<br>    <span class="hljs-comment">// 重置为0</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">20</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))<br>    &#125;<br>    <span class="hljs-comment">// console.log(this.board)</span><br>&#125;,<br></code></pre></td></tr></table></figure><p>2、绘制棋子，考虑正负15的距离，此处在绘制完成后，进行了正负判断，选手交换</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">drawCell</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>    container.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClickAndDraw</span>)<br>        &#125;,<br><span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event</span>) &#123;<br>    <span class="hljs-keyword">let</span> x = event.<span class="hljs-property">offsetX</span>;<br>    <span class="hljs-keyword">let</span> y = event.<span class="hljs-property">offsetY</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x + <span class="hljs-string">&#x27;   &#x27;</span> + y)<br>    <span class="hljs-comment">// 计算棋子落在哪个方格中</span><br>    <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / <span class="hljs-number">30</span>);<br>    <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / <span class="hljs-number">30</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cellX, cellY)<br>    <span class="hljs-comment">// 判断该位置是否有棋子</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>    <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br>    <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span><br>    <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<br>        cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-number">2</span>,<br>        cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-number">10</span><br>    )<br>    grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)<br>    grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)<br>    ctx.<span class="hljs-title function_">beginPath</span>()<br>    ctx.<span class="hljs-property">fillStyle</span> = grd<br>    ctx.<span class="hljs-title function_">arc</span>(<br>        cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-number">10</span>,<br>        <span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,<br>        <span class="hljs-literal">false</span><br>    );<br>    ctx.<span class="hljs-title function_">fill</span>();<br>    ctx.<span class="hljs-title function_">closePath</span>();<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>; <span class="hljs-comment">//将黑白棋信息存储</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span>)<br>    &#125;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span><br>&#125;,<br></code></pre></td></tr></table></figure><p>3、正负判断，这个主要采取网上CSDN，并未进行过多加工</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board</span>) &#123;<br>    <span class="hljs-comment">// 检查横向是否有五子连线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">19</span>; i++) &#123;<br>        <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;<br>            <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;<br>                count++;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                count = <span class="hljs-number">0</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 检查纵向是否有五子连线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;<br>        <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">19</span>; i++) &#123;<br>            <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;<br>                count++;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                count = <span class="hljs-number">0</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 检查右斜线是否有五子连线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">14</span>; j++) &#123;<br>            <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;<br>                <span class="hljs-keyword">if</span> (board[i + k][j + k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;<br>                    count++;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    count = <span class="hljs-number">0</span>;<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 检查左斜线是否有五子连线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;<br>            <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;<br>                <span class="hljs-keyword">if</span> (board[i + k][j - k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;<br>                    count++;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    count = <span class="hljs-number">0</span>;<br>                &#125;<br><br>               <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;<br>                   <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>最后，完整代码如下App.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">board</span>: [],</span><br><span class="language-javascript">            <span class="hljs-attr">player</span>: <span class="hljs-number">1</span>,<span class="hljs-comment">//1--白棋；2--黑棋</span></span><br><span class="language-javascript">            <span class="hljs-attr">winner</span>: <span class="hljs-literal">null</span></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>();</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawCell</span>();</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 设置线条颜色</span></span><br><span class="language-javascript">            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 绘制横线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">15</span>, i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">570</span> + <span class="hljs-number">15</span>, i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 绘制竖线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>, <span class="hljs-number">0</span> + <span class="hljs-number">15</span>);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>, <span class="hljs-number">570</span> + <span class="hljs-number">15</span>);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// 重置为0</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">20</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(this.board)</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">drawCell</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            container.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClickAndDraw</span>)</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> x = event.<span class="hljs-property">offsetX</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> y = event.<span class="hljs-property">offsetY</span>;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x + <span class="hljs-string">&#x27;   &#x27;</span> + y)</span><br><span class="language-javascript">            <span class="hljs-comment">// 计算棋子落在哪个方格中</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / <span class="hljs-number">30</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / <span class="hljs-number">30</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cellX, cellY)</span><br><span class="language-javascript">            <span class="hljs-comment">// 判断该位置是否有棋子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(</span><br><span class="language-javascript">                cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span>,</span><br><span class="language-javascript">                cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                <span class="hljs-number">10</span></span><br><span class="language-javascript">            )</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">            ctx.<span class="hljs-property">fillStyle</span> = grd</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">arc</span>(</span><br><span class="language-javascript">                cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                <span class="hljs-number">10</span>,</span><br><span class="language-javascript">                <span class="hljs-number">0</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,</span><br><span class="language-javascript">                <span class="hljs-literal">false</span></span><br><span class="language-javascript">            );</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">closePath</span>();</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>; <span class="hljs-comment">//将黑白棋信息存储</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> != <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 检查横向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查纵向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查右斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">14</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;</span><br><span class="language-javascript">                            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查左斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;</span><br><span class="language-javascript">                            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid red;</span><br><span class="language-css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">630px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">height</span>: <span class="hljs-number">630px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>效果图<br><img src="/images/%E6%95%88%E6%9E%9C%E5%9B%BE1.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于Flask的WebHooks服务搭建</title>
      <link href="/2024/07/04/%E5%9F%BA%E4%BA%8EFlask%E7%9A%84WebHooks%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/07/04/%E5%9F%BA%E4%BA%8EFlask%E7%9A%84WebHooks%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>1、首先确保已正确安装nginx，supervisor，并正常启用nginx和supervisor</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">yum install nginx supervisor<br>systemctl start nginx<br>systemctl enable nginx<br>systemctl start supervisor<br>systemctl enable supervisor<br></code></pre></td></tr></table></figure><p>2、新建Flask项目和相关虚拟环境包等</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">virtualenv venv <span class="hljs-comment">#新建虚拟环境</span><br>. venv/<span class="hljs-built_in">bin</span>/activate<br>pip install gunicorn<br></code></pre></td></tr></table></figure><p>3、修改app.py文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify<br><br>app = Flask(__name__)<br><br><span class="hljs-comment"># gitee中webhooks的secret</span><br>gitee_secret = <span class="hljs-string">&#x27;XXXX&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hooks&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">post_data</span>():<br>    <span class="hljs-comment"># 认证签名是否有效</span><br>    signature = request.headers.get(<span class="hljs-string">&#x27;X-Gitee-Token&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;获取到访问token:%s&quot;</span>, signature)<br><br>    <span class="hljs-keyword">if</span> signature != gitee_secret:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;token认证无效&quot;</span>, <span class="hljs-number">401</span><br>    <span class="hljs-comment"># 运行shell脚本，更新代码</span><br>    os.system(<span class="hljs-string">&#x27;sh deploy.sh&#x27;</span>)<br>    <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-number">200</span>&#125;)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run()<br></code></pre></td></tr></table></figure><p>3、新建deploy.sh文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &#x27;========Start DEPLY========&#x27;<br>echo &#x27;--------enter Dir ------------&#x27;<br>cd /home/opc/XXXX<br>echo &#x27;--------start git pull------------&#x27;<br>git pull<br>echo &#x27;--------init requirements------------&#x27;<br>. venv/bin/activate<br>pip install -r requirements.txt<br>deactivate<br>echo &#x27;-----ex root-----&#x27;<br>sudo -i<br>echo &#x27;-----restart supervision-----&#x27;<br>supervisorctl restart XXXX<br>echo &#x27;----- reload nginx-----&#x27;<br>nginx -s reload<br>echo &#x27;========END DEPLY========&#x27;<br></code></pre></td></tr></table></figure><p>4、新建supervisor.ini文件（也可省略，手工启动即可）</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment">;[include]</span><br><span class="hljs-comment">;files = relative/directory/*.ini</span><br><span class="hljs-section">[program:XXXX]</span><span class="hljs-attr">directory</span>=/home/opc/XXXX<br><span class="hljs-attr">command</span>=/home/opc/XXXX/venv/bin/python3 /home/opc/XXXX/venv/bin/gunicorn -b <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">1111</span> app:app<br><span class="hljs-attr">startsecs</span>=<span class="hljs-number">0</span><br><span class="hljs-attr">stopwaitsecs</span>=<span class="hljs-number">0</span><br><span class="hljs-attr">autostart</span>=<span class="hljs-literal">true</span><br><span class="hljs-attr">autorestart</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>5、将supervisor.ini文件拷贝到&#x2F;etc&#x2F;supervisor.d&#x2F;目录下，并重启supervisord</p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python离线环境部署搭建</title>
      <link href="/2024/07/04/python%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/07/04/python%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>1、需要保证两边环境一致，仅以Win为例进行了测试，按理应该一样。</p><p>2、安装完毕后没有虚拟环境，可先将全局包进行安装。</p><p>3、虚拟环境和系统正式环境操作一致，区别仅在于是否激活虚拟环境，即当前pip是针对的什么环境，可通过pip list进行查看</p><h2 id="具体步骤："><a href="#具体步骤：" class="headerlink" title="具体步骤："></a>具体步骤：</h2><p>1.生成安装包列表文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 安装包列表保存到文件requirements.txt中，文件名是自己定义，</span><br><span class="hljs-comment"># 如果文件已经存在会被覆盖更新，不存在会自动创建</span><br><span class="hljs-comment"># 虚拟环境目录下执行这个命令，则打包的虚拟环境的内容</span><br><span class="hljs-comment"># 否则生成的文件内容是系统python版本使用的安装包列表</span><br>pip freeze &gt; requirements.txt<br></code></pre></td></tr></table></figure><p>2.将包列表文件中的所有包下载到文件夹下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># [.\\packages]为保存安装包的路径，不存在会被创建</span><br><span class="hljs-comment"># [requirements.txt]为前一步生成的包列表文件</span><br>pip download -d  .\\packages  -r requirements.txt<br></code></pre></td></tr></table></figure><p>3.将①和②中生成的包列表文件和安装包文件夹复制到另一台上<br>4.依据包列表文件以及安装包文件夹来安装包</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># [.\\packages]为安装包文件夹路径</span><br><span class="hljs-comment"># [requirements.txt]为包文件列表</span><br><span class="hljs-comment"># 注意相对路径和绝对路径的选择</span><br>pip install --no-index --find-links=.\\packages -r requirements.txt<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于falsk-sqlalchemy中多数据库配置及使用</title>
      <link href="/2024/07/04/%E5%85%B3%E4%BA%8Efalsk-sqlalchemy%E4%B8%AD%E5%A4%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/07/04/%E5%85%B3%E4%BA%8Efalsk-sqlalchemy%E4%B8%AD%E5%A4%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p> 近期发现了几个免费的数据库，想着尝试用Flask进行简单连接 以前一直使用SQLite，近期打算尝试连接MySQL和Postgre 一些简单的安装等命令就此略过</p><h2 id="多数据源配置"><a href="#多数据源配置" class="headerlink" title="多数据源配置"></a>多数据源配置</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 配置SQLite数据源</span><br>sqlite_path = os.path.join(BASE_DIR, <span class="hljs-string">&quot;sys.db&quot;</span>)<br>app.config[<span class="hljs-string">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = <span class="hljs-string">&#x27;sqlite:///&#x27;</span> + sqlite_path<br><span class="hljs-comment"># 配置MySQL（TiDB）数据源</span><br>MYSQL_USERNAME = <span class="hljs-string">&#x27;USERNAME&#x27;</span><br>MYSQL_PASSWORD = <span class="hljs-string">&#x27;PASSWORD&#x27;</span><br>MYSQL_URL = <span class="hljs-string">&#x27;SQL_URL&#x27;</span><br>MYSQL_PORT = <span class="hljs-string">&#x27;PORT&#x27;</span><br>MYSQL_DATABASE = <span class="hljs-string">&#x27;main&#x27;</span><br>MYSQL_SSL = &#123;<br>    <span class="hljs-string">&#x27;ssl_verify_cert&#x27;</span>: <span class="hljs-string">&#x27;True&#x27;</span>,<br>    <span class="hljs-string">&#x27;ssl_verify_identity&#x27;</span>: <span class="hljs-string">&#x27;True&#x27;</span>,<br>    <span class="hljs-string">&#x27;ssl_cert&#x27;</span>: BASE_DIR + <span class="hljs-string">&#x27;/ca/cert.crt&#x27;</span>,<br>    <span class="hljs-string">&#x27;ssl_key&#x27;</span>: BASE_DIR + <span class="hljs-string">&#x27;/ca/private.key&#x27;</span><br>&#125;<br>MYSQL_URL_ALL = <span class="hljs-string">&#x27;mysql+pymysql://%s:%s@%s:%s/%s?%s&#x27;</span> % (<br>    MYSQL_USERNAME, MYSQL_PASSWORD, MYSQL_URL, MYSQL_PORT, MYSQL_DATABASE, urlencode(MYSQL_SSL))<br><span class="hljs-comment"># 配置Postgre数据源</span><br>PG_USERNAME = <span class="hljs-string">&#x27;USERNAME&#x27;</span><br>PG_PASSWORD = <span class="hljs-string">&#x27;PASSWORD&#x27;</span><br>PG_URL = <span class="hljs-string">&#x27;SQL_URL&#x27;</span><br>PG_PORT = <span class="hljs-string">&#x27;PORT&#x27;</span><br>PG_DATABASE = <span class="hljs-string">&#x27;main&#x27;</span><br>PG_URL_ALL = <span class="hljs-string">&#x27;postgresql://%s:%s@%s:%s/%s&#x27;</span> % (PG_USERNAME, PG_PASSWORD, PG_URL, PG_PORT, PG_DATABASE)<br>app.config[<span class="hljs-string">&#x27;SQLALCHEMY_BINDS&#x27;</span>] = &#123;<br>    <span class="hljs-string">&#x27;tidb&#x27;</span>: MYSQL_URL_ALL,<br>    <span class="hljs-string">&#x27;pg&#x27;</span>: PG_URL_ALL,<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><p>1、因为TiDB需要SSL认证，所以加入了SSL&#x3D;True的条件，可根据需要自行设置，关于证书生成如下，共计生成3个文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">openssl genpkey -algorithm RSA -out private.pem -pkeyopt rsa_keygen_bits:2048<br>openssl req -new -key private.pem -out cert.csr<br>openssl x509 -req -days 365 -in cert.csr -signkey private.pem -out cert.crt<br></code></pre></td></tr></table></figure><h2 id="Model中的配置区别"><a href="#Model中的配置区别" class="headerlink" title="Model中的配置区别"></a>Model中的配置区别</h2><p>1、SQLite中的使用，和日常没区别</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(db.Model):<br><span class="hljs-built_in">id</span> = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<br>username = db.Column(db.String(<span class="hljs-number">80</span>), unique=<span class="hljs-literal">True</span>)<br>email = db.Column(db.String(<span class="hljs-number">120</span>), unique=<span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, username, email</span>):<br>    <span class="hljs-variable language_">self</span>.username = username<br>    <span class="hljs-variable language_">self</span>.email = email<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;User %r&gt;&#x27;</span> % <span class="hljs-variable language_">self</span>.username<br></code></pre></td></tr></table></figure><p>2、MySQL中的使用，需要添加BINDS相关信息，用于区分数据源，tidb为前期配置文件内的值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Good</span>(db.Model):<br>__bind_key__ = <span class="hljs-string">&#x27;tidb&#x27;</span><br><span class="hljs-built_in">id</span> = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<br>good = db.Column(db.String(<span class="hljs-number">80</span>), unique=<span class="hljs-literal">True</span>)<br>email = db.Column(db.String(<span class="hljs-number">120</span>), unique=<span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, good, email</span>):<br>    <span class="hljs-variable language_">self</span>.good = good<br>    <span class="hljs-variable language_">self</span>.email = email<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;Good %r&gt;&#x27;</span> % <span class="hljs-variable language_">self</span>.good<br></code></pre></td></tr></table></figure><p>3、Postgre中的使用，同样需要添加BINDS信息<br>区分MYSQL，PG库中有一个schema概念，若未设置对应模式，则默认为public下的表，如下展示为设置test模式下的表，也增加了tablename的示例</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Name</span>(db.Model):<br>__bind_key__ = <span class="hljs-string">&#x27;pg&#x27;</span><br>__table_args__ = (&#123;<span class="hljs-string">&quot;schema&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>&#125;)<br>__tablename__ = <span class="hljs-string">&#x27;name&#x27;</span><br><span class="hljs-built_in">id</span> = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<br>name = db.Column(db.String(<span class="hljs-number">80</span>), unique=<span class="hljs-literal">True</span>)<br>email = db.Column(db.String(<span class="hljs-number">120</span>), unique=<span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, email</span>):<br>    <span class="hljs-variable language_">self</span>.name = name<br>    <span class="hljs-variable language_">self</span>.email = email<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;Name %r&gt;&#x27;</span> % <span class="hljs-variable language_">self</span>.name<br></code></pre></td></tr></table></figure><h2 id="最终程序测试"><a href="#最终程序测试" class="headerlink" title="最终程序测试"></a>最终程序测试</h2><p>经过此配置，则可通过此种方式进行测试</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># SQLite</span><br>ur = User(<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;admin@example.com&#x27;</span>)<br>db.session.add(ur)<br><span class="hljs-comment">#TiDB</span><br>gd = Good(<span class="hljs-string">&#x27;good&#x27;</span>, <span class="hljs-string">&#x27;good@example.com&#x27;</span>)<br>db.session.add(gd)<br><span class="hljs-comment"># PG</span><br>ne = Name(<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;name@example.com&#x27;</span>)<br>db.session.add(ne)<br>db.session.commit()<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>有网络锁重置解网络锁</title>
      <link href="/2023/07/04/%E6%9C%89%E7%BD%91%E7%BB%9C%E9%94%81%E9%87%8D%E7%BD%AE%E8%A7%A3%E7%BD%91%E7%BB%9C%E9%94%81/"/>
      <url>/2023/07/04/%E6%9C%89%E7%BD%91%E7%BB%9C%E9%94%81%E9%87%8D%E7%BD%AE%E8%A7%A3%E7%BD%91%E7%BB%9C%E9%94%81/</url>
      
        <content type="html"><![CDATA[<p>出于无法使用XXQG，于是就对闲鱼430购买的Pixel 4XL进行还原重置，买的有网络锁的机器，需要重新解锁，用来记录。<br>1、重置，离线进入手机，开启USB调试模式<br>2、执行以下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell pm uninstall -k --user 0 com.google.android.apps.work.oobconfig<br></code></pre></td></tr></table></figure><p>3、执行配置命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell &quot;settings put global captive_portal_https_url https://captive.v2ex.co/generate_204&quot;<br></code></pre></td></tr></table></figure><p>4、重启手机、插卡正常使用</p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 手机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次洗牙过程</title>
      <link href="/2022/07/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%B4%97%E7%89%99%E8%BF%87%E7%A8%8B/"/>
      <url>/2022/07/04/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%B4%97%E7%89%99%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>源于上周去检查车祸后的肺部慢性肺炎，突然奇想去进行一次洗牙，其实当初洗牙的目的是为了美白，但预约完毕后，发现主要用于处理牙垢。</p><p>上周已抽血化验，这周二直接杀过去就可以，还是上次的医生。</p><p>洗牙过程整体还行，在未开始前存在害怕，洗牙过程对原本敏感的牙齿有影响，明显能够感觉到痛，而其它的，基本可以出于无感，洗牙过程会出血，洗好以后牙齿有异样的感觉。</p><p>就医，特别是当躺在手术床上，任由别人进行处置时，内心是害怕的，此时人和动物是没差别的，完全可以当成是兽，医生也可以是兽医，只是对待方式不一致。</p>]]></content>
      
      
      <categories>
          
          <category> 生活琐事 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>记录一次车祸（回忆分析）</title>
      <link href="/2022/03/31/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E8%BD%A6%E7%A5%B8%EF%BC%88%E5%9B%9E%E5%BF%86%E5%88%86%E6%9E%90%EF%BC%89/"/>
      <url>/2022/03/31/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E8%BD%A6%E7%A5%B8%EF%BC%88%E5%9B%9E%E5%BF%86%E5%88%86%E6%9E%90%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>开车从毕业到现在已近6年，基本没有事故甚至把别人刮擦，记得上一次事故是家里大人怀孕做坐月子期间，在五彩城拐弯去华润超市时。</p><p>回忆起来上次应该是看了右后视镜，要弯道拐弯进去，而看的过程中前车奔驰突然刹车了，导致还没进入转弯道，就撞到了，踩了紧急刹车，撞的不严重，一切按照保险来。当时认定自己追尾全责，事后回想，是否前车本来也要右转，存在压线的可能，翻看照片无法看出，因此此事也就到此结束。</p><p>22年此次车祸就比较严重，前车凹进去，正副驾驶座安全气囊弹出来，因汽车使用时间较长了，已达保费临近值，最终和修理店协商，卖给修理店，后续由修理店再进行处理。</p><h2 id="事故过程描述："><a href="#事故过程描述：" class="headerlink" title="事故过程描述："></a>事故过程描述：</h2><p>刚下高速，需要盘圈上高架（1行车道1应急道），正在行驶中，突然觉得可能会撞到对面，打了方向盘，并踩了刹车，感觉圈打的以往的大，但是感觉上不到四分之一圈且不急，那一瞬间觉得可能会出问题，突然之间车子开始不受控制，脑海中一片空白，想着要撞了的。车子先撞了右前方，后转圈到右后方，最终撞了左前方停下来。</p><h2 id="事故过程分析："><a href="#事故过程分析：" class="headerlink" title="事故过程分析："></a>事故过程分析：</h2><p>1、【突然】，是因为事后回想起来，是因为突然发现脑海中出现了感觉要撞到前面，速度有点快的画面，而看到之前的1秒是是在开车、玩手机或者想事情，均没有任何记忆。</p><p>2、【打了方向盘】，回想起来感觉不是很突然的打很大的圈，也是日常的打圈，并踩了刹车用于降速（事后回想）</p><p>3、【踩了刹车】，自己想来是应该之前踩了油门在加速，后发现过快踩了刹车。但是车子撞的相对比较厉害，感觉又加速往前冲的迹象，自己怀疑是不是车子不受控制到撞之前在踩油门而非刹车，没有记录仪无法获知。目前无法回想起来那个瞬间脚放在油门还是刹车，后续在多次开车路过的时候特意留意，在该路段盘旋上去的过程中是需要踩油门的。</p><p>4、【觉得可能会出问题】，这个是玄学或者是因为出了事故刚好印证了那会的灵光一闪</p><p>5、【一片空白】，那个过程一片空白，其实那个时候在想很多事情，但是却无法回想起来，在一个瞬间有点闷的状态</p><h2 id="事故处理分析："><a href="#事故处理分析：" class="headerlink" title="事故处理分析："></a>事故处理分析：</h2><p>在车子撞了以后，闻到有股烧焦味（事后交警告知是因为安全气囊弹出有火药），第一时间想着下车，正副驾驶座因为车头变形无法打开，打电话给110进行报警，后想到可以通过后座下车，遂顺利下车等交警。下车后有点懵的状态。</p><p>1、下车后有辆维修的车迅速赶到，比交警还早，最终也在该维修厂卖给了卖家。过程较为曲折，错误在于当初不该选择该类维修厂，后续车拖进去以后就难以在开出来去其它地方维修，维修厂不让放车走（后续有时间在写一个此类的历程）。</p><p>2、再交给路边黄牛维修车前，内心是矛盾的，既知道他们是路边黄牛可能会出问题，又想着要么就交给他们维修的就好了的，最终选择了他们。</p><p>3、事故后未第一时间选择进行4S店维修，全程未想到，只有晚上到家停顿下来回想后，才想起来可以去4S店维修，单方事故，未涉及其它车辆。</p><p>4、事故发生后，交警询问人是否有受伤，轻率的回答了没事，交警单未写任何人受伤，但事故后2小时开始出现胸腔肋骨痛，维修厂小哥告知是气囊弹出缘故，且交警当初特地问了人有没有受伤就是基于此的，后由维修厂小哥带着去交警队重新开具事故单附上胸腔受伤，下午去医院自费进行看病，幸好未任何问题。</p><h2 id="后续影响："><a href="#后续影响：" class="headerlink" title="后续影响："></a>后续影响：</h2><p>目前回想，车子不应该报废，最好的办法是给4S店进行维修，则此时还可以开，因为报废，导致家里需要购置2辆车（本旧车给老人，新买电动车），恰逢电动车涨价，亏了好几万。</p>]]></content>
      
      
      <categories>
          
          <category> 生活琐事 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
