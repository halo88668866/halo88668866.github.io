<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>架构-数据库系统</title>
      <link href="/2025/07/21/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/"/>
      <url>/2025/07/21/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>架构-计算机基础-软件-操作系统</title>
      <link href="/2025/07/20/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%BD%AF%E4%BB%B6-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
      <url>/2025/07/20/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%BD%AF%E4%BB%B6-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F.png" alt="计算机系统"></p><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><ul><li>有效地组织和管理系统中的各种软件&#x2F;硬件资源，</li><li>合理地组织计算机系统工作流程，</li><li>控制程序的执行，</li><li>并且向用户提供一个良好的工作环境和友好的接口</li></ul><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><ul><li>管理计算机中运行的程序和分配各种软硬件资源</li><li>为用户提供友善的人机界面</li><li>未应用程序的开发和运行提供一个高效的平台</li></ul><h3 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h3><ul><li>并发性（最基本属性）：宏观上并行，微观上串行。时间上很小。和“并行”区别。<br>  <em>并行是微观的，并发是宏观的</em></li><li>共享性（最基本属性）：文件数据共享，内存、资源等共享</li><li>虚拟性：设备管理技术，Spooling技术，如打印机共享给多个程序使用</li><li>不确定性（异步性）：运行的程序中间步骤不确定</li></ul><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ul><li><strong>进程管理</strong>：对处理器的执行“时间”进行管理，采用多道程序等技术将CPU的时间合理地分配，包括进程控制、进程同步、进程通信和进程调度</li><li><strong>文件管理</strong>：包括文件存储空间管理、目录管理、文件的读写管理和存取控制</li><li><strong>存储管理</strong>：对主存储器“空间”进行管理，主要包括存储分配与回收、存储保护、地址映射和主存扩充</li><li><strong>设备管理</strong>：对硬件设备的管理，包括输入输出设备的分配、启动、完成和回收</li><li><strong>作业管理</strong>：包括任务、界面管理、人机交互、图形界面、语音控制盒虚拟现实</li></ul><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><ul><li><strong>批处理操作系统</strong>：<ul><li>单道批：一次一个作业写入内存，作业由程序、数据、作业说明书组成</li><li>多道批：一次多个作业写入内存，特点：多道、宏观上并行微观上串行</li></ul></li><li><strong>分时操作系统</strong>：<br>  一个计算机系统与多个终端设备连接。将CPU化为多个时间片轮转为多个用户提供服务，特点：多路性、独立性、交互性、及时性</li><li><strong>实时操作系统</strong>：<br>  实时是指计算机对于外来信息能够以足够快的速度进行处理，并在被控对象允许的时间范围内做出快速反应。<br>  实时控制系统和实时信息系统。交互能力不高，可靠性要求高</li><li><strong>网络操作系统</strong>：<br>  使联网计算机能够方面有效地共享网络资源，为网络用户提供各种服务的软件和协议的集合。Unix、Linux和Windows Server<br>  三种模式：<ul><li>集中模式</li><li>客户端&#x2F;服务器模式</li><li>对等模式</li></ul></li><li><strong>分布式操作系统</strong>：<br>  由多个分散的计算机经连接而成的计算机系统，系统中的计算机无主、次之分，任意两台计算机可以通过通信交换信息</li><li><strong>微型计算机操作系统</strong>：<ul><li>Windows：Microsoft 图形界面、多任务、多线程</li><li>Linux：类Unix操作系统，多用户、多任务、多线程和多CPU</li></ul></li><li><strong>嵌入式操作系统</strong>：运行在智能芯片中。特点：<ul><li>微型化：性能成本考虑，希望占用的资源和代码量少，如内存少、字长短、运行速度有限、能源少（微小型电池）</li><li>可定制：成本研发周期考虑，不同微处理器平台上，对硬件变化进行结构和功能上的配置，满足不同的需求</li><li>实时性：过程控制、数据采集、传输通信、多媒体信息及关键要害领域需要迅速响应的场合，对实时性要求较高</li><li>可靠性：系统构件、模块和体系结构必须达到应用的可靠性，关键要害应用还要提供容错和预故障措施</li><li>易移植性（HAL和BSP支持）：采用硬件抽象层和板级支撑包<br>  嵌入式系统初始化过程：自底向上，从硬件到软件依次：片级初始化-&gt;板级初始化-&gt;系统初始化</li></ul></li></ul><h1 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h1><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>进程是程序在一个数据集上运行的过程，它由<strong>系统进行资源分配和调度的一个独立单元</strong>。<br>主要组成部分：</p><ul><li>进程控制块PCB（唯一标志）：包含进程标识符、状态、位置信息、控制信息、队列指针（链接同一状态的进程）、优先级、现场保护区等；</li><li>程序（描述进行要做什么）</li><li>数据（存放进程执行时所需数据）</li></ul><h3 id="三态图"><a href="#三态图" class="headerlink" title="三态图"></a>三态图</h3><ul><li>运行：当一个进程在CPU上运行时。（单处理器处于运行态的进程只有一个，多进程CPU上交替运行）</li><li>就绪：一个进程获得了除CPU外的一切所需资源，一旦得到处理器即可运行</li><li>阻塞：阻塞也成等待或者睡眠状态，一个进程正在等待某一时间的发生（例如请求I&#x2F;O、等待I&#x2F;O完成等）而暂时停止运行，此时即使CPU分配给进程也无法运行<br>【能够记住并背下来】<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E4%B8%89%E6%80%81%E5%9B%BE.png" alt="三态图"></li></ul><h3 id="前趋图"><a href="#前趋图" class="headerlink" title="前趋图"></a>前趋图</h3><p>用来表示哪些任务可以并行执行，哪些任务之间有顺序关系。</p><ul><li>任务间的并行</li><li>任务间的先后顺序<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%89%8D%E8%B6%8B%E5%9B%BE.png" alt="前趋图"></li></ul><h3 id="进程资源图"><a href="#进程资源图" class="headerlink" title="进程资源图"></a>进程资源图</h3><p>表示进程和资源之间的分配和请求关系。<strong>可判断是否死锁</strong>。<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%BF%9B%E7%A8%8B%E8%B5%84%E6%BA%90%E5%9B%BE.png" alt="进程资源图"></p><h3 id="进程同步与互斥"><a href="#进程同步与互斥" class="headerlink" title="进程同步与互斥"></a>进程同步与互斥</h3><p>临界资源：各进程间需要以互斥方式对其进行访问的资源<br>临界区：进程中对临界资源实施操作的那段程序。本职是一段程序代码</p><ul><li><p>互斥：某资源（临界资源）在同一时间内只能由一个任务单独使用，使用时需要加锁，使用后解锁才能被其他任务使用；如打印机</p></li><li><p>同步：多个任务可以并发执行，只不过有速度上的差异，在一定情况下停下等待，不存在资源是否单独或共享的问题；如自行车和汽车；<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5%E4%B8%8E%E4%BA%92%E6%96%A5.png" alt="进程同步与互斥"></p></li><li><p>互斥信号量：对临界资源采用互斥访问，使用互斥信号量后其他进程无法访问，初值为1；</p></li><li><p>同步信号量：对共享资源的访问，初值一般是共享资源的数量。<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5%E4%BA%92%E6%96%A5PV.png" alt="进程同步互斥PV"><br>经典问题：<strong>生产者和消费者问题</strong><br>三个信号量：互斥信号量S0（仓库独立使用权），同步信号量S1（仓库空闲个数）、同步信号量S2（仓库商品个数）</p></li></ul><h3 id="进程调度"><a href="#进程调度" class="headerlink" title="进程调度"></a>进程调度</h3><p>方式：指挡有更高优先级的进程到来时如何分配CPU</p><ul><li>可剥夺：更高来临时，强行将正在运行进程的CPU分配更高的</li><li>不可剥夺：高优先级进程必须等待当前进程自动释放CPU</li></ul><p>一个作业从提交到完成需要经历高、中、低三级调度</p><ul><li>高级调度。长调度、作业调度或接纳调度。决定输入池中哪个后备作业可以调入主系统做好运行的准备，成为一个或一组继续进程。一个作业只需经过一次高级调用</li><li>中级调度。中程调度、兑换调度。处于交换区中哪个就绪进程可以调入内存，以便直接参与CPU竞争。</li><li>低级调度。短程调度、进程调度。处于内存中的哪个就绪进程可以占用CPU。是最活跃、最重要的调度程序，</li></ul><p><strong>调度算法</strong></p><ul><li>先来先服务FCFS：先到达的进程优先分配CPU。用于宏观调度</li><li>时间片轮转：每个进程CPU时间片，轮流使用CPU，进程时间大小相同、很公平，用于微观调度；</li><li>优先级调度：每个进程都甬有一个优先级，优先级大的先分配CPU</li><li>多级反馈调度：<em>时间片轮转</em>和<em>优先级调度</em>结合而成，设置多个就绪队列1.2.3…，每个队列赋予不同的优先级，分配不同的时间片长度；新进程先进入队列1末尾，按FCFS原则，执行队列1的时间片；若未能执行完进程，则转入队列2末尾，如此重复。<br>  <img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%A4%9A%E7%BA%A7%E5%8F%8D%E9%A6%88%E8%B0%83%E5%BA%A6.png" alt="多级反馈调度"></li></ul><h3 id="死锁"><a href="#死锁" class="headerlink" title="死锁"></a>死锁</h3><p>当一个进程在等待永远不可能发生的事件时，就会产生死锁，若系统中有多个进程处于死锁状态，就会造成系统死锁<br><em>四个必要条件</em>：</p><ul><li>资源互斥</li><li>每个进程占有资源并等待其他资源</li><li>系统不能剥夺进程资源</li><li>进程资源图是一个环路</li></ul><p><em>解决措施是打破四大条件</em>：</p><ul><li>死锁预防：采用某种策略限制并发进程对于资源的请求，破坏死锁产生的四个条件之一，使系统任何时刻都不满足死锁的条件。</li><li>死锁避免：一般采用银行家算法，银行家算法，就是提前计算出一条不会死锁的资源分配方法，才分配资源，否则不分配资源，相当于接待，考虑对方还的起才节前，提前考虑好以后，就可以避免死锁。</li><li>死锁检测：允许死锁发生，但系统定时运行一个检测死锁的程序，若检测到系统中发生死锁，则设法加以接触。</li><li>死锁解除：即死锁发生后的接触方法，如强制剥夺资源、撤销进程等。</li><li>死锁资源计算：系统内有N个进程，每个进程都需要R个资源，发生死锁的最大资源数为n*(R-1)。不发生死锁的最小资源数为n*(R-1)+1。</li></ul><h3 id="线程"><a href="#线程" class="headerlink" title="线程"></a>线程</h3><p>传统进程属性：</p><ul><li>可拥有资源的独立单位；</li><li>可独立调度和分配的基本单位。</li></ul><p>引入线程原因：<br>进程在创建、撤销和切换中，系统必须为之付出较大的时空开销。故在系统中设置的（1）<strong>进程数目不宜过多</strong>，（2）<strong>切换频率不宜过高</strong>。<br><br>引入线程后，将传统进程的两个基本属性分开：（从2个属性可看出线程不拥有资源）</p><ul><li>线程作为调度和分配的基本单元</li><li>进程作为独立分配资源单位。</li></ul><p>线程是进程中的一个<strong>实体</strong>，被<em>系统独立分配和调度的基本单元</em>。<br>线程基本上不拥有资源，只拥有一点运行中必不可少的资源（如程序计数器、一组寄存器和栈）</p><ul><li><strong>与可同属一个进程的其他线程共享进程所拥有的全部资源</strong>，例如进程的公共数据、全局变量、代码、文件等资源，</li><li><strong>不能共享线程独有的资源</strong>，如线程的栈指针等标识数据<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%BF%9B%E7%A8%8B%E7%BA%BF%E7%A8%8B%E5%85%B3%E7%B3%BB%E5%9B%BE.png" alt="进程线程关系图"></li></ul><h1 id="存储管理"><a href="#存储管理" class="headerlink" title="存储管理"></a>存储管理</h1><h3 id="分区存储管理"><a href="#分区存储管理" class="headerlink" title="分区存储管理"></a>分区存储管理</h3><p>分区存储组织：整存，将某进程运行所需的内存整体一起分配给它，然后再执行。<br><em>三种分区方式</em>：</p><ul><li>固定分区：静态分区方法，将主存分为若干个固定嗯分区，将要运行的作业装配进去，由于分区固定，大小和作业需要的大小不同，会产生内部碎片；</li><li>可变分区：动态分区方法，主存空间的分区是在作业转入时划分，正好划分为作业需要的大小，这样就不存在内存碎片，但容易将正片主存空间切割成许多块，会产生外部碎片。<ul><li><em>首次适应法</em>：按内存地址顺序从头查找，找到第一个&gt;&#x3D;9k空间的空闲块，即切割9k空间分配给进程；</li><li><em>最佳适应法</em>：将内存中所有空闲内存块按从小到大的排序，找到第一个&gt;&#x3D;9k空间的空闲块，切割分配，这个将会找到与9k空间大小最相近的空闲块；</li><li><em>最差适应法</em>：和最佳适应法想法，将内存中空闲块最大的，切割成9k空间分配给进程，这事为了预防系统中产生过多的细小空闲块。</li><li><em>循环首次适应法</em>：按内存地址顺序查找，找到第一个&gt;&#x3D;9k空间的空闲块，而后若还需分配，则找下一个，<strong>不用每次都从头查找，这与首次适应法不同的地方</strong>。</li></ul></li><li>可重定位分区：可解决碎片问题，移动所有已经分配好的区域，使其成为一个连续的区域，这样其他外部细小的分区碎片可以合并成大的分区，满足作业要求。只有外部作业请求空间得不到满足时进行。</li></ul><h3 id="分页存储管理"><a href="#分页存储管理" class="headerlink" title="分页存储管理"></a>分页存储管理</h3><p>逻辑页</p><ul><li>页号</li><li>页内地址：物理偏移地址</li></ul><p>页号和物理块号并非按序对应的，需要查询页表，才能得知页号对应的物理块号，在用物理块号，加上偏移地址，才能得出真正运行时的物理地址。<br><strong>优点</strong>：利用率高，碎片小，分配及管理简单；<br><strong>缺点</strong>：增加了系统开销，可能产生抖动现象<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%88%86%E9%A1%B5%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86.png" alt="分页存储管理"><br><strong>页面置换算法</strong>：</p><ul><li>最优算法：OPT（Optimal Replacement Algorithm），理论上的算法，无法实现，是在进程执行完后进行的最佳效率计算，用来让其他算法比较差距。<br>  原理：选择未来最长时间内不被访问的页面置换，这样可以保证未来执行的都是马上要访问的</li><li>先进先出算法：FIFO（First Input First Output），先调入内存的页先被置换淘汰，会产生抖动现象，即分配的页数越多，缺页率可能越多（即效率越低）</li><li>最近最少使用：LRU（Least Recently Used），在最近的过去，进程执行过程中，过去最少使用的页面被置换淘汰，根据局部性原理，这种方式效率高，且不会产生抖动现象，使用大量计数器，但没有LFU(Least Frequently Used)多。<ul><li>LFU（最不经常使用页置换算法）是一种根据页面的历史访问频率来决定置换页面的算法</li></ul></li><li>淘汰原则：有限淘汰，最近未访问的，后淘汰最近未被修改的页面。</li></ul><p><strong>快表&amp;慢表</strong><br>快表是一块<strong>小容量的相联存储器</strong>，由快速存储器组成，<em>按内容访问，速度快</em>，并且可以从硬件上保证按内容并行查找，一般用来存放当前访问最频繁的少数活动页面的页号。</p><ul><li>快表：将页面存在Cache中，访问一次Cache和一次内存，更快；</li><li>慢表：将页表存于内存上，需要访问两次内容才能取出页；</li></ul><h3 id="分段存储管理"><a href="#分段存储管理" class="headerlink" title="分段存储管理"></a>分段存储管理</h3><p>将进程空间分为一个个段，<strong>每段也有段号和端内地址</strong>，与页式存储不同的是，<strong>每段物理大小普通，分段是根据逻辑整体分段的</strong>，因此段表和页表的内容不同，页表中直接是逻辑页对应的物理块号，<strong>段表有段长和基址两个属性</strong>，才能确定一个逻辑段在物理段中的位置。<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%88%86%E6%AE%B5%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86.png" alt="分段存储管理"></p><ul><li>优点：多道程序共享内存，各段程序修改互不影响</li><li>缺点：内存利用率低，内存碎片浪费大。</li></ul><h3 id="段页式存储管理"><a href="#段页式存储管理" class="headerlink" title="段页式存储管理"></a>段页式存储管理</h3><p>对进程空间先分段、后分页。</p><ul><li>优点：空间浪费小、存储共享容易、存储保护容易、能动态链接</li><li>缺点：由于管理软件的增加，复杂性和开销随之增加，需要的硬件以及占用的内容也有所增加，使得执行速度大大下降<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%AE%B5%E9%A1%B5%E5%BC%8F%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86.png" alt="段页式存储管理"></li></ul><h1 id="设备管理"><a href="#设备管理" class="headerlink" title="设备管理"></a>设备管理</h1><p>设备是计算机系统与外界交互的工具，具体负责计算机与外部的输入、输出工作，所以常称为外部设备（简称外设）。<br>在计算机系统中，将负责管理设备和输入&#x2F;输出的机构成为I&#x2F;O系统，因此I&#x2F;O系统由<strong>设备、控制器、通道（具体通道的计算机系统）、总线和I&#x2F;O软件</strong>组成</p><h3 id="设备的分类"><a href="#设备的分类" class="headerlink" title="设备的分类"></a>设备的分类</h3><ul><li>按数据组织分类：块设备、字符设备</li><li>按设备功能分类：输入设备、输出设备、存储设备、网络联网设备、供电设备</li><li>资源分配角度分类：独占设备、共享设备和虚拟设备</li><li>数据传输速率分类：低速设备、中速设备、告诉设备</li></ul><p>设备管理任务：<br>在多道程序环境下，当<strong>多个进程竞争使用设备时</strong>，按一定的策略分配和管理各种设备，控制设备的各种操作，完成I&#x2F;O设备与主存之间的数据交换<br>设备管理功能：<br><strong>动态掌握并记录设备的状态</strong>、设备分配和释放、缓存区管理、实现物理I&#x2F;O设备的操作、提供设备使用的用户接口及访问和控制</p><h3 id="I-O软件"><a href="#I-O软件" class="headerlink" title="I&#x2F;O软件"></a>I&#x2F;O软件</h3><p>I&#x2F;O设备管理软件的所有层次及每一层功能如下图<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/IO%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86%E5%B1%82%E6%AC%A1.png" alt="IO设备管理层次"><br>实例：<strong>用户程序</strong>试图访问一个硬盘文件时，需要通过操作系统来实现-&gt;<strong>设备无关软件</strong>检查告诉缓存中有无要读的数据块-&gt;若没有，调用<strong>设备驱动程序</strong>，向I&#x2F;O硬件发送一个请求-&gt;用户进程阻塞并等待磁盘操作完成-&gt;磁盘处理完成，产生一个中断，转入<strong>中断处理程序</strong>-&gt;中断处理程序检查终端原因，认为磁盘读取已完成，唤醒用户进程取回信息，结束此次I&#x2F;O请求。</p><h3 id="设备管理技术"><a href="#设备管理技术" class="headerlink" title="设备管理技术"></a>设备管理技术</h3><p>一个独占设备，同一时间只能由一个进程使用，其他进程只能等待。<br>引入<strong>SPOOLING（外围设备联机操作）技术</strong>：在外设上建立两个数据缓冲区，分别成为<strong>输入井</strong>和<strong>输出井</strong>，无论多少进程，都可以共用一个打印机，只需要将命令发出，数据就会排队在缓冲区，打印机会自动按顺序打印，实现了物理外设的共享，使得每个进程都感觉在使用一个打印机，这就是<strong>物理设备的虚拟化</strong><br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E7%89%A9%E7%90%86%E8%AE%BE%E5%A4%87%E8%99%9A%E6%8B%9F%E5%8C%96.png" alt="物理设备虚拟化"></p><h1 id="文件管理"><a href="#文件管理" class="headerlink" title="文件管理"></a>文件管理</h1><p><strong>文件</strong>：具有符号名的，在逻辑上具有完整意义的一组相关信息的集合。是一种<strong>抽象机制</strong>，隐藏了硬件和实现细节，</p><ul><li>文件体：文件真实的内容</li><li>文件说明：操作系统为了管理文件所用到的信息，包括文件名、文件内部表示、文件类型、存储地址、文件长度、访问权限、建立时间和访问时间等</li></ul><p><strong>文件系统</strong>：实现<em>文件</em>统一管理的一组软件和相关数据的集合，专门管理和存储文件信息的软件机构。<br><em>功能</em> 有：按名存取、统一的用户接口、并发访问和控制、安全性控制、优化性能、差错恢复。</p><p><strong>文件的类型</strong></p><ul><li>性质和用户：系统文件、库文件、用户文件</li><li>保存期限：临时文件、档案文件、永久文件</li><li>保护方式：只读、读&#x2F;写、可执行、不保护</li><li>UNIX：普通文件、目录文件、设备文件（特殊文件）</li></ul><h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h3><ul><li>逻辑结构：<ul><li>有记录的记录式文件：所有的记录通常都描述一个实体集，记录的长度分定长和不定长</li><li>无结构的流式文件：文件体为字节流。通常采用顺序访问方式，读写可以任意长度</li></ul></li><li>物理结构：<em>文件在屋里设备上的存放方法</em><ul><li>连续结构（顺序结构）：<strong>将逻辑上连续的文件信息（如记录）一次存放在连续编号的物理块上</strong></li><li>链接结构（串联结构）：<strong>将逻辑上连续的文件信息（如记录）存放在不连续的物理块上</strong>，每个物理块<strong>设有一个指针指向下一个物理块</strong></li><li>索引结构：将<strong>逻辑上连续大大文件信息（如记录）存放在不连续的物理块上</strong>，系统为每个文件监力一张索引表。<strong>索引表记录了文件信息所在的逻辑块号对应的物理块号</strong>，并将索引表的起始地址放在与文件对应的文件目录中。<br>  <img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E7%B4%A2%E5%BC%95%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84.png" alt="索引文件结构"><br>  如图，系统中存在13个索引结点（0-12）。<br>  0-9为直接索引，即每个索引节点存放得是内容。假设每个物理盘大小为4KB，共可存放4KB * 10&#x3D;40KB数据<br>  10号索引节点为一级简介索引，大小为4KB，存放得<strong>并非直接数据</strong>，而是链接倒直接物理盘块的地址。假设每个地址占4B，共有1024个地址，对应1024个物理盘，可存放1024* 4KB&#x3D;4096KB数据<br>  二级索引节点类似，直接盘存放一级地址，一级地址再存放物理块地址，而后连接到存放数据的物理盘块，容量又扩大了一个数量级，为1024* 1024* 4KB数据</li><li>多个物理块的索引表（链接文件和多重索引方式）：索引表是在文件创建时由系统自动建立的，并于文件一起存放在同一文件卷上。根据一个文件大小的不统，其索引表占用物理块的个数不等，一般占一个或几个物理块</li></ul></li></ul><h3 id="文件目录"><a href="#文件目录" class="headerlink" title="文件目录"></a>文件目录</h3><p>定义：文件控制块的有序稽核成为<strong>文件目录</strong><br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95.png" alt="文件目录"><br>文件控制块包含一下三类信息：</p><ul><li>基本信息类：例如文件名、文件的物理地址、文件长度何文件块数等</li><li>存取控制类：文件的存取权限，像UNIX用户分成文件主、同组用户何一般用户三类，这三类用户的读写执行RWX权限</li><li>使用信息类：文件建立日期、最后一次修改日期、最后一次访问的日期、当前使用的信息（如打开文件的进程数、在文件上的等待队列）等</li></ul><p>路径：</p><ul><li>相对路径：</li><li>绝对路径：</li><li>全文件名：绝对路径+文件名。</li></ul><h3 id="存储空间管理"><a href="#存储空间管理" class="headerlink" title="存储空间管理"></a>存储空间管理</h3><p>读取方式是指读&#x2F;写文件存储器上的一个物理块的方法。</p><ul><li>顺序存取：依次进行读写</li><li>随机存取：按任意的次序随机地读写</li></ul><p><strong>空间管理</strong><br>数据结构通常称为磁盘分配表；<em>（外存往往指硬盘）</em><br>管理方法：</p><ul><li>空闲区表。 连续未分配区域称为空闲区。<br>      操作系统为磁盘外存上的所有空闲区建立一张空闲表，每个表项对应一个空闲区。<br>      <img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E7%A9%BA%E9%97%B2%E5%8C%BA%E8%A1%A8.png" alt="空闲区表"></li><li><strong>位示图</strong>。 外存上建立一张位示图（Bitmap），记录文件存储器使用情况。<br>   每一位对应文件存储器上的一个物理块，用0和1表示空闲和占用。<br>   <img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E4%BD%8D%E7%A4%BA%E5%9B%BE.png" alt="位示图"></li><li>空闲块链。每个空闲物理块指向下一个空闲物理块的指针，构成一个链表。</li><li>成组链接法。  UNIX采用该方法。<br>       实现时系统将空闲块分成若干组，每100个空闲块未一组，每组第1个空闲块等级了下一组的物理块号和空闲块总数。</li></ul><p><strong>文件保护</strong><br>对文件的保护长采用<strong>存取控制</strong>的方式</p><ul><li>存取控制矩阵</li><li>存取控制表（Linux使用，列出一个文件的所有权限用户）</li><li>用户权限表（列出一个用户能够访问的所有文件）</li><li>密码</li></ul><h3 id="文件共享"><a href="#文件共享" class="headerlink" title="文件共享"></a>文件共享</h3><ul><li>硬链接： 两个文件目录表目指向同一个索引结点的链接，也称基于索引结点的链接。<br>   硬连接是指不同文件名与同一个文件实体的链接。<strong>不利于删除</strong></li><li>符号链接：建立新的文件或目录，并与原来文件或目录的路径名进行映射。</li></ul><h1 id="作业管理"><a href="#作业管理" class="headerlink" title="作业管理"></a>作业管理</h1>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>架构-计算机基础-其他</title>
      <link href="/2025/07/19/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E5%85%B6%E4%BB%96/"/>
      <url>/2025/07/19/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E5%85%B6%E4%BB%96/</url>
      
        <content type="html"><![CDATA[<h1 id="嵌入式系统及软件"><a href="#嵌入式系统及软件" class="headerlink" title="嵌入式系统及软件"></a>嵌入式系统及软件</h1><p>见后续</p><h1 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h1><p>见后续</p><h1 id="计算机语言、多媒体、系统工程"><a href="#计算机语言、多媒体、系统工程" class="headerlink" title="计算机语言、多媒体、系统工程"></a>计算机语言、多媒体、系统工程</h1><p>见后续</p><h1 id="系统性能"><a href="#系统性能" class="headerlink" title="系统性能"></a>系统性能</h1><p>见后续</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>架构-计算机基础-软件</title>
      <link href="/2025/07/18/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%BD%AF%E4%BB%B6/"/>
      <url>/2025/07/18/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%BD%AF%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F.png" alt="系统图"></p><ul><li>系统软件：为整个计算机系统配置的不依赖特定应用领域的通用软件，对硬件和软件资源进行控制和管理，为用户使用和其他软件运行提供服务</li><li>应用软件：为某类应用需要或解决特定问题涉及的软件。如图形图像处理、财务软件、游戏软件和各种软件包等；</li></ul><h1 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h1><a href="/2025/07/20/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%BD%AF%E4%BB%B6-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="架构-计算机基础-软件-操作系统">架构-计算机基础-软件-操作系统</a><h1 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h1><p>见后续</p><h1 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h1><a href="/2025/07/20/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E8%BD%AF%E4%BB%B6-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="架构-计算机基础-软件-操作系统">架构-计算机基础-软件-操作系统</a><h1 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>中间件：应用软件与操作系统之间使用的标准化编程接口和协议，承上启下作用，使应用软件的开发相对独立于计算机硬件和操作系统，能在不同的系统上运行。</p><ul><li>通信处理（消息）中间件</li><li>事务处理（交易）中间件</li><li>数据存取管理中间件：为网络上虚拟缓存存取、格式转换、解压等带来方便</li><li>Web服务器中间件</li><li>安全中间件</li><li>跨平台和架构中间件</li><li>专用平台中间件</li><li>网络中间件：包括网管、接入、网络测试、虚拟社区和虚拟缓存等；</li></ul><h2 id="构件"><a href="#构件" class="headerlink" title="构件"></a>构件</h2><p>构件又称为组件，自包容、可复用的程序集。构件是一个程序集或者一组程序的集合。这个集合向外提供统一的访问接口，外部只能通过接口访问，不能直接访问内部。<br>搭积木式开发，即<strong>构建组装模型</strong>：<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%9E%84%E4%BB%B6%E7%BB%84%E8%A3%85%E6%A8%A1%E5%9E%8B.png" alt="存储"><br><strong>构件标准规范</strong></p><ul><li>对象管理组织（OMG）的CORBA<ul><li>对象请求代理（ORB）（最底层）：规定了分布对象的定义（接口）和语言映射，实现对象间的通信和互操作，是分布对象系统中的“软总线”</li><li>公共对象服务（第二层）：提供并发服务、名字服务、事物（交易）服务等</li><li>公共设施（最上层）：定义了构件框架，提供可直接未业务对象使用的服务，规定业务对象有效协作所需的协议规定<br>  CCM构件模型，OMG制定，用于<em>开发和配置</em>分布式应用的服务端构建模型规范</li><li>抽象构件模型：描述服务器端构件结构及构件间互操作的结构</li><li>构件容器结构：通用的构件运行和管理环境</li><li>构件的配置和打包规范：打包技术管理构件的二进制、多语言版本的可执行代码和配置信息，并制定了构建包的具体内容和文档内容标准。</li></ul></li><li>Sun的J2EE：同时支持<strong>远程方法调用RMI</strong>和<strong>互联网内部对象请求代理协议IIOP</strong></li><li>Microsoft DNA（Windows 分布式集成网络应用体系结构）：DCOM&#x2F;COM&#x2F;COM+在DNA 2000分步计算结构基础上，展现了一个全新的分布构件应用模型。<ul><li>COM：未本地的对象链接与嵌入应用服务；</li><li>DCOM&#x2F;COM&#x2F;COM+：扩充未面向服务器端分布应用的业务逻辑中间件</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>架构-计算机基础-硬件</title>
      <link href="/2025/07/17/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E7%A1%AC%E4%BB%B6/"/>
      <url>/2025/07/17/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E7%A1%AC%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F.png" alt="系统图"><br><strong>冯诺依曼结构</strong>，整体结构可如图</p><ul><li>运算器</li><li>控制器</li><li>存储器</li><li>输入设备</li><li>输出设备<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%86%AF%E8%AF%BA%E4%BE%9D%E6%9B%BC.png" alt="冯诺依曼"></li></ul><h1 id="处理器"><a href="#处理器" class="headerlink" title="处理器"></a>处理器</h1><p><strong>运算器</strong>和<strong>控制器</strong>是处理器的核心部件<br>指令集：复杂指令集CISC、精简指令集RISC<br>常见处理芯片：<strong>图形处理器GPU</strong>，<strong>信号处理器DSP</strong>，<strong>可编程逻辑门阵列FPGA</strong>等<br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%8C%87%E4%BB%A4%E9%9B%86.png" alt="指令集"></p><h1 id="存储"><a href="#存储" class="headerlink" title="存储"></a>存储</h1><p><strong>存储器</strong>：用于存储数据的电子设备。<br><strong>按硬件接口分分：</strong></p><ul><li>SRAM</li><li>DRAM</li><li>NVRAM</li><li>Flash</li><li>EPROM</li><li>Disk</li></ul><p><strong>按与处理器的物理距离分：</strong></p><ul><li>片上缓存：在处理器核心<strong>中</strong>，一般为SRAM，快速读取，容量小，16kB-512kB，可分一级或二级</li><li>片外缓存：在处理器核心<strong>外</strong>，需要交换互联开关，一般SRAM，256kB-4MB，称为L2Cache或L3Cache，平台Cache</li><li>主存（内存）：DRAM，独立部件&#x2F;芯片，通过<strong>总线</strong>与处理器连接。需要持续供电，数百MB-数十GB</li><li>外存：磁带、磁盘、Flash等，速度慢、容量大、掉电仍保存数据</li></ul><p><em>SRAM、DRAM掉电数据丢失。SRAM读取10-20ns，直接通过晶体管状态，面积大，成本高；DRAM读取50ns，通过充放电</em><br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E5%AD%98%E5%82%A8.png" alt="存储"></p><p><strong>时间局限性</strong>：指程序中某条指令一旦执行，不久以后该指令可能再次执行，典型原因是由于程序中存在大量的<em>循环操作</em><br><strong>空间局限性</strong>：指一旦程序访问了某个存储单元，不久之后，其附近的存储单元也将被访问，即程序在一段时间内所访问的地址可能集中在一定范围内，其典型情况是程序<em>顺序执行</em></p><h1 id="总线"><a href="#总线" class="headerlink" title="总线"></a>总线</h1><p><strong>总线</strong>：计算机内部间遵循某一特定协议实现数据交互的形式。总线之间通过【<strong>桥</strong>】实现连接，它是一种特殊的外设，主要实现<strong>总线协议间的转换</strong></p><ul><li>内总线：用于芯片内部互联，又称<strong>片上总线</strong>、<strong>片内总线</strong></li><li>系统总线：包括 数据总线、地址总线和控制总线<ul><li>狭义上：CPU、主存、IO接口的总线</li><li>广义上：经由系统总线再次级联的总线，常称为<strong>局部总线</strong></li></ul></li><li>外部总线：计算机板和外部设备，计算机系统之间互联的总线，又称<strong>通信总线</strong></li></ul><p><strong>性能指标</strong></p><ul><li>总线带宽</li><li>总线服务质量QoS</li><li>总线时延</li><li>总线抖动</li></ul><p><strong>类型</strong></p><ul><li>并行总线：PCI、PCIe和ATA（IDE）</li><li>串行总线：USB、SATA、CAN、RS-232、RS-485、RapidIO和以太网</li></ul><p><strong>接口</strong><br>接口是同一计算机不同功能层之间的通信规则</p><ul><li>显示类接口：HDMI、DVI、VGA</li><li>音频输入输出类接口：TRS、RCA、XLR</li><li>网络类接口：RJ45、FC</li><li>PS&#x2F;2接口</li><li>USB接口</li><li>SATA接口</li><li>LPT打印接口</li><li>RS-232接口</li></ul><p><strong>对于总线而言，一种总线可能存在多种接口</strong><br><img src="/images/%E6%9E%B6%E6%9E%84-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%95%88%E7%8E%87%E9%AB%98%E4%BD%8E.png" alt="系统图"></p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>架构-软考之路</title>
      <link href="/2025/07/16/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%BD%AF%E8%80%83%E4%B9%8B%E8%B7%AF/"/>
      <url>/2025/07/16/%E6%9E%B6%E6%9E%84/%E6%9E%B6%E6%9E%84-%E8%BD%AF%E8%80%83%E4%B9%8B%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<h2 id="软考日记"><a href="#软考日记" class="headerlink" title="软考日记"></a>软考日记</h2><p><strong>7.16</strong> 开始复习，计划今天看一遍408，网上找到了一个经验分享<br><a href="https://blog.csdn.net/pushiqiang/article/details/144618179">https://blog.csdn.net/pushiqiang/article/details/144618179</a><br>7.20 学习计算机基础+操作系统</p><p><strong>8.31前完成录播课程，完成选择题，完成课后习题，达到正确率，刷题</strong><br><strong>10.15突破案例+论文，<br>案例视频、真题，陌生架构图，常规软件工程<br>论文一周一片，至少5篇</strong><br><strong>11.7 考试串讲，冲刺</strong><br>7.20-导读课</p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 软考 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>古诗</title>
      <link href="/2025/07/09/%E5%8F%A4%E8%AF%97/"/>
      <url>/2025/07/09/%E5%8F%A4%E8%AF%97/</url>
      
        <content type="html"><![CDATA[<h2 id="春晓"><a href="#春晓" class="headerlink" title="春晓"></a>春晓</h2><p><strong>唐 孟浩然</strong><br>春眠不觉晓，处处闻啼鸟。<br>夜来风雨声，花落知多少。  </p><h2 id="江雪"><a href="#江雪" class="headerlink" title="江雪"></a>江雪</h2><p><strong>唐 柳宗元</strong><br>千山鸟飞绝，万径人踪灭。<br>孤舟蓑笠翁，独钓寒江雪。  </p><h2 id="清明"><a href="#清明" class="headerlink" title="清明"></a>清明</h2><p><strong>唐 杜牧</strong><br>清明时节雨纷纷，路上行人欲断魂<br>借问酒家何处有，牧童遥指杏花村  </p><h2 id="草"><a href="#草" class="headerlink" title="草"></a>草</h2><p><strong>唐 白居易</strong><br>离离原上草，一岁一枯荣。<br>野火烧不尽，春风吹又生。  </p><h2 id="登鹳雀楼"><a href="#登鹳雀楼" class="headerlink" title="登鹳雀楼"></a>登鹳雀楼</h2><p><strong>唐 王之涣</strong><br>白日依山尽，黄河入海流。<br>欲穷千里目，更上一层楼。  </p><h2 id="咏鹅"><a href="#咏鹅" class="headerlink" title="咏鹅"></a>咏鹅</h2><p><strong>唐 骆宾王</strong><br>鹅鹅鹅，曲项向天歌。<br>白毛浮绿水，红掌拨清波。  </p><h2 id="悯农"><a href="#悯农" class="headerlink" title="悯农"></a>悯农</h2><p><strong>唐 李绅</strong><br>锄禾日当午，汗滴禾下土。<br>谁知盘中餐，粒粒皆辛苦。  </p><h2 id="题临安邸"><a href="#题临安邸" class="headerlink" title="题临安邸"></a>题临安邸</h2><p><strong>宋 林升</strong><br>山外青山楼外楼，西湖歌舞几时休？<br>暖风熏得游人醉，直把杭州作汴州。  </p><h2 id="静夜思"><a href="#静夜思" class="headerlink" title="静夜思"></a>静夜思</h2><p><strong>唐 李白</strong><br>床前明月光，疑是地上霜。<br>举头望明月，低头思故乡。  </p><h2 id="梅花"><a href="#梅花" class="headerlink" title="梅花"></a>梅花</h2><p><strong>宋代 王安石</strong><br>墙角数枝梅，凌寒独自开。<br>遥知不是雪，为有暗香来。  </p><h2 id="游子吟"><a href="#游子吟" class="headerlink" title="游子吟"></a>游子吟</h2><p><strong>唐 孟郊</strong><br>慈母手中线，游子身上衣。<br>临行密密缝，意恐迟迟归。<br>谁言寸草心，报得三春晖。  </p><h2 id="望庐山瀑布"><a href="#望庐山瀑布" class="headerlink" title="望庐山瀑布"></a>望庐山瀑布</h2><p><strong>唐 李白</strong><br>日照香炉生紫烟，遥看瀑布挂前川。<br>飞流直下三千尺，疑是银河落九天。  </p><h2 id="早发白帝城"><a href="#早发白帝城" class="headerlink" title="早发白帝城"></a>早发白帝城</h2><p><strong>唐 李白</strong><br>朝辞白帝彩云间，千里江陵一日还。<br>两岸猿声啼不住，轻舟已过万重山。  </p><h2 id="红豆"><a href="#红豆" class="headerlink" title="红豆"></a>红豆</h2><p><strong>唐 王维</strong><br>红豆生南国，春来发几枝。<br>愿君多采撷，此物最相思。  </p><h2 id="秋浦歌"><a href="#秋浦歌" class="headerlink" title="秋浦歌"></a>秋浦歌</h2><p><strong>唐 李白</strong><br>白发三千丈，缘愁似个长。<br>不知明镜里，何处得秋霜。  </p><h2 id="夜宿山寺"><a href="#夜宿山寺" class="headerlink" title="夜宿山寺"></a>夜宿山寺</h2><p><strong>唐 李白</strong><br>危楼高百尺，手可摘星辰。<br>不敢高声语，恐惊天上人。  </p><h2 id="登鹳雀楼-1"><a href="#登鹳雀楼-1" class="headerlink" title="登鹳雀楼"></a>登鹳雀楼</h2><p><strong>唐 王之焕</strong><br>白日依山尽，黄河入海流。<br>欲穷千里目，更上一层楼。  </p><h2 id="赠汪伦"><a href="#赠汪伦" class="headerlink" title="赠汪伦"></a>赠汪伦</h2><p><strong>唐 李白</strong><br>李白乘舟将欲行，忽闻岸上踏歌声。<br>桃花潭水深千尺，不及汪伦送我情。  </p><h2 id="山村咏怀"><a href="#山村咏怀" class="headerlink" title="山村咏怀"></a>山村咏怀</h2><p><strong>宋 邵雍</strong><br>一去二三里，烟村四五家。<br>亭台六七座，八九十枝花。  </p><h2 id="出塞"><a href="#出塞" class="headerlink" title="出塞"></a>出塞</h2><p><strong>唐 王昌龄</strong><br>秦时明月汉时关，万里长征人未还。<br>但使龙城飞将在，不教胡马度阴山。<br>姑苏城外寒山寺，夜半钟声到客船。  </p>]]></content>
      
      
      <categories>
          
          <category> 学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 语文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>群晖安装Tailscale</title>
      <link href="/2025/07/09/%E6%8A%80%E6%9C%AF%E6%9D%82%E7%B3%85/%E7%BE%A4%E6%99%96%E5%AE%89%E8%A3%85Tailscale/"/>
      <url>/2025/07/09/%E6%8A%80%E6%9C%AF%E6%9D%82%E7%B3%85/%E7%BE%A4%E6%99%96%E5%AE%89%E8%A3%85Tailscale/</url>
      
        <content type="html"><![CDATA[<p>NAS存储不够了，因此对其进行了扩容，好多插件都要重新安装，记录下Tailscale安装过程，其他插件直接修复就安装完毕了</p><h2 id="安装包下载"><a href="#安装包下载" class="headerlink" title="安装包下载"></a>安装包下载</h2><p>Tailscale按照说明套件中心应该存在，但是实际没找到，网上找到了下载地址，下载架构对应的版本即可。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">https://pkgs.tailscale.com/stable/#spks<br></code></pre></td></tr></table></figure><h2 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h2><p>进入群晖套件中心–&gt;所有套件 右上角部分有个手动安装，安装后即可</p><h2 id="登录Tailscale"><a href="#登录Tailscale" class="headerlink" title="登录Tailscale"></a>登录Tailscale</h2><p>安装过程没任何问题，但是点击安装后图标，进行登录时报Failed Login，Google了报错原因，参考此文档解决，总结下来主要登录SSH，手动up</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">https://tailscale.com/kb/1131/synology<br></code></pre></td></tr></table></figure><p>详细步骤如下：<br>1.SSH登录Nas，涵盖开启端口、放通防火墙，putty连接等<br>2.执行以下命令，需要输入密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo tailscale up<br></code></pre></td></tr></table></figure><p>3.将输出地址在浏览器输入，按提示登录即可</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">To authenticate, visit:<br>https://login.tailscale.com/a/xxxxxxxxxx<br>Success.<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 群晖 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github Pages搭建Hexo博客</title>
      <link href="/2025/07/04/%E6%8A%80%E6%9C%AF%E6%9D%82%E7%B3%85/Github%20Pages%E6%90%AD%E5%BB%BAHexo%E5%8D%9A%E5%AE%A2/"/>
      <url>/2025/07/04/%E6%8A%80%E6%9C%AF%E6%9D%82%E7%B3%85/Github%20Pages%E6%90%AD%E5%BB%BAHexo%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>GitHub Actions 是 GitHub 推出的持续集成服务，入门教程可参考:GitHub Actions 入门教程。</p><h2 id="新建两个仓库"><a href="#新建两个仓库" class="headerlink" title="新建两个仓库"></a>新建两个仓库</h2><p>_www : 私有仓库，存储源代码内容，生成文件<br>xxx.github.io ： 公开仓库，主要存在编译后的public内容</p><h2 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h2><p>1.获取 GH_TOKEN<br>首先到个人中心设置Setting-&gt;Developer Settings-&gt; Personal access tokens-&gt;tokens (classic)，新建一个token即可。<br>token 能让 GitHub Actions 构建所在的虚拟系统对发布仓库拥有权限可以进行推送操作。</p><p>2.设置 Actions Secrets<br>新建 _www 仓库，将本地目录的 hexo 源码推送到_www 仓库里，然后进到 _www 仓库的 Setting-&gt;secrets and variables -&gt;Actions 在Repository secrets里新建一个名为[ACCESS_TOKEN]的键值项，内容填上一步获取到的 token 值。</p><p>3.Actions 设置<br>在博客源码根目录下新建目录 .github&#x2F;workflows ,然后在其下新建任务文件 deploy.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">name:</span> <span class="hljs-string">Publish</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">to</span> <span class="hljs-string">gitpage</span><br><span class="hljs-attr">on:</span><br><span class="hljs-attr">push:</span><br>  <span class="hljs-attr">branches:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">main</span>  <span class="hljs-comment"># 如果源码与gitpage用同一仓库则修改为hexo源码对应分支</span><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">build:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br>    <span class="hljs-attr">steps:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">ref:</span> <span class="hljs-string">main</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br><span class="hljs-string">        npm install -g hexo-cli # 给虚拟机装上hexo运行环境</span><br><span class="hljs-string">        npm install             # 安装 package.json 中记录的所有插件</span><br><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Generate</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">site</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br><span class="hljs-string">        hexo clean</span><br><span class="hljs-string">        hexo generate</span><br><span class="hljs-string"></span>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">B</span> <span class="hljs-string">repo</span><br>      <span class="hljs-attr">uses:</span> <span class="hljs-string">peaceiris/actions-gh-pages@v3</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">personal_token:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.ACCESS_TOKEN</span> <span class="hljs-string">&#125;&#125;</span> <span class="hljs-comment"># Personal access token</span><br>        <span class="hljs-attr">external_repository:</span> <span class="hljs-string">xxxx/xxxx.github.io</span>  <span class="hljs-comment"># 发布的仓库地址</span><br>        <span class="hljs-attr">PUBLISH_BRANCH:</span> <span class="hljs-string">main</span><br>        <span class="hljs-attr">PUBLISH_DIR:</span> <span class="hljs-string">./public</span><br></code></pre></td></tr></table></figure><p>4.至此所有的就完成了</p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（五）</title>
      <link href="/2024/12/17/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%BA%94%EF%BC%89/"/>
      <url>/2024/12/17/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%BA%94%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>在上次框架改版、引入pinpa的基础上，这次引入了AI下棋功能，这功能主要来自：<a href="https://github.com/lihongxun945/gobang">https://github.com/lihongxun945/gobang</a>   AI功能部分未进行任何变动，直接改了几个接口，直接引入即可。</p><p>本次设计代码较多，仍原来几个代码</p><p>本次主要重点引入的代码</p><p>minmax.worker.js，主要改自开源的代码，由react进行了微调，其中AI部分，直接从开源处将AI文件夹复制过来即可</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Board</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ai/board&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123;minmax&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ai/minmax&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123;<span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/stores/status&#x27;</span>;<br><br><span class="hljs-comment">// @ts-ignore</span><br><span class="hljs-comment">// onmessage = function (event) &#123;</span><br><span class="hljs-comment">//   const &#123; action, payload &#125; = event.data;</span><br><span class="hljs-comment">//   console.log(event.data)</span><br><span class="hljs-comment">//   let res = null;</span><br><span class="hljs-comment">//   switch (action) &#123;</span><br><span class="hljs-comment">//     case &#x27;start&#x27;:</span><br><span class="hljs-comment">//       res = start(payload.board_size, payload.aiFirst, payload.depth);</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//     case &#x27;move&#x27;:</span><br><span class="hljs-comment">//       res = move(payload.position, payload.depth);</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//     case &#x27;undo&#x27;:</span><br><span class="hljs-comment">//       res = undo();</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//     case &#x27;end&#x27;:</span><br><span class="hljs-comment">//       res = end();</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//     default:</span><br><span class="hljs-comment">//       break;</span><br><span class="hljs-comment">//   &#125;</span><br><span class="hljs-comment">//   postMessage(&#123;</span><br><span class="hljs-comment">//     action,</span><br><span class="hljs-comment">//     payload: res,</span><br><span class="hljs-comment">//   &#125;);</span><br><span class="hljs-comment">// &#125;;</span><br><br><span class="hljs-keyword">let</span> board = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Board</span>(<span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span>);<br><span class="hljs-keyword">let</span> score = <span class="hljs-number">0</span>, bestPath = [], currentDepth = <span class="hljs-number">0</span>;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getBoardData</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>        <span class="hljs-attr">board</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(board.<span class="hljs-property">board</span>)),<br>        <span class="hljs-attr">winner</span>: board.<span class="hljs-title function_">getWinner</span>(),<br>        <span class="hljs-attr">current_player</span>: board.<span class="hljs-property">role</span>,<br>        <span class="hljs-attr">history</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(board.<span class="hljs-property">history</span>)),<br>        <span class="hljs-attr">size</span>: board.<span class="hljs-property">size</span>,<br>        score,<br>        bestPath,<br>        currentDepth,<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">start</span> = (<span class="hljs-params">board_size, aiFirst = <span class="hljs-literal">true</span>, depth = <span class="hljs-number">4</span></span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;start&#x27;</span>, board_size, aiFirst, depth);<br>    board = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Board</span>(board_size);<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">if</span> (aiFirst) &#123;<br>            <span class="hljs-keyword">const</span> res = <span class="hljs-title function_">minmax</span>(board, board.<span class="hljs-property">role</span>, depth);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=====res=====&quot;</span> + res)<br>            <span class="hljs-keyword">let</span> move;<br>            [score, move, bestPath, currentDepth] = res;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=========================&quot;</span>)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(score)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(move)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(bestPath)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(currentDepth)<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=========================&quot;</span>)<br>            board.<span class="hljs-title function_">put</span>(move[<span class="hljs-number">0</span>], move[<span class="hljs-number">1</span>]);<br>            <span class="hljs-keyword">return</span> [move[<span class="hljs-number">0</span>], move[<span class="hljs-number">1</span>], board.<span class="hljs-property">role</span>]<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);<br>    &#125;<br>    <span class="hljs-comment">// return getBoardData();</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span><br>&#125;;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">move</span> = (<span class="hljs-params">position, depth</span>) =&gt; &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;=====move====&quot;</span> + position)<br>    <span class="hljs-keyword">try</span> &#123;<br>        board.<span class="hljs-title function_">put</span>(position[<span class="hljs-number">0</span>], position[<span class="hljs-number">1</span>]);<br>    &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!board.<span class="hljs-title function_">isGameOver</span>()) &#123;<br>        <span class="hljs-keyword">const</span> res = <span class="hljs-title function_">minmax</span>(board, board.<span class="hljs-property">role</span>, depth);<br>        <span class="hljs-keyword">let</span> move;<br>        [score, move, bestPath, currentDepth] = res;<br>        board.<span class="hljs-title function_">put</span>(move[<span class="hljs-number">0</span>], move[<span class="hljs-number">1</span>]);<br>        <span class="hljs-keyword">return</span> [move[<span class="hljs-number">0</span>], move[<span class="hljs-number">1</span>], board.<span class="hljs-property">role</span>]<br>    &#125;<br>    <span class="hljs-comment">// return getBoardData();</span><br>&#125;;<br><span class="hljs-comment">//</span><br><span class="hljs-comment">// export const end = () =&gt; &#123;</span><br><span class="hljs-comment">//   console.log(&quot;=====end====&quot;)</span><br><span class="hljs-comment">//   // do nothing</span><br><span class="hljs-comment">//   return getBoardData();</span><br><span class="hljs-comment">// &#125;;</span><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// export const undo = () =&gt; &#123;</span><br><span class="hljs-comment">//   console.log(&quot;=====undo====&quot;)</span><br><span class="hljs-comment">//   board.undo();</span><br><span class="hljs-comment">//   board.undo();</span><br><span class="hljs-comment">//   return getBoardData();</span><br><span class="hljs-comment">// &#125;</span><br></code></pre></td></tr></table></figure><p>status.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//默认宽度</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span> = <span class="hljs-number">375</span><br><span class="hljs-comment">//默认线条数</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span> = <span class="hljs-number">15</span><br><span class="hljs-comment">//默认间隙</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span> = <span class="hljs-number">25</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">GameStatus</span> = &#123;<br>    <span class="hljs-comment">//就绪状态</span><br>    <span class="hljs-attr">IDLE</span>: <span class="hljs-string">&quot;idle&quot;</span>,<br>    <span class="hljs-comment">// 游戏中</span><br>    <span class="hljs-attr">GAMING</span>: <span class="hljs-string">&#x27;gaming&#x27;</span>,<br>    <span class="hljs-comment">// 已获胜</span><br>    <span class="hljs-attr">WINNING</span>: <span class="hljs-string">&#x27;winning&#x27;</span>,<br>    <span class="hljs-comment">// 重新开始</span><br>    <span class="hljs-attr">RESTART</span>: <span class="hljs-string">&#x27;restart&#x27;</span>,<br>&#125;<br><span class="hljs-comment">//黑棋子</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PLAYER_BLACK</span> = -<span class="hljs-number">1</span><br><span class="hljs-comment">//白棋子</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PLAYER_WHITE</span> = <span class="hljs-number">1</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">PlayerStatus</span> = &#123;<br>    <span class="hljs-comment">// 黑棋</span><br>    <span class="hljs-attr">BLACK</span>: <span class="hljs-variable constant_">PLAYER_BLACK</span>,<br>    <span class="hljs-comment">// 白棋</span><br>    <span class="hljs-attr">WHITE</span>: <span class="hljs-variable constant_">PLAYER_WHITE</span>,<br>&#125;<br></code></pre></td></tr></table></figure><p>chess.js  状态管理代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;defineStore, acceptHMRUpdate&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123;<br>    <span class="hljs-title class_">PlayerStatus</span>,<br>    <span class="hljs-title class_">GameStatus</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span><br>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useChessStore = <span class="hljs-title function_">defineStore</span>(&#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;chess&#x27;</span>,<br>    <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123;<br>        <span class="hljs-attr">status</span>: <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">IDLE</span>,<br>        <span class="hljs-attr">boardDetail</span>: &#123;<br>            <span class="hljs-attr">width</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span>,<span class="hljs-comment">//棋盘大小</span><br>            <span class="hljs-attr">size</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_SIZE</span>,<span class="hljs-comment">//棋盘线数</span><br>            <span class="hljs-attr">space</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span>,<span class="hljs-comment">//间隙</span><br>        &#125;,<br>        <span class="hljs-attr">current_player</span>: <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>,<span class="hljs-comment">//默认黑子（-1）</span><br>        <span class="hljs-attr">board</span>: [],<span class="hljs-comment">//棋盘内容--Board包含</span><br>        <span class="hljs-attr">history</span>: [],<span class="hljs-comment">//--Board包含</span><br>        <span class="hljs-attr">size</span>: <span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-comment">//--Board包含</span><br>        <span class="hljs-attr">aiFirst</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//AI先行</span><br>        <span class="hljs-attr">depth</span>: <span class="hljs-number">4</span>, <span class="hljs-comment">// 搜索深度</span><br>        <span class="hljs-attr">currentDepth</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">path</span>: [],<br>        <span class="hljs-attr">winner</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">score</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">bestPath</span>: <span class="hljs-string">&#x27;&#x27;</span><br>    &#125;),<br>    <span class="hljs-attr">actions</span>: &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 初始化选手（黑）</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">initPayer</span>(<span class="hljs-params"></span>)&#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span> =<span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:初始化选手（黑）==初始化选手（黑）==,新:&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 转换选手</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">reversePlayer</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span> *= -<span class="hljs-number">1</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:reversePlayer==交换选手==,新:&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变选手</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changePlayer</span>(<span class="hljs-params">s</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (s) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span> = <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">current_player</span> = <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-attr">default</span>:<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changePlayer==改变选手==,新:&quot;</span> + s)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变游戏状态</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-params">s</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (s) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">IDLE</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">IDLE</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-attr">default</span>:<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeGameStatus==改变游戏状态==&quot;</span> + s)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变棋盘大小</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">w</span></span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">n</span></span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params">w, n, s</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span> = &#123;<br>                <span class="hljs-attr">width</span>: w,<span class="hljs-comment">//棋盘大小</span><br>                <span class="hljs-attr">size</span>: n,<span class="hljs-comment">//棋盘线数</span><br>                <span class="hljs-attr">space</span>: s,<span class="hljs-comment">//间隙</span><br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeBoardDetail==改变棋盘大小==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 初始化棋盘内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">initBoard</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> size = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = <span class="hljs-title class_">Array</span>(size).<span class="hljs-title function_">fill</span>().<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Array</span>(size).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:initBoard==初始化棋盘内容==\n&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br><br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 修改棋盘内容</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">board</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeBoard</span>(<span class="hljs-params">board</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = board<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeBoard==修改棋盘内容==\n&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 清空棋盘内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">clearBoard</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> size = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = <span class="hljs-title class_">Array</span>(size).<span class="hljs-title function_">fill</span>().<span class="hljs-title function_">map</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Array</span>(size).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>));<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:clearBoard==清空棋盘内容==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 清空历史内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">clearHistory</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">history</span> = []<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:clearBoard==清空历史内容==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">history</span>)<br>        &#125;<br>    &#125;<br><br>&#125;)<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>) &#123;<br>    <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>.<span class="hljs-title function_">accept</span>(<span class="hljs-title function_">acceptHMRUpdate</span>(useChessStore, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>GoBang.vue  此部分代码和上次无太大差异</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MainBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./MainBoard.vue&#x27;</span></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">OperateBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./OperateBoard.vue&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">components</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title class_">MainBoard</span>, <span class="hljs-title class_">OperateBoard</span></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;五子棋&quot;</span>;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;root-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">MainBoard</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">OperateBoard</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.root-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>MainBoard  ci此部分整体框架和上次类似，功能描述上有调整</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;</span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;</span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;move, start&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/components/gobang/minmax.worker.js&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">//加载store，便于全局使用</span></span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            chessStore,</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">//监视状态变化，以便监听【重置】状态</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.$subscribe(<span class="hljs-function">(<span class="hljs-params">mutation, state</span>) =&gt;</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(mutation)</span></span><br><span class="language-javascript">            <span class="hljs-comment">//TODO 生产环境有问题，去掉了mutation.events.key === &quot;status&quot;</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (state.<span class="hljs-property">status</span> === <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//检测到状态位RESTART，需要重置游戏</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restartGame</span>()</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-comment">// 实例创建完成，仅在首次加载时完成</span></span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span></span><br><span class="language-javascript">        <span class="hljs-comment">//TODO 清空基础数据，后续测试必要性</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initGame</span>()</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">            boardDetail.<span class="hljs-property">size</span>,</span><br><span class="language-javascript">            boardDetail.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">    ,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 初始化游戏参数</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">initGame</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//清空基础数据并初始化</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">initPayer</span>()</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">initBoard</span>()</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">clearHistory</span>()</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">IDLE</span>)</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 点击落子</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">e</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleDropChess</span>(<span class="hljs-params">e</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//存在输赢以后或未开始前，不允许在落子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">status</span> !== <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> space = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> size = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 计算棋子落在哪个方格中,并绘制棋子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((e.<span class="hljs-property">offsetX</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((e.<span class="hljs-property">offsetY</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawChess</span>(cellX, cellY)</span><br><span class="language-javascript">            <span class="hljs-comment">//判断输赢</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> winner = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span>, size)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (winner !== <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//代表此次操作有胜负，更新结果</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>)</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(winner)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">//交换选手</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">reversePlayer</span>()</span><br><span class="language-javascript">            <span class="hljs-comment">//交由AI下棋</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleAIDrop</span>()</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * AI下棋</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleAIDrop</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//接下来交给AI出来，前面均由人为点击产生</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> history = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">history</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> h = history[history.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>]</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(&quot;x=&quot; + h.x + &#x27; y=&#x27; + h.y)</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> res = <span class="hljs-title function_">move</span>([h.<span class="hljs-property">x</span>, h.<span class="hljs-property">y</span>], <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">depth</span>)</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawChess</span>(res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>])</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(this.chessStore.board)</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==================AI下子结束=============&quot;</span>)</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">//判断输赢</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> size = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> winner = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span>, size)</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(winner)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (winner !== <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//代表此次操作有胜负，更新结果</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>)</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(winner)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">reversePlayer</span>()</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 画整体棋盘</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> width 所需棋盘整体大小，上下左右预留一半space空间</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> size 线条数，线条数*间距=width</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> space 间距</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params">width, size, space</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">// 设置线条颜色</span></span><br><span class="language-javascript">            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; size; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制横线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(width - halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制竖线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(i * space + halfSpace, halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(i * space + halfSpace, width - halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        ,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 绘制棋子</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">x</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">y</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">drawChess</span>(<span class="hljs-params">x, y</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> detail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> board = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> current_player = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">current_player</span></span><br><span class="language-javascript">            <span class="hljs-comment">//存在输赢以后，不允许在落子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">status</span> !== <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> lineNumber = detail.<span class="hljs-property">size</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> space = detail.<span class="hljs-property">space</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(event.offsetX + &#x27;   &#x27; + event.offsetY + &#x27;  &#x27; + space)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 判断该位置是否有棋子</span></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(board)</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (board[x][y] !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span></span><br><span class="language-javascript">            <span class="hljs-comment">//考虑起点为2，因半径为space一半，避免太大，截止1/3大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(</span><br><span class="language-javascript">                x * space + halfSpace,</span><br><span class="language-javascript">                y * space + halfSpace,</span><br><span class="language-javascript">                <span class="hljs-number">2</span>,</span><br><span class="language-javascript">                x * space + halfSpace,</span><br><span class="language-javascript">                y * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span></span><br><span class="language-javascript">            )</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>,</span><br><span class="language-javascript">                current_player === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>,</span><br><span class="language-javascript">                current_player === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">            ctx.<span class="hljs-property">fillStyle</span> = grd</span><br><span class="language-javascript">            <span class="hljs-comment">//画圆，半径设置为space/3，同上r1参数一致</span></span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">arc</span>(</span><br><span class="language-javascript">                x * space + halfSpace,</span><br><span class="language-javascript">                y * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span>,</span><br><span class="language-javascript">                <span class="hljs-number">0</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,</span><br><span class="language-javascript">                <span class="hljs-literal">false</span></span><br><span class="language-javascript">            );</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">closePath</span>();</span><br><span class="language-javascript">            board[x][y] = current_player; <span class="hljs-comment">//将黑白棋信息存储</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span>)</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">history</span>.<span class="hljs-title function_">push</span>(&#123;x, y, current_player&#125;)</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        ,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 胜负检查</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> board X*X 二维数组</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@returns</span> &#123;<span class="hljs-type">UnwrapRef&lt;string&gt;|null</span>&#125;</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board, lineNumber</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> current_player = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">current_player</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查横向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === current_player) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> current_player;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查纵向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === current_player) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> current_player;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查右斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber - <span class="hljs-number">5</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === current_player) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> current_player;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查左斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === current_player) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> current_player;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 重置游戏</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">restartGame</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//清空基础数据</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initGame</span>()</span><br><span class="language-javascript">            <span class="hljs-comment">//清空画布</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制，会初始化棋子信息</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">                boardDetail.<span class="hljs-property">size</span>,</span><br><span class="language-javascript">                boardDetail.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//开始处理游戏状态</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>)</span><br><span class="language-javascript">            <span class="hljs-comment">//根据情况自动下棋</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==================重新开始=============&quot;</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> res = <span class="hljs-title function_">start</span>(boardDetail.<span class="hljs-property">size</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">aiFirst</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">depth</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (res !=<span class="hljs-literal">null</span>)&#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//代表AI先行，存在旗子，则进行绘制</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawChess</span>(res[<span class="hljs-number">0</span>], res[<span class="hljs-number">1</span>])</span><br><span class="language-javascript">                <span class="hljs-comment">//交换选手</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">reversePlayer</span>()</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// 无需交换棋子，直接黑子开始</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript"></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript">;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-chess&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;375&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;375&quot;</span></span><br><span class="hljs-tag">                @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleDropChess($event)&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.main-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-chess</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>OperateBoard.vue 和上次类似</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;</span><br><span class="language-javascript"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            chessStore,</span><br><span class="language-javascript">            <span class="hljs-title class_">PlayerStatus</span>,</span><br><span class="language-javascript">            <span class="hljs-title class_">GameStatus</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 改变棋盘大小</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> square = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> newWidth = square</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> newHeight = square</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> newLineNumber = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">size</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> newSpace = newWidth / newLineNumber</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(newWidth + &#x27;  &#x27; + newLineNumber + &#x27;  &#x27; + newSpace)</span></span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置board大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)</span><br><span class="language-javascript">            canvas.<span class="hljs-property">width</span> = newWidth</span><br><span class="language-javascript">            canvas.<span class="hljs-property">height</span> = newHeight</span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置棋盘大小</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeBoardDetail</span>(newWidth, newLineNumber, newSpace)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制游戏</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRestart</span>()</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 重新开始</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleRestart</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>)</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;detail&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>长宽：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.width&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>线条数：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.size&quot;</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>间距：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeBoardDetail()&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>AI先手<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">checkbox</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.aiFirst&quot;</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleRestart&quot;</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;chessStore.status===GameStatus.IDLE&quot;</span>&gt;</span>开始<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-else</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>当前落子：&#123;&#123; chessStore.current_player === PlayerStatus.WHITE ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>胜利方：&#123;&#123;<br>                        chessStore.status === GameStatus.WINNING ?<br>                            (chessStore.current_player === PlayerStatus.WHITE ? &quot;白棋&quot; : &quot;黑棋&quot;) : &quot;&quot;<br>                    &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">text-align</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> <span class="hljs-selector-tag">span</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> <span class="hljs-selector-tag">input</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">40px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.operate</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">text-align</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.operate</span> <span class="hljs-selector-tag">div</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">text-align</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.operate</span> <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">button</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.operate</span> <span class="hljs-selector-tag">span</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">5px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（四）</title>
      <link href="/2024/12/05/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
      <url>/2024/12/05/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E5%9B%9B%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>在上次拆分组件的前提下，现在引入了pinia状态管理</p><p>在此过程中，发现了一个问题，后改用了其他方式，比较简单粗暴。</p><p>生产环境报：Missing types in subscribe’s mutation.events</p><p>具体主要依托store来实现，也规范了几个状态变量</p><p>chess.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123;defineStore, acceptHMRUpdate&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123;<br>    <span class="hljs-title class_">PlayerStatus</span>,<br>    <span class="hljs-title class_">GameStatus</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_LINE_NUMBER</span>,<br>    <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span><br>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useChessStore = <span class="hljs-title function_">defineStore</span>(&#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;chess&#x27;</span>,<br>    <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> (&#123;<br>        <span class="hljs-attr">player</span>: <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>,<br>        <span class="hljs-attr">status</span>: <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>,<br>        <span class="hljs-attr">boardDetail</span>: &#123;<br>            <span class="hljs-attr">width</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span>,<span class="hljs-comment">//棋盘大小</span><br>            <span class="hljs-attr">lineNumber</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_LINE_NUMBER</span>,<span class="hljs-comment">//棋盘线数</span><br>            <span class="hljs-attr">space</span>: <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span>,<span class="hljs-comment">//间隙</span><br>        &#125;,<br>        <span class="hljs-attr">board</span>: []<br>    &#125;),<br>    <span class="hljs-attr">actions</span>: &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 交换选手</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">reversePlayer</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span> ?<br>                <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> : <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span><br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:reversePlayer==交换选手==,新:&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变当前棋手</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changePlayer</span>(<span class="hljs-params">s</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (s) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span>;<br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-attr">default</span>:<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changePlayer==改变选手==,新:&quot;</span> + s)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变游戏状态</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-params">s</span>) &#123;<br>            <span class="hljs-keyword">switch</span> (s) &#123;<br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">case</span> <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>:<br>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span> = <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>;<br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-attr">default</span>:<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeGameStatus==改变游戏状态==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">status</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变棋盘大小</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">w</span></span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">n</span></span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">s</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params">w, n, s</span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span> = &#123;<br>                <span class="hljs-attr">width</span>: w,<span class="hljs-comment">//棋盘大小</span><br>                <span class="hljs-attr">lineNumber</span>: n,<span class="hljs-comment">//棋盘线数</span><br>                <span class="hljs-attr">space</span>: s,<span class="hljs-comment">//间隙</span><br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:changeBoardDetail==改变棋盘大小==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>)<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 初始化棋盘内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">initBoard</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = []<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>; i++) &#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))<br>            &#125;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:initBoard==初始化棋盘内容==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br><br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 清空棋盘内容</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">clearBoard</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = []<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;==action:clearBoard==清空棋盘内容==&quot;</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br>        &#125;<br>    &#125;<br><br>&#125;)<br><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>) &#123;<br>    <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>.<span class="hljs-title function_">accept</span>(<span class="hljs-title function_">acceptHMRUpdate</span>(useChessStore, <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>status.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_WIDTH</span> = <span class="hljs-number">600</span><span class="hljs-comment">//默认宽度</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_LINE_NUMBER</span> = <span class="hljs-number">15</span><span class="hljs-comment">//默认线条数</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DEFAULT_BOARD_SPACE</span> = <span class="hljs-number">40</span> <span class="hljs-comment">//默认间隙</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">GameStatus</span> = &#123;<br>    <span class="hljs-attr">GAMING</span>: <span class="hljs-string">&#x27;gaming&#x27;</span>, <span class="hljs-comment">// 游戏中</span><br>    <span class="hljs-attr">WINNING</span>: <span class="hljs-string">&#x27;winning&#x27;</span>, <span class="hljs-comment">// 已获胜</span><br>    <span class="hljs-attr">RESTART</span>: <span class="hljs-string">&#x27;restart&#x27;</span>, <span class="hljs-comment">// 已获胜</span><br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">PlayerStatus</span> = &#123;<br>    <span class="hljs-attr">BLACK</span>: <span class="hljs-string">&#x27;BLACK&#x27;</span>, <span class="hljs-comment">// 黑棋</span><br>    <span class="hljs-attr">WHITE</span>: <span class="hljs-string">&#x27;WHITE&#x27;</span>, <span class="hljs-comment">// 白棋</span><br>&#125;<br></code></pre></td></tr></table></figure><p>完整代码如下：</p><p>GoBang.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MainBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./MainBoard.vue&#x27;</span></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">OperateBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./OperateBoard.vue&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;&#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">components</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title class_">MainBoard</span>, <span class="hljs-title class_">OperateBoard</span></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;五子棋&quot;</span>;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;root-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">MainBoard</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">OperateBoard</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.root-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>MainBoard.vue</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;<br><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;<br><span class="hljs-keyword">import</span> &#123;storeToRefs&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123;watch&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: &#123;&#125;,<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;&#125;;<br>    &#125;,<br>    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()<br>        <span class="hljs-keyword">return</span> &#123;<br>            chessStore,<br>        &#125;<br>    &#125;,<br>    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br><br>        <span class="hljs-comment">//监视状态变化，以便监听重置等情况</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.$subscribe(<span class="hljs-function">(<span class="hljs-params">mutation, state</span>) =&gt;</span> &#123;<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(mutation)<span class="hljs-comment">// 传递给 cartStore.$patch() 的补丁对象。</span><br>            <span class="hljs-comment">//TODO 生产环境有问题，去掉了mutation.events.key === &quot;status&quot;</span><br>            <span class="hljs-keyword">if</span> (state.<span class="hljs-property">status</span> === <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>) &#123;<br>                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restartGame</span>()<br>            &#125;<br>        &#125;)<br>    &#125;,<br><br>    <span class="hljs-comment">// 实例创建完成，仅在首次加载时完成</span><br>    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">let</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,<br>            boardDetail.<span class="hljs-property">lineNumber</span>,<br>            boardDetail.<span class="hljs-property">space</span>);<br>    &#125;<br>    ,<br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 画整体棋盘</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> width 所需棋盘整体大小，上下左右预留一半space空间</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> lineNumber 线条数，线条数*间距=width</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> space 间距</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params">width, lineNumber, space</span>) &#123;<br>            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;<br><br>            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br>            <span class="hljs-comment">// 设置线条颜色</span><br>            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;<br><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;<br>                <span class="hljs-comment">// 绘制横线</span><br>                ctx.<span class="hljs-title function_">beginPath</span>();<br>                ctx.<span class="hljs-title function_">moveTo</span>(halfSpace, i * space + halfSpace);<br>                ctx.<span class="hljs-title function_">lineTo</span>(width - halfSpace, i * space + halfSpace);<br>                ctx.<span class="hljs-title function_">stroke</span>();<br>                <span class="hljs-comment">// 绘制竖线</span><br>                ctx.<span class="hljs-title function_">beginPath</span>();<br>                ctx.<span class="hljs-title function_">moveTo</span>(i * space + halfSpace, halfSpace);<br>                ctx.<span class="hljs-title function_">lineTo</span>(i * space + halfSpace, width - halfSpace);<br>                ctx.<span class="hljs-title function_">stroke</span>();<br>            &#125;<br>            <span class="hljs-comment">//填充数组，重置为0</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">initBoard</span>()<br>        &#125;<br>        ,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 监听每步棋子，需要传入棋盘信息</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">event</span></span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event</span>) &#123;<br>            <span class="hljs-keyword">const</span> detail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span><br>            <span class="hljs-keyword">const</span> board = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">board</span><br>            <span class="hljs-keyword">const</span> player = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">player</span><br>            <span class="hljs-comment">//存在输赢以后，不允许在落子</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">status</span> !== <span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>) &#123;<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">const</span> lineNumber = detail.<span class="hljs-property">lineNumber</span><br>            <span class="hljs-keyword">const</span> space = detail.<span class="hljs-property">space</span><br>            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;<br><br>            <span class="hljs-comment">// 计算棋子落在哪个方格中</span><br>            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / space);<br>            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / space);<br>            <span class="hljs-comment">// console.log(event.offsetX + &#x27;   &#x27; + event.offsetY + &#x27;  &#x27; + space)</span><br>            <span class="hljs-comment">// 判断该位置是否有棋子</span><br>            <span class="hljs-comment">// console.log(board)</span><br>            <span class="hljs-keyword">if</span> (board[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br>            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span><br>            <span class="hljs-comment">//考虑起点为2，因半径为space一半，避免太大，截止1/3大小</span><br>            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<br>                cellX * space + halfSpace,<br>                cellY * space + halfSpace,<br>                <span class="hljs-number">2</span>,<br>                cellX * space + halfSpace,<br>                cellY * space + halfSpace,<br>                space / <span class="hljs-number">3</span><br>            )<br>            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>,<br>                player === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)<br>            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>,<br>                player === <span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">WHITE</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)<br>            ctx.<span class="hljs-title function_">beginPath</span>()<br>            ctx.<span class="hljs-property">fillStyle</span> = grd<br>            <span class="hljs-comment">//画圆，半径设置为space/3，同上r1参数一致</span><br>            ctx.<span class="hljs-title function_">arc</span>(<br>                cellX * space + halfSpace,<br>                cellY * space + halfSpace,<br>                space / <span class="hljs-number">3</span>,<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,<br>                <span class="hljs-literal">false</span><br>            );<br>            ctx.<span class="hljs-title function_">fill</span>();<br>            ctx.<span class="hljs-title function_">closePath</span>();<br>            board[cellX][cellY] = player; <span class="hljs-comment">//将黑白棋信息存储</span><br><br>            <span class="hljs-keyword">const</span> winner_current = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(board, lineNumber) <span class="hljs-comment">//判断输赢</span><br>            <span class="hljs-keyword">if</span> (winner_current !== <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-comment">//代表此次操作有胜负，更新结果</span><br>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">WINNING</span>)<br>                <span class="hljs-title function_">alert</span>(winner_current)<br>                <span class="hljs-keyword">return</span>;<br>            &#125;<br>            <span class="hljs-comment">//通知父组件，修改了选手内容值</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">reversePlayer</span>()<span class="hljs-comment">//交换</span><br>        &#125;<br>        ,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 胜负检查</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> board X*X 二维数组</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@param</span> lineNumber 线条数</span><br><span class="hljs-comment">         * <span class="hljs-doctag">@returns</span> &#123;<span class="hljs-type">UnwrapRef&lt;string&gt;|null</span>&#125;</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board, lineNumber</span>) &#123;<br>            <span class="hljs-keyword">const</span> player = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">player</span><br>            <span class="hljs-comment">// 检查横向是否有五子连线</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;<br>                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;<br>                    <span class="hljs-keyword">if</span> (board[i][j] === player) &#123;<br>                        count++;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        count = <span class="hljs-number">0</span>;<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> player;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment">// 检查纵向是否有五子连线</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;<br>                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;<br>                    <span class="hljs-keyword">if</span> (board[i][j] === player) &#123;<br>                        count++;<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        count = <span class="hljs-number">0</span>;<br>                    &#125;<br><br>                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> player;<br><br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment">// 检查右斜线是否有五子连线</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber - <span class="hljs-number">5</span>; j++) &#123;<br>                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;<br>                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === player) &#123;<br>                            count++;<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            count = <span class="hljs-number">0</span>;<br>                        &#125;<br><br>                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> player;<br><br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment">// 检查左斜线是否有五子连线</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; lineNumber; j++) &#123;<br>                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;<br>                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === player) &#123;<br>                            count++;<br>                        &#125; <span class="hljs-keyword">else</span> &#123;<br>                            count = <span class="hljs-number">0</span>;<br>                        &#125;<br><br>                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> player;<br>                    &#125;<br>                &#125;<br>            &#125;<br><br>            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 重置游戏</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">restartGame</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span><br>            <span class="hljs-comment">//清空基础数据</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changePlayer</span>(<span class="hljs-title class_">PlayerStatus</span>.<span class="hljs-property">BLACK</span>)<br>            <span class="hljs-comment">//清空画布</span><br>            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br>            ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)<br>            <span class="hljs-comment">//重新绘制，会初始化棋子信息</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,<br>                boardDetail.<span class="hljs-property">lineNumber</span>,<br>                boardDetail.<span class="hljs-property">space</span>);<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">GAMING</span>)<br>        &#125;<br>        ,<br>    &#125;<br>&#125;<br>;<br>&lt;/script&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-board&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-chess&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleClickAndDraw($event)&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.main-board</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">display</span>: flex;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">align-items</span>: center;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">justify-content</span>: center;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.board-chess</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>OperateBoard.vue</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;<br><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>    <span class="hljs-attr">props</span>: &#123;&#125;,<br>    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> &#123;&#125;;<br>    &#125;,<br>    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()<br>        <span class="hljs-keyword">return</span> &#123;<br>            chessStore,<br>            <span class="hljs-title class_">PlayerStatus</span>,<br>            <span class="hljs-title class_">GameStatus</span><br>        &#125;<br>    &#125;,<br><br>    <span class="hljs-attr">methods</span>: &#123;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 改变棋盘大小</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-keyword">const</span> square = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span><br>            <span class="hljs-keyword">const</span> newWidth = square<br>            <span class="hljs-keyword">const</span> newHeight = square<br>            <span class="hljs-keyword">const</span> newLineNumber = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span><br>            <span class="hljs-keyword">const</span> newSpace = newWidth / newLineNumber<br>            <span class="hljs-comment">// console.log(newWidth + &#x27;  &#x27; + newLineNumber + &#x27;  &#x27; + newSpace)</span><br>            <span class="hljs-comment">//重新设置board大小</span><br>            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)<br>            canvas.<span class="hljs-property">width</span> = newWidth<br>            canvas.<span class="hljs-property">height</span> = newHeight<br>            <span class="hljs-comment">//重新设置棋盘大小</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeBoardDetail</span>(newWidth, newLineNumber, newSpace)<br>            <span class="hljs-comment">//重新绘制游戏</span><br>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRestart</span>()<br>        &#125;,<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * 重新开始</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-title function_">handleRestart</span>(<span class="hljs-params"></span>) &#123;<br>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>)<br>        &#125;<br>    &#125;<br>&#125;;<br>&lt;/script&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate-board&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;detail&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>长宽：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.width&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>线条数：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.lineNumber&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>间距：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeBoardDetail()&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleRestart&quot;</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>当前落子：&#123;&#123; chessStore.player === PlayerStatus.WHITE ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>胜利方：&#123;&#123;</span><br><span class="language-xml">                    chessStore.status === GameStatus.WINNING ?</span><br><span class="language-xml">                        (chessStore.player === PlayerStatus.WHITE ? &quot;白棋&quot; : &quot;黑棋&quot;) : &quot;&quot;</span><br><span class="language-xml">                &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">text-align</span>: center;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &gt; <span class="hljs-selector-tag">span</span> <span class="hljs-selector-tag">input</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> <span class="hljs-selector-tag">span</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123;useChessStore&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/chess.js&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">GameStatus</span>, <span class="hljs-title class_">PlayerStatus</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/stores/status.js&quot;</span>;</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">props</span>: &#123;&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> &#123;&#125;;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">const</span> chessStore = <span class="hljs-title function_">useChessStore</span>()</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            chessStore,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title class_">PlayerStatus</span>,</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-title class_">GameStatus</span></span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;,</span></span><br><span class="language-javascript"><span class="language-xml"></span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-attr">methods</span>: &#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/**</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         * 改变棋盘大小</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> square = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> newWidth = square</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> newHeight = square</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> newLineNumber = <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">const</span> newSpace = newWidth / newLineNumber</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">// console.log(newWidth + &#x27;  &#x27; + newLineNumber + &#x27;  &#x27; + newSpace)</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//重新设置board大小</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)</span></span><br><span class="language-javascript"><span class="language-xml">            canvas.<span class="hljs-property">width</span> = newWidth</span></span><br><span class="language-javascript"><span class="language-xml">            canvas.<span class="hljs-property">height</span> = newHeight</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//重新设置棋盘大小</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeBoardDetail</span>(newWidth, newLineNumber, newSpace)</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//重新绘制游戏</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRestart</span>()</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;,</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-comment">/**</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         * 重新开始</span></span></span><br><span class="hljs-comment"><span class="language-javascript"><span class="language-xml">         */</span></span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-title function_">handleRestart</span>(<span class="hljs-params"></span>) &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">chessStore</span>.<span class="hljs-title function_">changeGameStatus</span>(<span class="hljs-title class_">GameStatus</span>.<span class="hljs-property">RESTART</span>)</span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate-board&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;detail&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>长宽：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.width&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>线条数：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.lineNumber&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>间距：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;chessStore.boardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeBoardDetail()&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleRestart&quot;</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>当前落子：&#123;&#123; chessStore.player === PlayerStatus.WHITE ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>胜利方：&#123;&#123;</span><br><span class="language-xml">                    chessStore.status === GameStatus.WINNING ?</span><br><span class="language-xml">                        (chessStore.player === PlayerStatus.WHITE ? &quot;白棋&quot; : &quot;黑棋&quot;) : &quot;&quot;</span><br><span class="language-xml">                &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">text-align</span>: center;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> &gt; <span class="hljs-selector-tag">span</span> <span class="hljs-selector-tag">input</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.operate-board</span> <span class="hljs-selector-class">.detail</span> <span class="hljs-selector-tag">span</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">5px</span> <span class="hljs-number">0</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（三）</title>
      <link href="/2024/11/29/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%B8%89%EF%BC%89/"/>
      <url>/2024/11/29/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%B8%89%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>利用下午的时间，对这个程序进行了优化，主要拆解成组件形式，大致分为2个部分。1个部分为棋盘主要内容；1个部分为棋盘控制部分。在此过程中不断的了解了：</p><p>1、父组件传递子组件值</p><p>2、子组件修改父组件值</p><p>3、监听某个值的变化，如重新开始restart</p><p>4、也对新旧VUE产生了一定的想法，后续在琢磨怎么实现的了，想引入状态管理</p><p>【GoBang.vue】：主要布局组件，该组件主要引入上面所说的两个组件，并提取部分公共变量至此</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">MainBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./MainBoard.vue&#x27;</span></span><br><span class="language-javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">OperateBoard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./OperateBoard.vue&#x27;</span></span><br><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">player</span>: <span class="hljs-number">1</span>,<span class="hljs-comment">//1--白棋；2--黑棋</span></span><br><span class="language-javascript">            <span class="hljs-attr">winner</span>: <span class="hljs-number">0</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">restart</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">boardDetail</span>: &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: <span class="hljs-number">600</span>,<span class="hljs-comment">//棋盘大小</span></span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: <span class="hljs-number">20</span>,<span class="hljs-comment">//棋盘线数</span></span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: <span class="hljs-number">30</span>,<span class="hljs-comment">//间隙</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">components</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title class_">MainBoard</span>, <span class="hljs-title class_">OperateBoard</span></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;五子棋&quot;</span>;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">watch</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">restart</span>(<span class="hljs-params">nV, oV</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (nV) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-number">1</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-number">0</span></span><br><span class="language-javascript">                <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">                    <span class="hljs-comment">//设置一个1秒延时，用于子组件捕获数据变化</span></span><br><span class="language-javascript">                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">restart</span> = <span class="hljs-literal">false</span></span><br><span class="language-javascript">                &#125;, <span class="hljs-number">1000</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;root-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">MainBoard</span> <span class="hljs-attr">:boardDetail</span>=<span class="hljs-string">&quot;boardDetail&quot;</span></span><br><span class="hljs-tag">                   <span class="hljs-attr">v-model:player</span>=<span class="hljs-string">&quot;player&quot;</span></span><br><span class="hljs-tag">                   <span class="hljs-attr">v-model:winner</span>=<span class="hljs-string">&quot;winner&quot;</span></span><br><span class="hljs-tag">                   <span class="hljs-attr">v-model:restart</span>=<span class="hljs-string">&quot;restart&quot;</span>/&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">OperateBoard</span> <span class="hljs-attr">v-model:boardDetail</span>=<span class="hljs-string">&quot;boardDetail&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">:player</span>=<span class="hljs-string">&quot;player&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">:winner</span>=<span class="hljs-string">&quot;winner&quot;</span></span><br><span class="hljs-tag">                     <span class="hljs-attr">v-model:restart</span>=<span class="hljs-string">&quot;restart&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.root-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">align-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>【MainBoard.vue】主要用于下棋的部分，逻辑和之前一样，数据传输形式变了，感觉变复杂了</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">props</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">boardDetail</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: [],</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">player</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-number">1</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">winner</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">restart</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Boolean</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">board</span>: [],</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">watch</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">restart</span>(<span class="hljs-params">nV, oV</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//监听restart重绘命令，以便重新绘制</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (nV) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restartGame</span>()</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-comment">// 实例创建完成，仅在首次加载时完成</span></span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">let</span> boardDetail = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(boardDetail.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">            boardDetail.<span class="hljs-property">lineNumber</span>,</span><br><span class="language-javascript">            boardDetail.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 画整体棋盘</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> width 所需棋盘整体大小，上下左右预留一半space空间</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数，线条数*间距=width</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> space 间距</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params">width, lineNumber, space</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">// 设置线条颜色</span></span><br><span class="language-javascript">            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制横线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(width - halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制竖线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(i * space + halfSpace, halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(i * space + halfSpace, width - halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">//填充数组，重置为0</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(lineNumber).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 监听每步棋子，需要传入棋盘信息</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">event</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> detail 棋盘信息</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event, detail</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//存在输赢以后，不允许在落子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> lineNumber = detail.<span class="hljs-property">lineNumber</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> space = detail.<span class="hljs-property">space</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// let x = event.offsetX;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// let y = event.offsetY;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(x + &#x27;   &#x27; + y)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 计算棋子落在哪个方格中</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(cellX, cellY)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 判断该位置是否有棋子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span></span><br><span class="language-javascript">            <span class="hljs-comment">//考虑起点为2，因半径为space一半，避免太大，截止1/3大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                <span class="hljs-number">2</span>,</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span></span><br><span class="language-javascript">            )</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">            ctx.<span class="hljs-property">fillStyle</span> = grd</span><br><span class="language-javascript">            <span class="hljs-comment">//画圆，半径设置为space/3，同上r1参数一致</span></span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">arc</span>(</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span>,</span><br><span class="language-javascript">                <span class="hljs-number">0</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,</span><br><span class="language-javascript">                <span class="hljs-literal">false</span></span><br><span class="language-javascript">            );</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">closePath</span>();</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>; <span class="hljs-comment">//将黑白棋信息存储</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> winner_current = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>, lineNumber) <span class="hljs-comment">//判断输赢</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (winner_current !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">//代表此次操作有胜负，更新结果</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;update:winner&quot;</span>, winner_current)</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(winner_current)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">//通知父组件，修改了选手内容值</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;update:player&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span>)<span class="hljs-comment">//交换</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 胜负检查</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> board X*X 二维数组</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@returns</span> <span class="hljs-variable">number</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board, lineNumber</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 检查横向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查纵向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查右斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber - <span class="hljs-number">5</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查左斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 重置游戏</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">restartGame</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//清空基础数据</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = []</span><br><span class="language-javascript">            <span class="hljs-comment">//清空画布</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>,</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;main-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-chess&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span></span><br><span class="hljs-tag">                @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleClickAndDraw($event,this.boardDetail)&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.main-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-chess</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>【OperateBoard.vue】主要用于控制棋盘，如重新开始，重新绘制等，主要是通过对父组件的变量修改实现</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">props</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-attr">boardDetail</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Object</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: [],</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">player</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-number">1</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">winner</span>: &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">default</span>: <span class="hljs-number">0</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">inputBoardDetail</span>: &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: <span class="hljs-number">600</span>,<span class="hljs-comment">//棋盘大小</span></span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: <span class="hljs-number">20</span>,<span class="hljs-comment">//棋盘线数</span></span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: <span class="hljs-number">30</span>,<span class="hljs-comment">//间隙</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">width</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">lineNumber</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span></span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">space</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">changeBoardDetail</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> square = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">width</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> lineNumber = <span class="hljs-variable language_">this</span>.<span class="hljs-property">inputBoardDetail</span>.<span class="hljs-property">lineNumber</span></span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置board大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)</span><br><span class="language-javascript">            canvas.<span class="hljs-property">width</span> = square</span><br><span class="language-javascript">            canvas.<span class="hljs-property">height</span> = square</span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置棋盘大小</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;update:boardDetail&quot;</span>, &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: square,</span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: lineNumber,</span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: square / lineNumber</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制游戏</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleRestart</span>()</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">handleRestart</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&quot;update:restart&quot;</span>, <span class="hljs-literal">true</span>)<span class="hljs-comment">//交换</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;operate-board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘信息：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘长宽：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.inputBoardDetail.width&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘线条数：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.inputBoardDetail.lineNumber&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘间距：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.inputBoardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;changeBoardDetail()&quot;</span>&gt;</span>修改<br>            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleRestart&quot;</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>当前落子：&#123;&#123; this.player === 1 ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>胜利方：&#123;&#123; this.winner === 1 ? &quot;白棋&quot; : this.winner === 2 ? &quot;黑棋&quot; : &quot;&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.operate-board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-detail</span> &gt; <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">input</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（二）</title>
      <link href="/2024/11/29/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
      <url>/2024/11/29/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>在昨天的基础上，对五子棋进行了调整</p><p>1、增加了背景颜色</p><p>2、增加了修改棋盘大小功能</p><p>3、增加了重新开始功能</p><p>仍未进行代码优化，同时对vue的data内的数据修改、读取，未发现好的方式，既可以直接读取带来的方便，但感觉也会带来随意修改数据产生的意外，会影响健壮性。</p><p>完整代码Game.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">board</span>: [],</span><br><span class="language-javascript">            <span class="hljs-attr">player</span>: <span class="hljs-number">1</span>,<span class="hljs-comment">//1--白棋；2--黑棋</span></span><br><span class="language-javascript">            <span class="hljs-attr">winner</span>: <span class="hljs-literal">null</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">restart</span>: <span class="hljs-literal">false</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">boardDetail</span>: &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">//棋盘大小</span></span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">//棋盘线数</span></span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">//间隙</span></span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-comment">// 实例刚创建，但未挂载dom</span></span><br><span class="language-javascript">    <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;五子棋&quot;</span>;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-comment">// 实例创建完成，仅在首次加载时完成</span></span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span> = &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">width</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>).<span class="hljs-property">clientWidth</span>,</span><br><span class="language-javascript">            <span class="hljs-attr">lineNumber</span>: <span class="hljs-number">20</span>,<span class="hljs-comment">//棋盘线数</span></span><br><span class="language-javascript">            <span class="hljs-attr">space</span>: <span class="hljs-number">30</span>,<span class="hljs-comment">//间隙</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>,</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 画整体棋盘</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> width 所需棋盘整体大小，上下左右预留一半space空间</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数，线条数*间距=width</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> space 间距</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params">width, lineNumber, space</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">// 设置线条颜色</span></span><br><span class="language-javascript">            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制横线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(width - halfSpace, i * space + halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">// 绘制竖线</span></span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(i * space + halfSpace, halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(i * space + halfSpace, width - halfSpace);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">                <span class="hljs-comment">//填充数组，重置为0</span></span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(lineNumber).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 监听每步棋子，需要传入棋盘信息</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> <span class="hljs-variable">event</span></span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> detail 棋盘信息</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event, detail</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//存在输赢以后，不允许在落子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> != <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> lineNumber = detail.<span class="hljs-property">lineNumber</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> space = detail.<span class="hljs-property">space</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> halfSpace = space / <span class="hljs-number">2</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// let x = event.offsetX;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// let y = event.offsetY;</span></span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(x + &#x27;   &#x27; + y)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 计算棋子落在哪个方格中</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / space);</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(cellX, cellY)</span></span><br><span class="language-javascript">            <span class="hljs-comment">// 判断该位置是否有棋子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span></span><br><span class="language-javascript">            <span class="hljs-comment">//考虑起点为2，因半径为space一半，避免太大，截止1/3大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                <span class="hljs-number">2</span>,</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span></span><br><span class="language-javascript">            )</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">            ctx.<span class="hljs-property">fillStyle</span> = grd</span><br><span class="language-javascript">            <span class="hljs-comment">//画圆，半径设置为space/3，同上r1参数一致</span></span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">arc</span>(</span><br><span class="language-javascript">                cellX * space + halfSpace,</span><br><span class="language-javascript">                cellY * space + halfSpace,</span><br><span class="language-javascript">                space / <span class="hljs-number">3</span>,</span><br><span class="language-javascript">                <span class="hljs-number">0</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,</span><br><span class="language-javascript">                <span class="hljs-literal">false</span></span><br><span class="language-javascript">            );</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">closePath</span>();</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>; <span class="hljs-comment">//将黑白棋信息存储</span></span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>, lineNumber) <span class="hljs-comment">//判断输赢</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> != <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span><span class="hljs-comment">//交换</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 胜负检查</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> board X*X 二维数组</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@param</span> lineNumber 线条数</span></span><br><span class="hljs-comment"><span class="language-javascript">         * <span class="hljs-doctag">@returns</span> &#123;<span class="hljs-type">number|null</span>&#125;</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board, lineNumber</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 检查横向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查纵向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber; i++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查右斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; lineNumber - <span class="hljs-number">5</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查左斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lineNumber - <span class="hljs-number">5</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; lineNumber; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-javascript">         * 重置游戏</span></span><br><span class="hljs-comment"><span class="language-javascript">         */</span></span><br><span class="language-javascript">        <span class="hljs-title function_">restartGame</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//清空基础数据</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span> = []</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-number">1</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-literal">null</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">restart</span> = <span class="hljs-literal">false</span></span><br><span class="language-javascript">            <span class="hljs-comment">//清空画布</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>)</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">width</span>,</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">lineNumber</span>,</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span>.<span class="hljs-property">space</span>);</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">updateDetail</span>(<span class="hljs-params">square, lineNumber</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置board大小</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>)</span><br><span class="language-javascript">            canvas.<span class="hljs-property">width</span> = square</span><br><span class="language-javascript">            canvas.<span class="hljs-property">height</span> = square</span><br><span class="language-javascript">            <span class="hljs-comment">//重新设置棋盘大小</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">boardDetail</span> = &#123;</span><br><span class="language-javascript">                <span class="hljs-attr">width</span>: square,</span><br><span class="language-javascript">                <span class="hljs-attr">lineNumber</span>: lineNumber,</span><br><span class="language-javascript">                <span class="hljs-attr">space</span>: square / lineNumber</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">//重新绘制游戏</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">restartGame</span>()</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-chess&quot;</span></span><br><span class="hljs-tag">                @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;handleClickAndDraw($event,this.boardDetail)&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board-detail&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘信息：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘长宽：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.boardDetail.width&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘线条数：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.boardDetail.lineNumber&quot;</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>棋盘间距：<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;this.boardDetail.space&quot;</span> <span class="hljs-attr">disabled</span>/&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;updateDetail(this.boardDetail.width,this.boardDetail.lineNumber)&quot;</span>&gt;</span>修改<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;restartGame&quot;</span>&gt;</span>重新开始<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>当前落子：&#123;&#123; this.player === 1 ? &quot;白&quot; : &quot;黑&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>胜利方：&#123;&#123; this.winner === 1 ? &quot;白棋&quot; : this.winner === 2 ? &quot;黑棋&quot; : &quot;&quot; &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-chess</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid black;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-detail</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">20px</span>;</span><br><span class="language-css"></span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board-detail</span> &gt; <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">input</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>效果图，测试中发现了一个bug，斜线的胜负检验逻辑有问题<br><img src="/images/%E4%BA%94%E5%AD%90%E6%A3%8B/%E6%95%88%E6%9E%9C%E5%9B%BE2.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE3+Canvas绘制五子棋（一）</title>
      <link href="/2024/11/28/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2024/11/28/%E6%B8%B8%E6%88%8F_%E4%BA%94%E5%AD%90%E6%A3%8B/VUE3-Canvas%E7%BB%98%E5%88%B6%E4%BA%94%E5%AD%90%E6%A3%8B%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>趁着休息，花了1小时参考网上各类简单的写了个五子棋，主要实现功能，未进行任何优化</p><p>修改画布大小及棋子布局</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><p>CSS相应如下</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-class">.board</span> &#123;<br>    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid red;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">630px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">630px</span>;<br>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-attribute">display</span>: flex;<br>    <span class="hljs-attribute">align-items</span>: center;<br>    <span class="hljs-attribute">justify-content</span>: center;<br>&#125;<br></code></pre></td></tr></table></figure><p>1、绘制棋盘，以30为一格，考虑棋子落在交叉点，故在绘制时右移和下移了15，并将数组进行重置（600的棋盘，30一个，共20个）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">drawBoard</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>    <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br><br>    <span class="hljs-comment">// 设置线条颜色</span><br>    ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;<br>    <span class="hljs-comment">// 绘制横线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;<br>        ctx.<span class="hljs-title function_">beginPath</span>();<br>        ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">15</span>, i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>);<br>        ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">570</span> + <span class="hljs-number">15</span>, i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>);<br>        ctx.<span class="hljs-title function_">stroke</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 绘制竖线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;<br>        ctx.<span class="hljs-title function_">beginPath</span>();<br>        ctx.<span class="hljs-title function_">moveTo</span>(i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>, <span class="hljs-number">0</span> + <span class="hljs-number">15</span>);<br>        ctx.<span class="hljs-title function_">lineTo</span>(i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>, <span class="hljs-number">570</span> + <span class="hljs-number">15</span>);<br>        ctx.<span class="hljs-title function_">stroke</span>();<br>    &#125;<br>    <span class="hljs-comment">// 重置为0</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">20</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))<br>    &#125;<br>    <span class="hljs-comment">// console.log(this.board)</span><br>&#125;,<br></code></pre></td></tr></table></figure><p>2、绘制棋子，考虑正负15的距离，此处在绘制完成后，进行了正负判断，选手交换</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">drawCell</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">let</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>    container.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClickAndDraw</span>)<br>        &#125;,<br><span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event</span>) &#123;<br>    <span class="hljs-keyword">let</span> x = event.<span class="hljs-property">offsetX</span>;<br>    <span class="hljs-keyword">let</span> y = event.<span class="hljs-property">offsetY</span>;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x + <span class="hljs-string">&#x27;   &#x27;</span> + y)<br>    <span class="hljs-comment">// 计算棋子落在哪个方格中</span><br>    <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / <span class="hljs-number">30</span>);<br>    <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / <span class="hljs-number">30</span>);<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cellX, cellY)<br>    <span class="hljs-comment">// 判断该位置是否有棋子</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);<br>    <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);<br>    <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span><br>    <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(<br>        cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-number">2</span>,<br>        cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-number">10</span><br>    )<br>    grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)<br>    grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)<br>    ctx.<span class="hljs-title function_">beginPath</span>()<br>    ctx.<span class="hljs-property">fillStyle</span> = grd<br>    ctx.<span class="hljs-title function_">arc</span>(<br>        cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,<br>        <span class="hljs-number">10</span>,<br>        <span class="hljs-number">0</span>,<br>        <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,<br>        <span class="hljs-literal">false</span><br>    );<br>    ctx.<span class="hljs-title function_">fill</span>();<br>    ctx.<span class="hljs-title function_">closePath</span>();<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>; <span class="hljs-comment">//将黑白棋信息存储</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span>)<br>    &#125;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span><br>&#125;,<br></code></pre></td></tr></table></figure><p>3、正负判断，这个主要采取网上CSDN，并未进行过多加工</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board</span>) &#123;<br>    <span class="hljs-comment">// 检查横向是否有五子连线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">19</span>; i++) &#123;<br>        <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;<br>            <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;<br>                count++;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                count = <span class="hljs-number">0</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 检查纵向是否有五子连线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;<br>        <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">19</span>; i++) &#123;<br>            <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;<br>                count++;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                count = <span class="hljs-number">0</span>;<br>            &#125;<br><br>            <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 检查右斜线是否有五子连线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">14</span>; j++) &#123;<br>            <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;<br>                <span class="hljs-keyword">if</span> (board[i + k][j + k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;<br>                    count++;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    count = <span class="hljs-number">0</span>;<br>                &#125;<br><br>                <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 检查左斜线是否有五子连线</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i++) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;<br>            <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;<br>                <span class="hljs-keyword">if</span> (board[i + k][j - k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;<br>                    count++;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    count = <span class="hljs-number">0</span>;<br>                &#125;<br><br>               <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;<br>                   <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>最后，完整代码如下App.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;</span><br><span class="language-javascript">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">return</span> &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">board</span>: [],</span><br><span class="language-javascript">            <span class="hljs-attr">player</span>: <span class="hljs-number">1</span>,<span class="hljs-comment">//1--白棋；2--黑棋</span></span><br><span class="language-javascript">            <span class="hljs-attr">winner</span>: <span class="hljs-literal">null</span></span><br><span class="language-javascript">        &#125;;</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawBoard</span>();</span><br><span class="language-javascript">        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">drawCell</span>();</span><br><span class="language-javascript">    &#125;,</span><br><span class="language-javascript">    <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">drawBoard</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 设置线条颜色</span></span><br><span class="language-javascript">            ctx.<span class="hljs-property">strokeStyle</span> = <span class="hljs-string">&quot;black&quot;</span>;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 绘制横线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(<span class="hljs-number">15</span>, i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(<span class="hljs-number">570</span> + <span class="hljs-number">15</span>, i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 绘制竖线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">beginPath</span>();</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">moveTo</span>(i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>, <span class="hljs-number">0</span> + <span class="hljs-number">15</span>);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">lineTo</span>(i * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>, <span class="hljs-number">570</span> + <span class="hljs-number">15</span>);</span><br><span class="language-javascript">                ctx.<span class="hljs-title function_">stroke</span>();</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// 重置为0</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-number">20</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>))</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-comment">// console.log(this.board)</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">drawCell</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            container.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;click&quot;</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleClickAndDraw</span>)</span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">handleClickAndDraw</span>(<span class="hljs-params">event</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> x = event.<span class="hljs-property">offsetX</span>;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> y = event.<span class="hljs-property">offsetY</span>;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(x + <span class="hljs-string">&#x27;   &#x27;</span> + y)</span><br><span class="language-javascript">            <span class="hljs-comment">// 计算棋子落在哪个方格中</span></span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellX = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetX</span>) / <span class="hljs-number">30</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> cellY = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((event.<span class="hljs-property">offsetY</span>) / <span class="hljs-number">30</span>);</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cellX, cellY)</span><br><span class="language-javascript">            <span class="hljs-comment">// 判断该位置是否有棋子</span></span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] !== <span class="hljs-number">0</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-string">&quot;该位置已有棋子&quot;</span>)</span><br><span class="language-javascript">                <span class="hljs-keyword">return</span>;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;board&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">&quot;2d&quot;</span>);</span><br><span class="language-javascript">            <span class="hljs-comment">//画带渐变色的棋子，同心圆形式</span></span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> grd = ctx.<span class="hljs-title function_">createRadialGradient</span>(</span><br><span class="language-javascript">                cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span>,</span><br><span class="language-javascript">                cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                <span class="hljs-number">10</span></span><br><span class="language-javascript">            )</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#FFFFFF&#x27;</span> : <span class="hljs-string">&#x27;#4C4C4C&#x27;</span>)</span><br><span class="language-javascript">            grd.<span class="hljs-title function_">addColorStop</span>(<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;#DADADA&#x27;</span> : <span class="hljs-string">&#x27;#000000&#x27;</span>)</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">beginPath</span>()</span><br><span class="language-javascript">            ctx.<span class="hljs-property">fillStyle</span> = grd</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">arc</span>(</span><br><span class="language-javascript">                cellX * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                cellY * <span class="hljs-number">30</span> + <span class="hljs-number">15</span>,</span><br><span class="language-javascript">                <span class="hljs-number">10</span>,</span><br><span class="language-javascript">                <span class="hljs-number">0</span>,</span><br><span class="language-javascript">                <span class="hljs-number">2</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>,</span><br><span class="language-javascript">                <span class="hljs-literal">false</span></span><br><span class="language-javascript">            );</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">fill</span>();</span><br><span class="language-javascript">            ctx.<span class="hljs-title function_">closePath</span>();</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>[cellX][cellY] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>; <span class="hljs-comment">//将黑白棋信息存储</span></span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkWinner</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">board</span>)</span><br><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span> != <span class="hljs-literal">null</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-title function_">alert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">winner</span>)</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span> === <span class="hljs-number">1</span> ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-title function_">checkWinner</span>(<span class="hljs-params">board</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-comment">// 检查横向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查纵向是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">19</span>; i++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (board[i][j] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                        count++;</span><br><span class="language-javascript">                    &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                        count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                    <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查右斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">14</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j + k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;</span><br><span class="language-javascript">                            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 检查左斜线是否有五子连线</span></span><br><span class="language-javascript">            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">14</span>; i++) &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">4</span>; j &lt; <span class="hljs-number">19</span>; j++) &#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">5</span>; k++) &#123;</span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (board[i + k][j - k] === <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>) &#123;</span><br><span class="language-javascript">                            count++;</span><br><span class="language-javascript">                        &#125; <span class="hljs-keyword">else</span> &#123;</span><br><span class="language-javascript">                            count = <span class="hljs-number">0</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">                        <span class="hljs-keyword">if</span> (count &gt;= <span class="hljs-number">5</span>) &#123;</span><br><span class="language-javascript">                            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">player</span>;</span><br><span class="language-javascript">                        &#125;</span><br><span class="language-javascript">                    &#125;</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript"></span><br><span class="language-javascript">            <span class="hljs-comment">// 如果没有五子连线，则游戏继续</span></span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">&#125;;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;board&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">canvas</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;board&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;600&quot;</span> <span class="hljs-attr">height</span>=<span class="hljs-string">&quot;600&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">canvas</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span><br><span class="language-css"><span class="hljs-selector-class">.board</span> &#123;</span><br><span class="language-css">    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid red;</span><br><span class="language-css">    <span class="hljs-attribute">width</span>: <span class="hljs-number">630px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">height</span>: <span class="hljs-number">630px</span>;</span><br><span class="language-css">    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">0</span>;</span><br><span class="language-css">    <span class="hljs-attribute">display</span>: flex;</span><br><span class="language-css">    <span class="hljs-attribute">align-items</span>: center;</span><br><span class="language-css">    <span class="hljs-attribute">justify-content</span>: center;</span><br><span class="language-css">&#125;</span><br><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br></code></pre></td></tr></table></figure><p>效果图<br><img src="/images/%E4%BA%94%E5%AD%90%E6%A3%8B/%E6%95%88%E6%9E%9C%E5%9B%BE1.png" alt="效果图"></p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> vue </tag>
            
            <tag> 五子棋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于Flask的WebHooks服务搭建</title>
      <link href="/2024/07/04/python/%E5%9F%BA%E4%BA%8EFlask%E7%9A%84WebHooks%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/07/04/python/%E5%9F%BA%E4%BA%8EFlask%E7%9A%84WebHooks%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>1、首先确保已正确安装nginx，supervisor，并正常启用nginx和supervisor</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">yum install nginx supervisor<br>systemctl start nginx<br>systemctl enable nginx<br>systemctl start supervisor<br>systemctl enable supervisor<br></code></pre></td></tr></table></figure><p>2、新建Flask项目和相关虚拟环境包等</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">virtualenv venv <span class="hljs-comment">#新建虚拟环境</span><br>. venv/<span class="hljs-built_in">bin</span>/activate<br>pip install gunicorn<br></code></pre></td></tr></table></figure><p>3、修改app.py文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, jsonify<br><br>app = Flask(__name__)<br><br><span class="hljs-comment"># gitee中webhooks的secret</span><br>gitee_secret = <span class="hljs-string">&#x27;XXXX&#x27;</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/hooks&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">post_data</span>():<br>    <span class="hljs-comment"># 认证签名是否有效</span><br>    signature = request.headers.get(<span class="hljs-string">&#x27;X-Gitee-Token&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;获取到访问token:%s&quot;</span>, signature)<br><br>    <span class="hljs-keyword">if</span> signature != gitee_secret:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;token认证无效&quot;</span>, <span class="hljs-number">401</span><br>    <span class="hljs-comment"># 运行shell脚本，更新代码</span><br>    os.system(<span class="hljs-string">&#x27;sh deploy.sh&#x27;</span>)<br>    <span class="hljs-keyword">return</span> jsonify(&#123;<span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-number">200</span>&#125;)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run()<br></code></pre></td></tr></table></figure><p>3、新建deploy.sh文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs shell">echo &#x27;========Start DEPLY========&#x27;<br>echo &#x27;--------enter Dir ------------&#x27;<br>cd /home/opc/XXXX<br>echo &#x27;--------start git pull------------&#x27;<br>git pull<br>echo &#x27;--------init requirements------------&#x27;<br>. venv/bin/activate<br>pip install -r requirements.txt<br>deactivate<br>echo &#x27;-----ex root-----&#x27;<br>sudo -i<br>echo &#x27;-----restart supervision-----&#x27;<br>supervisorctl restart XXXX<br>echo &#x27;----- reload nginx-----&#x27;<br>nginx -s reload<br>echo &#x27;========END DEPLY========&#x27;<br></code></pre></td></tr></table></figure><p>4、新建supervisor.ini文件（也可省略，手工启动即可）</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment">;[include]</span><br><span class="hljs-comment">;files = relative/directory/*.ini</span><br><span class="hljs-section">[program:XXXX]</span><span class="hljs-attr">directory</span>=/home/opc/XXXX<br><span class="hljs-attr">command</span>=/home/opc/XXXX/venv/bin/python3 /home/opc/XXXX/venv/bin/gunicorn -b <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">1111</span> app:app<br><span class="hljs-attr">startsecs</span>=<span class="hljs-number">0</span><br><span class="hljs-attr">stopwaitsecs</span>=<span class="hljs-number">0</span><br><span class="hljs-attr">autostart</span>=<span class="hljs-literal">true</span><br><span class="hljs-attr">autorestart</span>=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>5、将supervisor.ini文件拷贝到&#x2F;etc&#x2F;supervisor.d&#x2F;目录下，并重启supervisord</p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python离线环境部署搭建</title>
      <link href="/2024/07/04/python/python%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/07/04/python/python%E7%A6%BB%E7%BA%BF%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>1、需要保证两边环境一致，仅以Win为例进行了测试，按理应该一样。</p><p>2、安装完毕后没有虚拟环境，可先将全局包进行安装。</p><p>3、虚拟环境和系统正式环境操作一致，区别仅在于是否激活虚拟环境，即当前pip是针对的什么环境，可通过pip list进行查看</p><h2 id="具体步骤："><a href="#具体步骤：" class="headerlink" title="具体步骤："></a>具体步骤：</h2><p>1.生成安装包列表文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 安装包列表保存到文件requirements.txt中，文件名是自己定义，</span><br><span class="hljs-comment"># 如果文件已经存在会被覆盖更新，不存在会自动创建</span><br><span class="hljs-comment"># 虚拟环境目录下执行这个命令，则打包的虚拟环境的内容</span><br><span class="hljs-comment"># 否则生成的文件内容是系统python版本使用的安装包列表</span><br>pip freeze &gt; requirements.txt<br></code></pre></td></tr></table></figure><p>2.将包列表文件中的所有包下载到文件夹下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># [.\\packages]为保存安装包的路径，不存在会被创建</span><br><span class="hljs-comment"># [requirements.txt]为前一步生成的包列表文件</span><br>pip download -d  .\\packages  -r requirements.txt<br></code></pre></td></tr></table></figure><p>3.将①和②中生成的包列表文件和安装包文件夹复制到另一台上<br>4.依据包列表文件以及安装包文件夹来安装包</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># [.\\packages]为安装包文件夹路径</span><br><span class="hljs-comment"># [requirements.txt]为包文件列表</span><br><span class="hljs-comment"># 注意相对路径和绝对路径的选择</span><br>pip install --no-index --find-links=.\\packages -r requirements.txt<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于falsk-sqlalchemy中多数据库配置及使用</title>
      <link href="/2024/07/04/python/%E5%85%B3%E4%BA%8Efalsk-sqlalchemy%E4%B8%AD%E5%A4%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/07/04/python/%E5%85%B3%E4%BA%8Efalsk-sqlalchemy%E4%B8%AD%E5%A4%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E5%8F%8A%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p> 近期发现了几个免费的数据库，想着尝试用Flask进行简单连接 以前一直使用SQLite，近期打算尝试连接MySQL和Postgre 一些简单的安装等命令就此略过</p><h2 id="多数据源配置"><a href="#多数据源配置" class="headerlink" title="多数据源配置"></a>多数据源配置</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 配置SQLite数据源</span><br>sqlite_path = os.path.join(BASE_DIR, <span class="hljs-string">&quot;sys.db&quot;</span>)<br>app.config[<span class="hljs-string">&#x27;SQLALCHEMY_DATABASE_URI&#x27;</span>] = <span class="hljs-string">&#x27;sqlite:///&#x27;</span> + sqlite_path<br><span class="hljs-comment"># 配置MySQL（TiDB）数据源</span><br>MYSQL_USERNAME = <span class="hljs-string">&#x27;USERNAME&#x27;</span><br>MYSQL_PASSWORD = <span class="hljs-string">&#x27;PASSWORD&#x27;</span><br>MYSQL_URL = <span class="hljs-string">&#x27;SQL_URL&#x27;</span><br>MYSQL_PORT = <span class="hljs-string">&#x27;PORT&#x27;</span><br>MYSQL_DATABASE = <span class="hljs-string">&#x27;main&#x27;</span><br>MYSQL_SSL = &#123;<br>    <span class="hljs-string">&#x27;ssl_verify_cert&#x27;</span>: <span class="hljs-string">&#x27;True&#x27;</span>,<br>    <span class="hljs-string">&#x27;ssl_verify_identity&#x27;</span>: <span class="hljs-string">&#x27;True&#x27;</span>,<br>    <span class="hljs-string">&#x27;ssl_cert&#x27;</span>: BASE_DIR + <span class="hljs-string">&#x27;/ca/cert.crt&#x27;</span>,<br>    <span class="hljs-string">&#x27;ssl_key&#x27;</span>: BASE_DIR + <span class="hljs-string">&#x27;/ca/private.key&#x27;</span><br>&#125;<br>MYSQL_URL_ALL = <span class="hljs-string">&#x27;mysql+pymysql://%s:%s@%s:%s/%s?%s&#x27;</span> % (<br>    MYSQL_USERNAME, MYSQL_PASSWORD, MYSQL_URL, MYSQL_PORT, MYSQL_DATABASE, urlencode(MYSQL_SSL))<br><span class="hljs-comment"># 配置Postgre数据源</span><br>PG_USERNAME = <span class="hljs-string">&#x27;USERNAME&#x27;</span><br>PG_PASSWORD = <span class="hljs-string">&#x27;PASSWORD&#x27;</span><br>PG_URL = <span class="hljs-string">&#x27;SQL_URL&#x27;</span><br>PG_PORT = <span class="hljs-string">&#x27;PORT&#x27;</span><br>PG_DATABASE = <span class="hljs-string">&#x27;main&#x27;</span><br>PG_URL_ALL = <span class="hljs-string">&#x27;postgresql://%s:%s@%s:%s/%s&#x27;</span> % (PG_USERNAME, PG_PASSWORD, PG_URL, PG_PORT, PG_DATABASE)<br>app.config[<span class="hljs-string">&#x27;SQLALCHEMY_BINDS&#x27;</span>] = &#123;<br>    <span class="hljs-string">&#x27;tidb&#x27;</span>: MYSQL_URL_ALL,<br>    <span class="hljs-string">&#x27;pg&#x27;</span>: PG_URL_ALL,<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><p>1、因为TiDB需要SSL认证，所以加入了SSL&#x3D;True的条件，可根据需要自行设置，关于证书生成如下，共计生成3个文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">openssl genpkey -algorithm RSA -out private.pem -pkeyopt rsa_keygen_bits:2048<br>openssl req -new -key private.pem -out cert.csr<br>openssl x509 -req -days 365 -in cert.csr -signkey private.pem -out cert.crt<br></code></pre></td></tr></table></figure><h2 id="Model中的配置区别"><a href="#Model中的配置区别" class="headerlink" title="Model中的配置区别"></a>Model中的配置区别</h2><p>1、SQLite中的使用，和日常没区别</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span>(db.Model):<br><span class="hljs-built_in">id</span> = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<br>username = db.Column(db.String(<span class="hljs-number">80</span>), unique=<span class="hljs-literal">True</span>)<br>email = db.Column(db.String(<span class="hljs-number">120</span>), unique=<span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, username, email</span>):<br>    <span class="hljs-variable language_">self</span>.username = username<br>    <span class="hljs-variable language_">self</span>.email = email<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;User %r&gt;&#x27;</span> % <span class="hljs-variable language_">self</span>.username<br></code></pre></td></tr></table></figure><p>2、MySQL中的使用，需要添加BINDS相关信息，用于区分数据源，tidb为前期配置文件内的值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Good</span>(db.Model):<br>__bind_key__ = <span class="hljs-string">&#x27;tidb&#x27;</span><br><span class="hljs-built_in">id</span> = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<br>good = db.Column(db.String(<span class="hljs-number">80</span>), unique=<span class="hljs-literal">True</span>)<br>email = db.Column(db.String(<span class="hljs-number">120</span>), unique=<span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, good, email</span>):<br>    <span class="hljs-variable language_">self</span>.good = good<br>    <span class="hljs-variable language_">self</span>.email = email<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;Good %r&gt;&#x27;</span> % <span class="hljs-variable language_">self</span>.good<br></code></pre></td></tr></table></figure><p>3、Postgre中的使用，同样需要添加BINDS信息<br>区分MYSQL，PG库中有一个schema概念，若未设置对应模式，则默认为public下的表，如下展示为设置test模式下的表，也增加了tablename的示例</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Name</span>(db.Model):<br>__bind_key__ = <span class="hljs-string">&#x27;pg&#x27;</span><br>__table_args__ = (&#123;<span class="hljs-string">&quot;schema&quot;</span>: <span class="hljs-string">&quot;test&quot;</span>&#125;)<br>__tablename__ = <span class="hljs-string">&#x27;name&#x27;</span><br><span class="hljs-built_in">id</span> = db.Column(db.Integer, primary_key=<span class="hljs-literal">True</span>)<br>name = db.Column(db.String(<span class="hljs-number">80</span>), unique=<span class="hljs-literal">True</span>)<br>email = db.Column(db.String(<span class="hljs-number">120</span>), unique=<span class="hljs-literal">True</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, name, email</span>):<br>    <span class="hljs-variable language_">self</span>.name = name<br>    <span class="hljs-variable language_">self</span>.email = email<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">__repr__</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&lt;Name %r&gt;&#x27;</span> % <span class="hljs-variable language_">self</span>.name<br></code></pre></td></tr></table></figure><h2 id="最终程序测试"><a href="#最终程序测试" class="headerlink" title="最终程序测试"></a>最终程序测试</h2><p>经过此配置，则可通过此种方式进行测试</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># SQLite</span><br>ur = User(<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;admin@example.com&#x27;</span>)<br>db.session.add(ur)<br><span class="hljs-comment">#TiDB</span><br>gd = Good(<span class="hljs-string">&#x27;good&#x27;</span>, <span class="hljs-string">&#x27;good@example.com&#x27;</span>)<br>db.session.add(gd)<br><span class="hljs-comment"># PG</span><br>ne = Name(<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;name@example.com&#x27;</span>)<br>db.session.add(ne)<br>db.session.commit()<br></code></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>有网络锁重置解网络锁</title>
      <link href="/2023/07/04/%E6%8A%80%E6%9C%AF%E6%9D%82%E7%B3%85/%E6%9C%89%E7%BD%91%E7%BB%9C%E9%94%81%E9%87%8D%E7%BD%AE%E8%A7%A3%E7%BD%91%E7%BB%9C%E9%94%81/"/>
      <url>/2023/07/04/%E6%8A%80%E6%9C%AF%E6%9D%82%E7%B3%85/%E6%9C%89%E7%BD%91%E7%BB%9C%E9%94%81%E9%87%8D%E7%BD%AE%E8%A7%A3%E7%BD%91%E7%BB%9C%E9%94%81/</url>
      
        <content type="html"><![CDATA[<p>出于无法使用XXQG，于是就对闲鱼430购买的Pixel 4XL进行还原重置，买的有网络锁的机器，需要重新解锁，用来记录。<br>1、重置，离线进入手机，开启USB调试模式<br>2、执行以下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell pm uninstall -k --user 0 com.google.android.apps.work.oobconfig<br></code></pre></td></tr></table></figure><p>3、执行配置命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">adb shell &quot;settings put global captive_portal_https_url https://captive.v2ex.co/generate_204&quot;<br></code></pre></td></tr></table></figure><p>4、重启手机、插卡正常使用</p>]]></content>
      
      
      <categories>
          
          <category> 技术杂糅 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 手机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次洗牙过程</title>
      <link href="/2022/07/04/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%B4%97%E7%89%99%E8%BF%87%E7%A8%8B/"/>
      <url>/2022/07/04/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/%E8%AE%B0%E4%B8%80%E6%AC%A1%E6%B4%97%E7%89%99%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>源于上周去检查车祸后的肺部慢性肺炎，突然奇想去进行一次洗牙，其实当初洗牙的目的是为了美白，但预约完毕后，发现主要用于处理牙垢。</p><p>上周已抽血化验，这周二直接杀过去就可以，还是上次的医生。</p><p>洗牙过程整体还行，在未开始前存在害怕，洗牙过程对原本敏感的牙齿有影响，明显能够感觉到痛，而其它的，基本可以出于无感，洗牙过程会出血，洗好以后牙齿有异样的感觉。</p><p>就医，特别是当躺在手术床上，任由别人进行处置时，内心是害怕的，此时人和动物是没差别的，完全可以当成是兽，医生也可以是兽医，只是对待方式不一致。</p>]]></content>
      
      
      <categories>
          
          <category> 生活琐事 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>记录一次车祸（回忆分析）</title>
      <link href="/2022/03/31/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E8%BD%A6%E7%A5%B8%EF%BC%88%E5%9B%9E%E5%BF%86%E5%88%86%E6%9E%90%EF%BC%89/"/>
      <url>/2022/03/31/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E8%BD%A6%E7%A5%B8%EF%BC%88%E5%9B%9E%E5%BF%86%E5%88%86%E6%9E%90%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>开车从毕业到现在已近6年，基本没有事故甚至把别人刮擦，记得上一次事故是家里大人怀孕做坐月子期间，在五彩城拐弯去华润超市时。</p><p>回忆起来上次应该是看了右后视镜，要弯道拐弯进去，而看的过程中前车奔驰突然刹车了，导致还没进入转弯道，就撞到了，踩了紧急刹车，撞的不严重，一切按照保险来。当时认定自己追尾全责，事后回想，是否前车本来也要右转，存在压线的可能，翻看照片无法看出，因此此事也就到此结束。</p><p>22年此次车祸就比较严重，前车凹进去，正副驾驶座安全气囊弹出来，因汽车使用时间较长了，已达保费临近值，最终和修理店协商，卖给修理店，后续由修理店再进行处理。</p><h2 id="事故过程描述："><a href="#事故过程描述：" class="headerlink" title="事故过程描述："></a>事故过程描述：</h2><p>刚下高速，需要盘圈上高架（1行车道1应急道），正在行驶中，突然觉得可能会撞到对面，打了方向盘，并踩了刹车，感觉圈打的以往的大，但是感觉上不到四分之一圈且不急，那一瞬间觉得可能会出问题，突然之间车子开始不受控制，脑海中一片空白，想着要撞了的。车子先撞了右前方，后转圈到右后方，最终撞了左前方停下来。</p><h2 id="事故过程分析："><a href="#事故过程分析：" class="headerlink" title="事故过程分析："></a>事故过程分析：</h2><p>1、【突然】，是因为事后回想起来，是因为突然发现脑海中出现了感觉要撞到前面，速度有点快的画面，而看到之前的1秒是是在开车、玩手机或者想事情，均没有任何记忆。</p><p>2、【打了方向盘】，回想起来感觉不是很突然的打很大的圈，也是日常的打圈，并踩了刹车用于降速（事后回想）</p><p>3、【踩了刹车】，自己想来是应该之前踩了油门在加速，后发现过快踩了刹车。但是车子撞的相对比较厉害，感觉又加速往前冲的迹象，自己怀疑是不是车子不受控制到撞之前在踩油门而非刹车，没有记录仪无法获知。目前无法回想起来那个瞬间脚放在油门还是刹车，后续在多次开车路过的时候特意留意，在该路段盘旋上去的过程中是需要踩油门的。</p><p>4、【觉得可能会出问题】，这个是玄学或者是因为出了事故刚好印证了那会的灵光一闪</p><p>5、【一片空白】，那个过程一片空白，其实那个时候在想很多事情，但是却无法回想起来，在一个瞬间有点闷的状态</p><h2 id="事故处理分析："><a href="#事故处理分析：" class="headerlink" title="事故处理分析："></a>事故处理分析：</h2><p>在车子撞了以后，闻到有股烧焦味（事后交警告知是因为安全气囊弹出有火药），第一时间想着下车，正副驾驶座因为车头变形无法打开，打电话给110进行报警，后想到可以通过后座下车，遂顺利下车等交警。下车后有点懵的状态。</p><p>1、下车后有辆维修的车迅速赶到，比交警还早，最终也在该维修厂卖给了卖家。过程较为曲折，错误在于当初不该选择该类维修厂，后续车拖进去以后就难以在开出来去其它地方维修，维修厂不让放车走（后续有时间在写一个此类的历程）。</p><p>2、再交给路边黄牛维修车前，内心是矛盾的，既知道他们是路边黄牛可能会出问题，又想着要么就交给他们维修的就好了的，最终选择了他们。</p><p>3、事故后未第一时间选择进行4S店维修，全程未想到，只有晚上到家停顿下来回想后，才想起来可以去4S店维修，单方事故，未涉及其它车辆。</p><p>4、事故发生后，交警询问人是否有受伤，轻率的回答了没事，交警单未写任何人受伤，但事故后2小时开始出现胸腔肋骨痛，维修厂小哥告知是气囊弹出缘故，且交警当初特地问了人有没有受伤就是基于此的，后由维修厂小哥带着去交警队重新开具事故单附上胸腔受伤，下午去医院自费进行看病，幸好未任何问题。</p><h2 id="后续影响："><a href="#后续影响：" class="headerlink" title="后续影响："></a>后续影响：</h2><p>目前回想，车子不应该报废，最好的办法是给4S店进行维修，则此时还可以开，因为报废，导致家里需要购置2辆车（本旧车给老人，新买电动车），恰逢电动车涨价，亏了好几万。</p>]]></content>
      
      
      <categories>
          
          <category> 生活琐事 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
